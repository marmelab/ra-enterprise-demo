var cn=Object.defineProperty;var d=(t,n)=>cn(t,"name",{value:n,configurable:!0});import{J as re,au as Rt,av as dn,aw as kt,u as be,W as $e,S as Xe,ax as sn,an as ln,ay as vt,r as N,az as fn,aA as ht,i as vn,aB as hn,C as Mt,D as Te,aC as Tt,aD as yn,E as we,aE as gn,aF as mn,aG as Pe,aH as De,aI as Ae,aJ as yt,M as te,aK as bn,aL as Le,a2 as wn,L as _e,aM as gt,U as _n,aN as pn,aO as xn,aP as $t,aQ as On,aR as he,aS as qt,j as E,aT as He,F as Be,aU as Bt,aV as Kt,aW as It,at as wt,I as _t,aX as Cn,ag as Sn,aY as jn,aZ as En,a_ as Nn,a$ as Lt,b0 as Pn,f as Dn,b1 as An,ap as Rn,b2 as kn,y as Mn,b3 as Tn,b4 as $n,b5 as qn,m as Bn,b6 as Wt,b7 as Qt,b8 as We,b9 as Kn,ba as In,k as zt,bb as Ut,bc as Gt,bd as Ln,be as Wn,bf as Qn,bg as zn,a3 as Un,a4 as Gn,d as Xn,O as Hn,Q as qe,aj as Jn,bh as Vn,bi as Yn}from"./index-Cbgj5RDi.js";import{bj as Oa,bk as Ca,bl as Sa,bm as ja,bn as Ea,bo as Na,bp as Pa,bq as Da,br as Aa,bs as Ra,bt as ka,bu as Ma}from"./index-Cbgj5RDi.js";const Zn=d((t={})=>{const{disableAuthentication:n=!1,id:e,queryOptions:i={},redirectOnError:r=Fn}=t,a=re(t);if(!a)throw new Error("useShowController requires a non-empty resource prop or context");const{isPending:c}=Rt({enabled:!n}),{isPending:s}=dn({action:"show",resource:a,enabled:!n&&!c}),l=kt(a),o=be(),u=$e(),f=Xe(),{id:b}=sn();if(!b&&!e)throw new Error("useShowController requires an id prop or a route with an /:id? parameter.");const g=e??b,{meta:j,...S}=i,{data:_,error:w,isLoading:h,isFetching:v,isPaused:y,isPending:p,isPlaceholderData:x,refetch:O}=ln(a,{id:g,meta:j},{enabled:!c&&!s||n,onError:d(()=>{u("ra.notification.item_doesnt_exist",{type:"error"}),f(r,a,g)},"onError"),retry:!1,...S});if(_&&_.id&&_.id!=g)throw new Error(`useShowController: Fetched record's id attribute (${_.id}) must match the requested 'id' (${g})`);const C=vt(),m=l(_);return{defaultTitle:o(`resources.${a}.page.show`,{id:g,record:_,recordRepresentation:typeof m=="string"?m:"",_:o("ra.page.show",{name:C(a,1),id:g,record:_,recordRepresentation:typeof m=="string"?m:""})}),error:w,isLoading:h,isFetching:v,isPaused:y,isPending:p,isPlaceholderData:x,record:_,redirectOnError:r,refetch:O,resource:a}},"useShowController"),Fn="list",mt=N.createContext(null);mt.displayName="ShowContext";const er=d(({children:t,value:n})=>N.createElement(mt.Provider,{value:n},N.createElement(fn,{value:n&&n.record},t)),"ShowContextProvider"),tr=d(()=>{const t=N.useContext(mt);if(!t)throw new Error("useShowContext must be used inside a ShowContextProvider");return t},"useShowContext"),nr=d(t=>{const{hasEdit:n}=ht(t);return N.createElement(vn,{...rr(t)},n&&N.createElement(hn,null))},"ShowActions"),rr=d(({hasCreate:t,hasEdit:n,hasShow:e,hasList:i,resource:r,...a})=>a,"sanitizeRestProps$1"),ar=N.createElement(nr,null),ir=N.createElement(yn,null),or=d(t=>{const{actions:n,aside:e,children:i,render:r,className:a,component:c=Mt,emptyWhileLoading:s=!1,offline:l=ir,error:o,title:u,...f}=t,b=tr(),{resource:g,defaultTitle:j,isPaused:S,isPending:_,record:w,error:h}=b,{hasEdit:v}=ht(),y=typeof n>"u"&&v?ar:n,p=S&&_&&l!==void 0&&l!==!1,x=h&&o!==!1&&o!==void 0;return!w&&_&&s&&!p&&!x?null:N.createElement(ur,{className:Te("show-page",a),...f},u!==!1&&N.createElement(Tt,{title:u,defaultTitle:j,preferenceKey:`${g}.show.title`}),y!==!1&&y,N.createElement("div",{className:Te(je.main,{[je.noActions]:!y})},N.createElement(c,{className:je.card},p?l:x?o:r?r(b):i),e))},"ShowView"),Ke="RaShow",je={main:`${Ke}-main`,noActions:`${Ke}-noActions`,card:`${Ke}-card`},ur=we("div",{name:Ke,overridesResolver:d((t,n)=>n.root,"overridesResolver")})({[`& .${je.main}`]:{display:"flex"},[`& .${je.noActions}`]:{marginTop:"1em"},[`& .${je.card}`]:{flex:"1 1 auto"}});var H=function(){return H=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},H.apply(this,arguments)},ue=function(t,n,e,i){function r(a){return a instanceof e?a:new e(function(c){c(a)})}return d(r,"adopt"),new(e||(e=Promise))(function(a,c){function s(u){try{o(i.next(u))}catch(f){c(f)}}d(s,"fulfilled");function l(u){try{o(i.throw(u))}catch(f){c(f)}}d(l,"rejected");function o(u){u.done?a(u.value):r(u.value).then(s,l)}d(o,"step"),o((i=i.apply(t,n||[])).next())})},ce=function(t,n){var e={label:0,sent:d(function(){if(a[0]&1)throw a[1];return a[1]},"sent"),trys:[],ops:[]},i,r,a,c;return c={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function s(o){return function(u){return l([o,u])}}function l(o){if(i)throw new TypeError("Generator is already executing.");for(;c&&(c=0,o[0]&&(e=0)),e;)try{if(i=1,r&&(a=o[0]&2?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[o[0]&2,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,r=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){e.label=o[1];break}if(o[0]===6&&e.label<a[1]){e.label=a[1],a=o;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(o);break}a[2]&&e.ops.pop(),e.trys.pop();continue}o=n.call(t,e)}catch(u){o=[6,u],r=0}finally{i=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},va=d(function(t,n,e,i){n===void 0&&(n="parent_id"),e===void 0&&(e="position"),i===void 0&&(i=!1);var r=i?gn:mn,a=H(H({},t),{getTree:d(function(c,s){return ue(void 0,void 0,void 0,function(){var l,o;return ce(this,function(u){switch(u.label){case 0:return[4,t.getList(c,{filter:s==null?void 0:s.filter,sort:{field:e,order:"ASC"},pagination:{page:1,perPage:1e3},meta:s==null?void 0:s.meta})];case 1:return l=u.sent().data,o=l.map(function(f){return H(H({},f),{children:l.filter(function(b){return b[n]==f.id}).sort(function(b,g){return b[e]-g[e]}).map(function(b){return b.id})})}),[2,{data:o}]}})})},"getTree"),getRootNodes:d(function(c,s){return ue(void 0,void 0,void 0,function(){var l,o,u;return ce(this,function(f){switch(f.label){case 0:return[4,t.getList(c,{filter:H(H({},s==null?void 0:s.filter),(u={},u[n]=null,u)),sort:{field:e,order:"ASC"},pagination:{page:1,perPage:1e3},meta:s==null?void 0:s.meta})];case 1:return l=f.sent().data,[4,Promise.all(l.map(function(b){var g;return t.getList(c,{filter:(g={},g[n]=b.id,g),sort:{field:e,order:"ASC"},pagination:{page:1,perPage:1e3},meta:s==null?void 0:s.meta}).then(function(j){var S=j.data;return H(H({},b),{children:S.map(function(_){var w=_.id;return w})})})}))];case 2:return o=f.sent(),[2,{data:o}]}})})},"getRootNodes"),getParentNode:d(function(c,s){return ue(void 0,[c,s],void 0,function(l,o){var u,f,b,g=o.childId,j=o.meta;return ce(this,function(S){switch(S.label){case 0:return[4,a.getTree(l,{meta:j})];case 1:return u=S.sent().data,f=u.find(function(_){return _.id===g}),f?(b=u.find(function(_){return _.id===f[n]}),[2,{data:b}]):[2,{data:void 0}]}})})},"getParentNode"),getChildNodes:d(function(c,s){return ue(void 0,[c,s],void 0,function(l,o){var u,f,b,g=o.parentId,j=o.meta;return ce(this,function(S){switch(S.label){case 0:return[4,t.getList(l,{filter:(b={},b[n]=g,b),sort:{field:e,order:"ASC"},pagination:{page:1,perPage:1e3},meta:j})];case 1:return u=S.sent().data,[4,Promise.all(u.map(function(_){var w;return t.getList(l,{filter:(w={},w[n]=_.id,w),sort:{field:e,order:"ASC"},pagination:{page:1,perPage:1e3},meta:j}).then(function(h){var v=h.data;return H(H({},_),{children:v.map(function(y){var p=y.id;return p})})})}))];case 2:return f=S.sent(),[2,{data:f}]}})})},"getChildNodes"),moveAsNthChildOf:d(function(c,s){return ue(void 0,[c,s],void 0,function(l,o){var u,f,b,g,j,S,_=o.source,w=o.destination,h=o.position,v=o.meta;return ce(this,function(y){switch(y.label){case 0:return[4,t.getList(l,{filter:(g={},g[n]=w.id,g["".concat(e,"_gte")]=h,g),sort:{field:e,order:"ASC"},pagination:{page:1,perPage:1e3},meta:v})];case 1:return u=y.sent().data,u.length>0?[4,Promise.all(u.map(function(p){var x;return t.update(l,{id:p.id,data:(x={},x[e]=p[e]+1,x),previousData:p,meta:v})}))]:[3,3];case 2:y.sent(),y.label=3;case 3:return[4,t.getList(l,{filter:(j={},j[n]=_[n],j["".concat(e,"_gt")]=_[e],j),sort:{field:e,order:"ASC"},pagination:{page:1,perPage:1e3},meta:v})];case 4:return f=y.sent().data,f.length>0?[4,Promise.all(f.map(function(p){var x;return t.update(l,{id:p.id,data:(x={},x[e]=p[e]-1,x),previousData:p,meta:v})}))]:[3,6];case 5:y.sent(),y.label=6;case 6:return[4,t.update(l,{id:_.id,data:(S={},S[n]=w.id,S[e]=h,S),previousData:_,meta:v})];case 7:return b=y.sent().data,[2,{data:b}]}})})},"moveAsNthChildOf"),moveAsNthSiblingOf:d(function(c,s){return ue(void 0,[c,s],void 0,function(l,o){var u,f,b,g,j,S,_,w,h,v,y,p,x,O,C=o.source,m=o.destination,P=o.position,D=o.meta;return ce(this,function(A){switch(A.label){case 0:return(P===0||P===-1)&&(u=(S={},S[n]=m[n],S)),C[e]>m[e]&&C[n]===m[n]&&(P===-1?u=(_={},_[n]=m[n],_["".concat(e,"_gte")]=m[e],_):u=(w={},w[n]=m[n],w["".concat(e,"_gt")]=m[e],w)),C[n]!==m[n]&&P>0&&(u=(h={},h[n]=m[n],h["".concat(e,"_gt")]=m[e],h)),u?[4,t.getList(l,{filter:u,sort:{field:e,order:"ASC"},pagination:{page:1,perPage:1e3},meta:D})]:[3,3];case 1:return f=A.sent().data,f.length>0?[4,Promise.all(f.map(function(M){var k;return M.id===C.id?Promise.resolve(void 0):t.update(l,{id:M.id,data:(k={},k[e]=M[e]+1,k),previousData:M,meta:D})}))]:[3,3];case 2:A.sent(),A.label=3;case 3:return C[n]===m[n]?C[e]>m[e]?b=(v={},v[n]=C[n],v["".concat(e,"_gt")]=C[e],v):b=(y={},y[n]=C[n],y["".concat(e,"_gt")]=C[e],y["".concat(e,"_lte")]=m[e],y):b=(p={},p[n]=C[n],p["".concat(e,"_gt")]=C[e],p),[4,t.getList(l,{filter:b,sort:{field:e,order:"ASC"},pagination:{page:1,perPage:1e3},meta:D})];case 4:return g=A.sent().data,g.length>0?[4,Promise.all(g.map(function(M){var k;return M.id===C.id?Promise.resolve(void 0):t.update(l,{id:M.id,data:(k={},k[e]=M[e]-1,k),previousData:M,meta:D})}))]:[3,6];case 5:A.sent(),A.label=6;case 6:return j=C[n]===m[n]?C[e]>m[e]?m[e]+1:m[e]:P<0?0:P,P===-1&&(j=0),[4,t.update(l,{id:C.id,data:(x={},x[n]=(O=m[n])!==null&&O!==void 0?O:null,x[e]=j,x),previousData:C,meta:D})];case 7:return A.sent(),[2,{data:void 0}]}})})},"moveAsNthSiblingOf"),addRootNode:d(function(c,s){return ue(void 0,[c,s],void 0,function(l,o){var u,f,b,g,j,S=o.data,_=o.meta;return ce(this,function(w){switch(w.label){case 0:return[4,t.getList(l,{filter:(g={},g[n]=null,g),sort:{field:e,order:"ASC"},pagination:{page:1,perPage:1e3},meta:_})];case 1:return u=w.sent().data,f=u.length>0?u.reduce(function(h,v){return v[e]>h?v[e]:h},-1/0)+1:0,[4,t.create(l,{data:H(H({},S),(j={},j[n]=null,j[e]=f,j)),meta:_})];case 2:return b=w.sent().data,[2,{data:H(H({},b),{children:[]})}]}})})},"addRootNode"),addChildNode:d(function(c,s){return ue(void 0,[c,s],void 0,function(l,o){var u,f,b,g,j,S,_=o.parentId,w=o.data,h=o.meta,v=o.position;return ce(this,function(y){switch(y.label){case 0:return[4,t.getList(l,{filter:(j={},j[n]=_,j),sort:{field:e,order:"ASC"},pagination:{page:1,perPage:1e3},meta:h})];case 1:return u=y.sent().data,f=u.length>0?u.reduce(function(p,x){return x[e]>p?x[e]:p},-1/0)+1:0,b=v!==void 0&&v>=0&&v<=f?v:f,[4,t.create(l,{data:H(H({},w),(S={},S[n]=_,S[e]=b,S)),meta:h})];case 2:return g=y.sent().data,v!==void 0&&v>=0&&v<=f&&u.forEach(function(p){var x;p[e]>=v&&t.update(l,{id:p.id,data:H(H({},p),(x={},x[e]=p[e]+1,x)),previousData:p,meta:h})}),[2,{data:H(H({},g),{children:[]})}]}})})},"addChildNode"),deleteBranch:d(function(c,s){return ue(void 0,void 0,void 0,function(){var l,o,u,f;return ce(this,function(b){switch(b.label){case 0:return l=s.id,o=s.previousData,u=s.meta,[4,r(a,c,s)];case 1:return b.sent(),[4,a.getChildNodes(c,{parentId:o[n],meta:u})];case 2:return f=b.sent().data,[4,Promise.all(f.filter(function(g){return g[e]>o[e]&&g.id!==l}).map(function(g){var j;return t.update(c,{id:g.id,data:H(H({},g),(j={},j[e]=g[e]-1,j)),previousData:g,meta:u})}))];case 3:return b.sent(),[2,{data:o}]}})})},"deleteBranch")});return a},"addTreeMethodsBasedOnParentAndPosition"),Ce=function(){return Ce=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ce.apply(this,arguments)},cr=function(t,n,e,i){function r(a){return a instanceof e?a:new e(function(c){c(a)})}return d(r,"adopt"),new(e||(e=Promise))(function(a,c){function s(u){try{o(i.next(u))}catch(f){c(f)}}d(s,"fulfilled");function l(u){try{o(i.throw(u))}catch(f){c(f)}}d(l,"rejected");function o(u){u.done?a(u.value):r(u.value).then(s,l)}d(o,"step"),o((i=i.apply(t,n||[])).next())})},dr=function(t,n){var e={label:0,sent:d(function(){if(a[0]&1)throw a[1];return a[1]},"sent"),trys:[],ops:[]},i,r,a,c;return c={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function s(o){return function(u){return l([o,u])}}function l(o){if(i)throw new TypeError("Generator is already executing.");for(;c&&(c=0,o[0]&&(e=0)),e;)try{if(i=1,r&&(a=o[0]&2?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[o[0]&2,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,r=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){e.label=o[1];break}if(o[0]===6&&e.label<a[1]){e.label=a[1],a=o;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(o);break}a[2]&&e.ops.pop(),e.trys.pop();continue}o=n.call(t,e)}catch(u){o=[6,u],r=0}finally{i=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},sr=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},lr=function(t,n,e){if(e||arguments.length===2)for(var i=0,r=n.length,a;i<r;i++)(a||!(i in n))&&(a||(a=Array.prototype.slice.call(n,0,i)),a[i]=n[i]);return t.concat(a||Array.prototype.slice.call(n))},fr=d(function(t,n,e){n===void 0&&(n={}),e===void 0&&(e={});var i=Pe(),r=De(),a=N.useRef(n),c=Ae(Ce(Ce({mutationFn:d(function(l){var o=l===void 0?{}:l,u=o.resource,f=u===void 0?t:u,b=o.data,g=b===void 0?a.current.data:b,j=o.meta,S=j===void 0?a.current.meta:j;if(!f)throw new Error("useAddRootNode mutation requires a non-empty resource");if(g==null)throw new Error("useAddRootNode mutation requires non-empty data");return i.addRootNode(f,{data:g,meta:S}).then(function(_){var w=_.data;return w})},"mutationFn")},e),{onSuccess:d(function(l,o,u){o===void 0&&(o={});var f=o.resource,b=f===void 0?t:f;r.setQueryData([b,"getOne",{id:String(l.id)}],l),e.onSuccess&&e.onSuccess(l,o,u)},"onSuccess")})),s=d(function(){for(var l=[],o=0;o<arguments.length;o++)l[o]=arguments[o];return cr(void 0,lr([],l,!0),void 0,function(u,f,b){var g,j;return u===void 0&&(u=t),f===void 0&&(f={}),b===void 0&&(b={}),dr(this,function(S){return g=b.returnPromise,j=sr(b,["returnPromise"]),g?[2,c.mutateAsync(Ce({resource:u},f),b)]:(c.mutate(Ce({resource:u},f),j),[2])})})},"addRootNode");return[s,c]},"useAddRootNode"),ne=function(){return ne=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ne.apply(this,arguments)},pt=function(t,n,e,i){function r(a){return a instanceof e?a:new e(function(c){c(a)})}return d(r,"adopt"),new(e||(e=Promise))(function(a,c){function s(u){try{o(i.next(u))}catch(f){c(f)}}d(s,"fulfilled");function l(u){try{o(i.throw(u))}catch(f){c(f)}}d(l,"rejected");function o(u){u.done?a(u.value):r(u.value).then(s,l)}d(o,"step"),o((i=i.apply(t,n||[])).next())})},xt=function(t,n){var e={label:0,sent:d(function(){if(a[0]&1)throw a[1];return a[1]},"sent"),trys:[],ops:[]},i,r,a,c;return c={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function s(o){return function(u){return l([o,u])}}function l(o){if(i)throw new TypeError("Generator is already executing.");for(;c&&(c=0,o[0]&&(e=0)),e;)try{if(i=1,r&&(a=o[0]&2?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[o[0]&2,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,r=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){e.label=o[1];break}if(o[0]===6&&e.label<a[1]){e.label=a[1],a=o;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(o);break}a[2]&&e.ops.pop(),e.trys.pop();continue}o=n.call(t,e)}catch(u){o=[6,u],r=0}finally{i=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},vr=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},Je=function(t,n,e){if(e||arguments.length===2)for(var i=0,r=n.length,a;i<r;i++)(a||!(i in n))&&(a||(a=Array.prototype.slice.call(n,0,i)),a[i]=n[i]);return t.concat(a||Array.prototype.slice.call(n))},Xt=d(function(t,n,e){n===void 0&&(n={}),e===void 0&&(e={});var i=Pe(),r=De(),a=n.id,c=n.previousData,s=e.mutationMode,l=s===void 0?"pessimistic":s,o=vr(e,["mutationMode"]),u=N.useRef(l),f=N.useRef(n),b=N.useRef([]),g=d(function(_){var w=_.resource,h=_.id,v=Date.now(),y=u.current==="undoable"?v+5*1e3:v,p=d(function(O,C){var m=O.findIndex(function(T){return T.id==C});if(m===-1)return O;for(var P=O[m],D=Je(Je([],O.slice(0,m),!0),O.slice(m+1),!0),A=P.children||[],M=0,k=A;M<k.length;M++){var R=k[M];D=p(D,R)}return D},"removeRecord"),x=d(function(O){var C=p(O,h);return C.map(function(m){return ne(ne({},m),{children:m.children?m.children.filter(function(P){return P!==h}):m.children})})},"updateCollection");r.setQueriesData({queryKey:[w,"getTree"]},function(O){if(!O)return O;var C=x(O),m=C.length<O.length;return m?C:O},{updatedAt:y}),r.setQueriesData({queryKey:[w,"getRootNodes"]},function(O){return O&&O.length>0?x(O):O},{updatedAt:y}),r.setQueriesData({queryKey:[w,"getChildNodes"]},function(O){if(!O)return O;var C=x(O),m=C.length<O.length;return m?C:O},{updatedAt:y})},"updateCache"),j=Ae(ne(ne({mutationFn:d(function(_){var w=_===void 0?{}:_,h=w.resource,v=h===void 0?t:h,y=w.id,p=y===void 0?f.current.id:y,x=w.previousData,O=x===void 0?f.current.previousData:x,C=w.meta,m=C===void 0?f.current.meta:C;if(!v)throw new Error("useDeleteBranch mutation requires a non-empty resource");if(p==null)throw new Error("useDeleteBranch mutation requires non-empty id");if(O==null)throw new Error("useDeleteBranch mutation requires non-empty previousData");return i.deleteBranch(v,{id:p,previousData:O,meta:m}).then(function(P){var D=P.data;return D})},"mutationFn")},o),{onMutate:d(function(_){return pt(void 0,void 0,void 0,function(){var w;return xt(this,function(h){switch(h.label){case 0:return o.onMutate?[4,o.onMutate(_)]:[3,2];case 1:return w=h.sent()||{},[2,ne({snapshot:b.current},w)];case 2:return[2,{snapshot:b.current}]}})})},"onMutate"),onError:d(function(_,w,h){if((u.current==="optimistic"||u.current==="undoable")&&h.snapshot.forEach(function(v){var y=v[0],p=v[1];r.setQueryData(y,p)}),o.onError)return o.onError(_,w,h)},"onError"),onSuccess:d(function(_,w,h){if(w===void 0&&(w={}),u.current==="pessimistic"){var v=w.resource,y=v===void 0?t:v,p=w.id,x=p===void 0?a:p;g({resource:y,id:x}),o.onSuccess&&o.onSuccess(_,w,h)}},"onSuccess"),onSettled:d(function(_,w,h,v){if(h===void 0&&(h={}),(u.current==="optimistic"||u.current==="undoable")&&v.snapshot.forEach(function(y){var p=y[0];r.invalidateQueries({queryKey:p})}),o.onSettled)return o.onSettled(_,w,h,v)},"onSettled")})),S=d(function(){for(var _=[],w=0;w<arguments.length;w++)_[w]=arguments[w];return pt(void 0,Je([],_,!0),void 0,function(h,v,y){var p,x,O,C,m,P,D,A,M;return h===void 0&&(h=t),v===void 0&&(v={}),y===void 0&&(y={}),xt(this,function(k){switch(k.label){case 0:return p=y.mutationMode,x=y.onSuccess,O=y.onSettled,C=y.onError,f.current=n,p&&(u.current=p),u.current==="pessimistic"?[2,j.mutate(ne({resource:h},v),{onSuccess:x,onSettled:O,onError:C})]:(m=v.id,P=m===void 0?a:m,D=v.previousData,A=D===void 0?c:D,M=[[h,"getTree"],[h,"getRootNodes"],[h,"getChildNodes"]],b.current=M.reduce(function(R,T){return R.concat(r.getQueriesData({queryKey:T}))},[]),[4,Promise.all(b.current.map(function(R){var T=R[0];return r.cancelQueries({queryKey:T})}))]);case 1:return k.sent(),g({resource:h,id:P}),x&&setTimeout(function(){return x(A,ne({resource:h},v),{snapshot:b.current})},0),o.onSuccess&&setTimeout(function(){o.onSuccess&&o.onSuccess(A,ne({resource:h},v),{snapshot:b.current})},0),u.current==="optimistic"?[2,j.mutate(ne({resource:h},v),{onSettled:O,onError:C})]:(yt.once("end",function(R){var T=R.isUndo;T?b.current.forEach(function(B){var q=B[0],I=B[1];r.setQueryData(q,I)}):j.mutate(ne({resource:h},v),{onSettled:O,onError:C})}),[2])}})})},"mutate");return[S,j]},"useDeleteBranch"),ye=function(){return ye=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ye.apply(this,arguments)},hr=d(function(t,n,e){var i=Pe(),r=Ae(ye({mutationKey:[t,"getChildNodes",n],mutationFn:d(function(c){return i.getChildNodes(t,ye(ye({},n),c)).then(function(s){var l=s.data;return l})},"mutationFn")},e)),a=te(function(c){return r.mutateAsync(ye(ye({},n),{parentId:c}))});return a},"useGetChildNodesCallback"),Qe=function(){return Qe=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Qe.apply(this,arguments)},ha=d(function(t){return Qe(Qe({},t),{children:t.children.map(function(n){return n.id})})},"removeChildren"),tt=function(){return tt=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},tt.apply(this,arguments)},yr=d(function(t,n,e){n===void 0&&(n={}),e===void 0&&(e={});var i=Pe(),r=De(),a=Ae(tt({mutationKey:[t,"getTree",n],mutationFn:d(function(){return i.getTree(t,n).then(function(s){var l=s.data;return l})},"mutationFn"),onSuccess:d(function(s){bn(r,t,s,n)},"onSuccess")},e)),c=N.useCallback(function(){return a.mutateAsync(n)},[a,n]);return c},"useGetTreeCallback"),ie=function(){return ie=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ie.apply(this,arguments)},Ot=function(t,n,e,i){function r(a){return a instanceof e?a:new e(function(c){c(a)})}return d(r,"adopt"),new(e||(e=Promise))(function(a,c){function s(u){try{o(i.next(u))}catch(f){c(f)}}d(s,"fulfilled");function l(u){try{o(i.throw(u))}catch(f){c(f)}}d(l,"rejected");function o(u){u.done?a(u.value):r(u.value).then(s,l)}d(o,"step"),o((i=i.apply(t,n||[])).next())})},Ct=function(t,n){var e={label:0,sent:d(function(){if(a[0]&1)throw a[1];return a[1]},"sent"),trys:[],ops:[]},i,r,a,c;return c={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function s(o){return function(u){return l([o,u])}}function l(o){if(i)throw new TypeError("Generator is already executing.");for(;c&&(c=0,o[0]&&(e=0)),e;)try{if(i=1,r&&(a=o[0]&2?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[o[0]&2,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,r=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){e.label=o[1];break}if(o[0]===6&&e.label<a[1]){e.label=a[1],a=o;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(o);break}a[2]&&e.ops.pop(),e.trys.pop();continue}o=n.call(t,e)}catch(u){o=[6,u],r=0}finally{i=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},gr=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},le=function(t,n,e){if(e||arguments.length===2)for(var i=0,r=n.length,a;i<r;i++)(a||!(i in n))&&(a||(a=Array.prototype.slice.call(n,0,i)),a[i]=n[i]);return t.concat(a||Array.prototype.slice.call(n))},mr=d(function(t,n,e){n===void 0&&(n={source:void 0,destination:void 0,position:void 0,meta:void 0}),e===void 0&&(e={});var i=Pe(),r=De(),a=n.source,c=n.destination,s=n.position,l=e.mutationMode,o=l===void 0?"undoable":l,u=gr(e,["mutationMode"]),f=N.useRef(o),b=N.useRef(n),g=N.useRef([]),j=d(function(w){var h=w.resource,v=w.position,y=w.source,p=w.destination,x=Date.now(),O=f.current==="undoable"?x+5*1e3:x,C=d(function(m){var P,D,A,M,k,R=Le(m),T=R.find(function(q){var I;return(I=q.children)===null||I===void 0?void 0:I.includes(y.id)});T?T.children=(P=T.children)===null||P===void 0?void 0:P.filter(function(q){return q!==y.id}):R=R.filter(function(q){return q.id!==y.id});var B=R.find(function(q){return q.id===p.id});return B?B.children=le(le(le([],(A=(D=B.children)===null||D===void 0?void 0:D.slice(0,v))!==null&&A!==void 0?A:[],!0),[y.id],!1),(k=(M=B.children)===null||M===void 0?void 0:M.slice(v))!==null&&k!==void 0?k:[],!0):(R=R.filter(function(q){return q.id!==y.id}),R=le(le(le([],R.slice(0,v),!0),[y],!1),R.slice(v),!0)),R},"updateCollection");r.setQueriesData({queryKey:[h,"getTree"]},function(m){return m&&m.length>0?C(m):m},{updatedAt:O}),r.setQueriesData({queryKey:[h,"getRootNodes"]},function(m){return m&&m.length>0?C(m):m},{updatedAt:O}),r.setQueriesData({queryKey:[h,"getChildNodes"]},function(m){return m&&m.length>0?C(m):m},{updatedAt:O})},"updateCache"),S=Ae(ie(ie({mutationFn:d(function(w){var h=w===void 0?{}:w,v=h.resource,y=v===void 0?t:v,p=h.position,x=p===void 0?b.current.position:p,O=h.source,C=O===void 0?b.current.source:O,m=h.destination,P=m===void 0?b.current.destination:m,D=h.meta,A=D===void 0?b.current.meta:D;if(y==null)throw new Error("useMoveAsNthChildOf mutation requires a non-empty resource");if(x==null)throw new Error("useMoveAsNthChildOf mutation requires a non-empty position");if(C==null)throw new Error("useMoveAsNthChildOf mutation requires a non-empty source");if(P==null)throw new Error("useMoveAsNthChildOf mutation requires a non-empty destination");return i.moveAsNthChildOf(y,{position:x,source:C,destination:P,meta:A}).then(function(M){var k=M.data;return k})},"mutationFn")},u),{onMutate:d(function(w){return Ot(void 0,void 0,void 0,function(){var h;return Ct(this,function(v){switch(v.label){case 0:return u.onMutate?[4,u.onMutate(w)]:[3,2];case 1:return h=v.sent()||{},[2,ie({snapshot:g.current},h)];case 2:return[2,{snapshot:g.current}]}})})},"onMutate"),onError:d(function(w,h,v){if((f.current==="optimistic"||f.current==="undoable")&&v.snapshot.forEach(function(y){var p=y[0],x=y[1];r.setQueryData(p,x)}),u.onError)return u.onError(w,h,v)},"onError"),onSettled:d(function(w,h,v,y){v===void 0&&(v={});var p=v.resource,x=p===void 0?t:p;if(r.invalidateQueries({queryKey:[x,"getTree"]}),r.invalidateQueries({queryKey:[x,"getRootNodes"]}),r.invalidateQueries({queryKey:[x,"getChildNodes"]}),u.onSettled)return u.onSettled(w,h,v,y)},"onSettled")})),_=d(function(){for(var w=[],h=0;h<arguments.length;h++)w[h]=arguments[h];return Ot(void 0,le([],w,!0),void 0,function(v,y,p){var x,O,C,m,P,D,A,M,k,R,T;return v===void 0&&(v=t),y===void 0&&(y={}),p===void 0&&(p={}),Ct(this,function(B){switch(B.label){case 0:if(x=p.mutationMode,O=p.onSuccess,C=p.onSettled,m=p.onError,b.current=n,x&&(f.current=x),f.current==="pessimistic")return[2,S.mutate(ie({resource:v},y),{onSuccess:O,onSettled:C,onError:m})];if(P=y.position,D=P===void 0?s:P,A=y.source,M=A===void 0?a:A,k=y.destination,R=k===void 0?c:k,v==null)throw new Error("useMoveAsNthChildOf mutation requires a non-empty resource");if(D==null)throw new Error("useMoveAsNthChildOf mutation requires a non-empty position");if(M==null)throw new Error("useMoveAsNthChildOf mutation requires a non-empty source");if(R==null)throw new Error("useMoveAsNthChildOf mutation requires a non-empty destination");return T=[[v,"getTree"],[v,"getRootNodes"],[v,"getChildNodes"]],g.current=T.reduce(function(q,I){return q.concat(r.getQueriesData({queryKey:I}))},[]),[4,Promise.all(g.current.map(function(q){var I=q[0];return r.cancelQueries({queryKey:I})}))];case 1:return B.sent(),j({resource:v,position:D,source:M,destination:R}),O&&setTimeout(function(){return O(void 0,ie({resource:v},y),{snapshot:g.current})},0),u.onSuccess&&setTimeout(function(){u.onSuccess&&u.onSuccess(void 0,ie({resource:v},y),{snapshot:g.current})},0),f.current==="optimistic"?[2,S.mutate(ie({resource:v},y),{onSettled:C,onError:m})]:(yt.once("end",function(q){var I=q.isUndo;I?g.current.forEach(function(L){var W=L[0],V=L[1];r.setQueryData(W,V)}):S.mutate(ie({resource:v},y),{onSettled:C,onError:m})}),[2])}})})},"mutate");return[_,S]},"useMoveAsNthChildOf"),oe=function(){return oe=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},oe.apply(this,arguments)},St=function(t,n,e,i){function r(a){return a instanceof e?a:new e(function(c){c(a)})}return d(r,"adopt"),new(e||(e=Promise))(function(a,c){function s(u){try{o(i.next(u))}catch(f){c(f)}}d(s,"fulfilled");function l(u){try{o(i.throw(u))}catch(f){c(f)}}d(l,"rejected");function o(u){u.done?a(u.value):r(u.value).then(s,l)}d(o,"step"),o((i=i.apply(t,n||[])).next())})},jt=function(t,n){var e={label:0,sent:d(function(){if(a[0]&1)throw a[1];return a[1]},"sent"),trys:[],ops:[]},i,r,a,c;return c={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function s(o){return function(u){return l([o,u])}}function l(o){if(i)throw new TypeError("Generator is already executing.");for(;c&&(c=0,o[0]&&(e=0)),e;)try{if(i=1,r&&(a=o[0]&2?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[o[0]&2,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,r=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){e.label=o[1];break}if(o[0]===6&&e.label<a[1]){e.label=a[1],a=o;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(o);break}a[2]&&e.ops.pop(),e.trys.pop();continue}o=n.call(t,e)}catch(u){o=[6,u],r=0}finally{i=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},br=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},fe=function(t,n,e){if(e||arguments.length===2)for(var i=0,r=n.length,a;i<r;i++)(a||!(i in n))&&(a||(a=Array.prototype.slice.call(n,0,i)),a[i]=n[i]);return t.concat(a||Array.prototype.slice.call(n))},wr=d(function(t,n,e){n===void 0&&(n={source:void 0,destination:void 0,position:void 0,meta:void 0}),e===void 0&&(e={});var i=Pe(),r=De(),a=n.source,c=n.destination,s=n.position,l=e.mutationMode,o=l===void 0?"undoable":l,u=br(e,["mutationMode"]),f=N.useRef(o),b=N.useRef(n),g=N.useRef([]),j=d(function(w){var h=w.resource,v=w.position,y=w.source,p=w.destination,x=Date.now(),O=f.current==="undoable"?x+5*1e3:x,C=d(function(m){var P,D,A,M,k,R=Le(m),T=R.find(function(L){var W;return(W=L.children)===null||W===void 0?void 0:W.includes(y.id)}),B=R.find(function(L){var W;return(W=L.children)===null||W===void 0?void 0:W.includes(p.id)}),q=v;T&&B&&T.id===B.id&&T.children&&T.children.findIndex(function(L){return L===y.id})<T.children.findIndex(function(L){return L===p.id})&&(q=v-1);var I=q<0?0:q;return T?T.children=(P=T.children)===null||P===void 0?void 0:P.filter(function(L){return L!==y.id}):R=R.filter(function(L){return L.id!==y.id}),B?B.children=fe(fe(fe([],(A=(D=B.children)===null||D===void 0?void 0:D.slice(0,I))!==null&&A!==void 0?A:[],!0),[y.id],!1),(k=(M=B.children)===null||M===void 0?void 0:M.slice(I))!==null&&k!==void 0?k:[],!0):(R=R.filter(function(L){return L.id!==y.id}),R=fe(fe(fe([],R.slice(0,I),!0),[y],!1),R.slice(I),!0)),R},"updateCollection");r.setQueriesData({queryKey:[h,"getTree"]},function(m){return m&&m.length>0?C(m):m},{updatedAt:O}),r.setQueriesData({queryKey:[h,"getRootNodes"]},function(m){return m&&m.length>0?C(m):m},{updatedAt:O}),r.setQueriesData({queryKey:[h,"getChildNodes"]},function(m){return m&&m.length>0?C(m):m},{updatedAt:O})},"updateCache"),S=Ae(oe(oe({mutationFn:d(function(w){var h=w===void 0?{}:w,v=h.resource,y=v===void 0?t:v,p=h.position,x=p===void 0?b.current.position:p,O=h.source,C=O===void 0?b.current.source:O,m=h.destination,P=m===void 0?b.current.destination:m,D=h.meta,A=D===void 0?b.current.meta:D;if(y==null)throw new Error("useMoveAsNthSiblingOf mutation requires a non-empty resource");if(x==null)throw new Error("useMoveAsNthSiblingOf mutation requires a non-empty position");if(C==null)throw new Error("useMoveAsNthSiblingOf mutation requires a non-empty source");if(P==null)throw new Error("useMoveAsNthSiblingOf mutation requires a non-empty destination");return i.moveAsNthSiblingOf(y,{position:x,source:C,destination:P,meta:A}).then(function(M){var k=M.data;return k})},"mutationFn")},u),{onMutate:d(function(w){return St(void 0,void 0,void 0,function(){var h;return jt(this,function(v){switch(v.label){case 0:return u.onMutate?[4,u.onMutate(w)]:[3,2];case 1:return h=v.sent()||{},[2,oe({snapshot:g.current},h)];case 2:return[2,{snapshot:g.current}]}})})},"onMutate"),onError:d(function(w,h,v){if((f.current==="optimistic"||f.current==="undoable")&&v.snapshot.forEach(function(y){var p=y[0],x=y[1];r.setQueryData(p,x)}),u.onError)return u.onError(w,h,v)},"onError"),onSettled:d(function(w,h,v,y){v===void 0&&(v={});var p=v.resource,x=p===void 0?t:p;if(r.invalidateQueries({queryKey:[x,"getTree"]}),r.invalidateQueries({queryKey:[x,"getRootNodes"]}),r.invalidateQueries({queryKey:[x,"getChildNodes"]}),u.onSettled)return u.onSettled(w,h,v,y)},"onSettled")})),_=d(function(){for(var w=[],h=0;h<arguments.length;h++)w[h]=arguments[h];return St(void 0,fe([],w,!0),void 0,function(v,y,p){var x,O,C,m,P,D,A,M,k,R,T;return v===void 0&&(v=t),y===void 0&&(y={}),p===void 0&&(p={}),jt(this,function(B){switch(B.label){case 0:if(x=p.mutationMode,O=p.onSuccess,C=p.onSettled,m=p.onError,b.current=n,x&&(f.current=x),f.current==="pessimistic")return[2,S.mutate(oe({resource:v},y),{onSuccess:O,onSettled:C,onError:m})];if(P=y.position,D=P===void 0?s:P,A=y.source,M=A===void 0?a:A,k=y.destination,R=k===void 0?c:k,v==null)throw new Error("useMoveAsNthSiblingOf mutation requires a non-empty resource");if(D==null)throw new Error("useMoveAsNthSiblingOf mutation requires a non-empty position");if(M==null)throw new Error("useMoveAsNthSiblingOf mutation requires a non-empty source");if(R==null)throw new Error("useMoveAsNthSiblingOf mutation requires a non-empty destination");return T=[[v,"getTree"],[v,"getRootNodes"],[v,"getChildNodes"]],g.current=T.reduce(function(q,I){return q.concat(r.getQueriesData({queryKey:I}))},[]),[4,Promise.all(g.current.map(function(q){var I=q[0];return r.cancelQueries({queryKey:I})}))];case 1:return B.sent(),j({resource:v,position:D,source:M,destination:R}),O&&setTimeout(function(){return O(void 0,oe({resource:v},y),{snapshot:g.current})},0),u.onSuccess&&setTimeout(function(){u.onSuccess&&u.onSuccess(void 0,oe({resource:v},y),{snapshot:g.current})},0),f.current==="optimistic"?[2,S.mutate(oe({resource:v},y),{onSettled:C,onError:m})]:(yt.once("end",function(q){var I=q.isUndo;I?g.current.forEach(function(L){var W=L[0],V=L[1];r.setQueryData(W,V)}):S.mutate(oe({resource:v},y),{onSettled:C,onError:m})}),[2])}})})},"mutate");return[_,S]},"useMoveAsNthSiblingOf"),de=function(){return de=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},de.apply(this,arguments)},Et=function(t,n,e,i){function r(a){return a instanceof e?a:new e(function(c){c(a)})}return d(r,"adopt"),new(e||(e=Promise))(function(a,c){function s(u){try{o(i.next(u))}catch(f){c(f)}}d(s,"fulfilled");function l(u){try{o(i.throw(u))}catch(f){c(f)}}d(l,"rejected");function o(u){u.done?a(u.value):r(u.value).then(s,l)}d(o,"step"),o((i=i.apply(t,n||[])).next())})},Nt=function(t,n){var e={label:0,sent:d(function(){if(a[0]&1)throw a[1];return a[1]},"sent"),trys:[],ops:[]},i,r,a,c;return c={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function s(o){return function(u){return l([o,u])}}function l(o){if(i)throw new TypeError("Generator is already executing.");for(;c&&(c=0,o[0]&&(e=0)),e;)try{if(i=1,r&&(a=o[0]&2?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[o[0]&2,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,r=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){e.label=o[1];break}if(o[0]===6&&e.label<a[1]){e.label=a[1],a=o;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(o);break}a[2]&&e.ops.pop(),e.trys.pop();continue}o=n.call(t,e)}catch(u){o=[6,u],r=0}finally{i=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},ya=d(function(t){return de(de({},t),{getRootNodes:d(function(n,e){return Et(void 0,void 0,void 0,function(){var i,r;return Nt(this,function(a){switch(a.label){case 0:return[4,t.getRootNodes(n,e)];case 1:return i=a.sent().data,r=i.filter(function(c){return c.parent_id==null}),[2,{data:r,total:r.length}]}})})},"getRootNodes"),addRootNode:d(function(n,e){return Et(void 0,[n,e],void 0,function(i,r){var a,c,s,l,o=r.data,u=r.meta;return Nt(this,function(f){switch(f.label){case 0:return[4,t.getList(i,{filter:{parent_id:null},sort:{field:"position",order:"ASC"},pagination:{page:1,perPage:1e3},meta:u})];case 1:return a=f.sent().data,c=a.filter(function(b){return typeof b.parent_id>"u"}),s=c.length>0?c.reduce(function(b,g){return g.position>b?g.position:b},-1/0)+1:0,[4,t.create(i,{data:de(de({},o),{parent_id:null,position:s}),meta:u})];case 2:return l=f.sent().data,[2,{data:de(de({},l),{children:[]})}]}})})},"addRootNode")})},"fixFakeRestDataProvider"),Pt=function(t,n,e){if(e||arguments.length===2)for(var i=0,r=n.length,a;i<r;i++)(a||!(i in n))&&(a||(a=Array.prototype.slice.call(n,0,i)),a[i]=n[i]);return t.concat(a||Array.prototype.slice.call(n))},Ht=d(function(t,n){var e,i=t.filter(function(c){return c.id!==n.id}),r=i.find(function(c){var s;return(s=c.children)===null||s===void 0?void 0:s.includes(n.id)});if(r&&(r.children=(e=r.children)===null||e===void 0?void 0:e.filter(function(c){return c!==n.id})),!n.children||n.children.length===0)return i;var a=Jt(i,n);return i=i.filter(function(c){return!a.includes(c)}),i},"removeNode"),Jt=d(function(t,n){return n?!n.children||n.children.length===0?[]:Pt(Pt([],n.children,!0),n.children.flatMap(function(e){var i=t.find(function(r){return r.id===e});return i?Jt(t,i):[]}),!0):[]},"getNodeChildrenRecursive"),nt=function(){return nt=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},nt.apply(this,arguments)},Vt=d(function(t){var n=t.mutationMode,e=t.mutationOptions,i=t.redirect,r=i===void 0?"list":i,a=$e(),c=Xe(),s=wn(),l=re(t);if(l==null)throw new Error("The useDeleteBranchWithConfirmController hook must be used inside a ResourceContext or must be passed a resource prop.");var o=_e(t);if(o==null)throw new Error("The useDeleteBranchWithConfirmController hook must be used inside a RecordContext or must be passed a record prop.");var u=Xt(),f=u[0],b=u[1].isPending,g=N.useState(!1),j=g[0],S=g[1],_=gt().setFinalData,w=N.useCallback(function(y){y.stopPropagation(),f(l,{id:o.id,previousData:o},nt({mutationMode:n,onSuccess:d(function(){a("ra.notification.deleted",{type:"info",messageArgs:{smart_count:1}}),c(r,l),n==="pessimistic"?s():_&&_(function(p){return Ht(p,o)})},"onSuccess"),onError:d(function(p){a(typeof p=="string"?p:p.message||"ra.notification.http_error",{type:"warning"})},"onError")},e))},[f,n,e,a,o,c,r,s,l,_]),h=d(function(y){y.stopPropagation(),S(!0)},"handleDialogOpen"),v=d(function(y){y.stopPropagation(),S(!1)},"handleDialogClose");return{handleDelete:w,handleDialogOpen:h,handleDialogClose:v,isPending:b,open:j}},"useDeleteBranchWithConfirmController"),rt=function(){return rt=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},rt.apply(this,arguments)},Yt=d(function(t){var n=t.mutationOptions,e=t.redirect,i=e===void 0?"list":e,r=$e(),a=Xe(),c=gt().setFinalData,s=re(t);if(s==null)throw new Error("The useDeleteBranchWithUndoController hook must be used inside a ResourceContext or must be passed a resource prop.");var l=_e(t);if(l==null)throw new Error("The useDeleteBranchWithUndoController hook must be used inside a RecordContext or must be passed a record prop.");var o=Xt(),u=o[0],f=o[1].isPending,b=N.useCallback(function(g){g.stopPropagation(),u(s,{id:l.id,previousData:l},rt({onSuccess:d(function(){r("ra.notification.deleted",{type:"info",messageArgs:{smart_count:1},undoable:!0}),c&&c(function(j){return Ht(j,l)}),a(i,s)},"onSuccess"),onError:d(function(j){return r(typeof j=="string"?j:j.message||"ra.notification.http_error",{type:"warning"})},"onError"),mutationMode:"undoable"},n))},[u,n,r,l,a,i,s,c]);return{handleDelete:b,isPending:f}},"useDeleteBranchWithUndoController"),Se=function(){return Se=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Se.apply(this,arguments)},_r=function(t,n,e,i){function r(a){return a instanceof e?a:new e(function(c){c(a)})}return d(r,"adopt"),new(e||(e=Promise))(function(a,c){function s(u){try{o(i.next(u))}catch(f){c(f)}}d(s,"fulfilled");function l(u){try{o(i.throw(u))}catch(f){c(f)}}d(l,"rejected");function o(u){u.done?a(u.value):r(u.value).then(s,l)}d(o,"step"),o((i=i.apply(t,n||[])).next())})},pr=function(t,n){var e={label:0,sent:d(function(){if(a[0]&1)throw a[1];return a[1]},"sent"),trys:[],ops:[]},i,r,a,c;return c={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function s(o){return function(u){return l([o,u])}}function l(o){if(i)throw new TypeError("Generator is already executing.");for(;c&&(c=0,o[0]&&(e=0)),e;)try{if(i=1,r&&(a=o[0]&2?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[o[0]&2,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,r=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){e.label=o[1];break}if(o[0]===6&&e.label<a[1]){e.label=a[1],a=o;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(o);break}a[2]&&e.ops.pop(),e.trys.pop();continue}o=n.call(t,e)}catch(u){o=[6,u],r=0}finally{i=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},xr=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},Or=d(function(t){var n=t.disableAuthentication,e=t.record,i=e===void 0?{}:e,r=t.redirect,a=t.mutationOptions,c=a===void 0?{}:a,s=t.transform;Rt({enabled:!n});var l=re(t);if(l==null)throw new Error("The useCreateNodeController hook must be used inside a ResourceContext or must be passed a resource prop.");var o=vt(),u=De(),f=_n(),b=gt().handleAddNode,g=f.state&&f.state.parentId,j=f.state&&f.state.insertAsFirstChild,S=typeof g<"u"&&g!==null,_=f.state&&f.state.record||i,w=c.onSuccess,h=c.onError,v=xr(c,["onSuccess","onError"]),y=ht(t),p=y.hasEdit,x=y.hasShow,O=r||Cr(x,p),C=fr(l,void 0,v),m=C[0],P=C[1],D=pn(l,void 0,v),A=D[0],M=D[1],k=te(b??Sr);N.useEffect(function(){return k({record:{},parentId:g,insertAsFirstChild:j}),function(){k(void 0)}},[k,g,j]);var R=be(),T=$e(),B=Xe(),q=N.useCallback(function(W,V){var Q=V===void 0?{}:V,G=Q.onSuccess,z=Q.onError,K=Q.transform,$=d(function(U){T("ra.notification.created",{type:"info",messageArgs:{smart_count:1}}),B(O,l,U.id,U),u.refetchQueries({queryKey:[l,"getTree"],type:"active"}),u.refetchQueries({queryKey:[l,"getRootNodes"],type:"active"})},"defaultOnSuccess"),X=d(function(U){T(typeof U=="string"?U:U.message||"ra.notification.http_error",{type:"error"})},"defaultOnError");return Promise.resolve(K?K(W):s?s(W):W).then(function(U){return _r(void 0,void 0,void 0,function(){var ee,Y,Z;return pr(this,function(ae){switch(ae.label){case 0:ee={onSuccess:d(function(se,pe,J){k(void 0),G?G(se,pe,J):w?w(se,pe,J):$(se)},"onSuccess"),onError:z||h||X},ae.label=1;case 1:return ae.trys.push([1,6,,7]),S?[4,A(l,{data:U,parentId:g,meta:v.meta,position:j?0:void 0},Se(Se({},ee),{returnPromise:!0}))]:[3,3];case 2:return ae.sent(),[3,5];case 3:return[4,m(l,{data:U,meta:v.meta},Se(Se({},ee),{returnPromise:!0}))];case 4:ae.sent(),ae.label=5;case 5:return[3,7];case 6:return Y=ae.sent(),(Y instanceof xn||typeof Y=="object"&&Y!==null&&Y.hasOwnProperty("body"))&&((Z=Y.body)===null||Z===void 0?void 0:Z.errors)!=null?[2,Y.body.errors]:[3,7];case 7:return[2]}})})})},[A,m,k,S,T,h,w,g,u,B,l,s,v.meta,O,j]),I=o(l,1),L=R("ra.page.create",{name:"".concat(I)});return{isLoading:!1,isFetching:!1,defaultTitle:L,save:q,saving:P.isPending||M.isPending,isPending:P.isPending||M.isPending,resource:l,record:_,redirect:O}},"useCreateNodeController"),Cr=d(function(t,n){return n?"edit":t?"show":"list"},"getDefaultRedirectRoute"),Sr=d(function(){},"noop"),jr=function(t,n,e){if(e||arguments.length===2)for(var i=0,r=n.length,a;i<r;i++)(a||!(i in n))&&(a||(a=Array.prototype.slice.call(n,0,i)),a[i]=n[i]);return t.concat(a||Array.prototype.slice.call(n))},Zt=d(function(t,n){var e=n.find(function(i){return i.id==t});return e?jr([e.id],(e.children||[]).flatMap(function(i){return Zt(i,n)}),!0):[]},"getNodeIdsRecursively"),ge=function(){return ge=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ge.apply(this,arguments)},Ve=function(t,n,e,i){function r(a){return a instanceof e?a:new e(function(c){c(a)})}return d(r,"adopt"),new(e||(e=Promise))(function(a,c){function s(u){try{o(i.next(u))}catch(f){c(f)}}d(s,"fulfilled");function l(u){try{o(i.throw(u))}catch(f){c(f)}}d(l,"rejected");function o(u){u.done?a(u.value):r(u.value).then(s,l)}d(o,"step"),o((i=i.apply(t,n||[])).next())})},Ye=function(t,n){var e={label:0,sent:d(function(){if(a[0]&1)throw a[1];return a[1]},"sent"),trys:[],ops:[]},i,r,a,c;return c={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function s(o){return function(u){return l([o,u])}}function l(o){if(i)throw new TypeError("Generator is already executing.");for(;c&&(c=0,o[0]&&(e=0)),e;)try{if(i=1,r&&(a=o[0]&2?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[o[0]&2,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,r=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){e.label=o[1];break}if(o[0]===6&&e.label<a[1]){e.label=a[1],a=o;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(o);break}a[2]&&e.ops.pop(),e.trys.pop();continue}o=n.call(t,e)}catch(u){o=[6,u],r=0}finally{i=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Ze=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},ve=function(t,n,e){if(e||arguments.length===2)for(var i=0,r=n.length,a;i<r;i++)(a||!(i in n))&&(a||(a=Array.prototype.slice.call(n,0,i)),a[i]=n[i]);return t.concat(a||Array.prototype.slice.call(n))},Er=d(function(t){var n=be(),e=re(t);if(e==null)throw new Error("The useTreeController hook must be used inside a ResourceContext or must be passed a resource prop.");var i=vt(),r=t.lazy,a=r===void 0?!1:r,c=t.filter,s=c===void 0?{}:c,l=t.mutationMode,o=l===void 0?"undoable":l,u=t.meta,f=$t(e,{filter:s,meta:u},{enabled:!a}),b=On(e,{filter:s,meta:u},{enabled:a,gcTime:0}),g=hr(e,{meta:u}),j=N.useMemo(function(){var Q;return(Q=b.data)===null||Q===void 0?void 0:Q.map(function(G){var z=G.children,K=Ze(G,["children"]);return z!=null&&z.length?K:G})},[b.data,b.isFetching]),S=a?ge(ge({},b),{data:j}):f,_=S.data,w=S.error,h=S.isLoading,v=S.isPending,y=S.isFetching,p=N.useState(_),x=p[0],O=p[1],C=te(function(Q){return Ve(void 0,void 0,void 0,function(){var G;return Ye(this,function(z){switch(z.label){case 0:return[4,g(Q)];case 1:return G=z.sent(),O(function(K){var $,X=G.map(function(Y){var Z=Y.children,ae=Ze(Y,["children"]),se=K==null?void 0:K.some(function(pe){var J;return(J=Y.children)===null||J===void 0?void 0:J.includes(pe.id)});return Z!=null&&Z.length&&!se?ae:Y}),U=ve(ve([],($=K==null?void 0:K.map(function(Y){return Y.id===Q?ge(ge({},Y),{children:X.map(function(Z){return Z.id})}):Y}))!==null&&$!==void 0?$:[],!0),X,!0),ee=U.reduce(function(Y,Z){return Y[Z.id]=Z,Y},{});return Object.values(ee)}),[2]}})})});N.useEffect(function(){O(_)},[_]);var m=N.useState(),P=m[0],D=m[1],A=te(function(Q){var G,z=Le(x);if(Q){if(D(Q),Q.parentId!=null){var K=z==null?void 0:z.find(function(X){return X.id===Q.parentId});K&&(K.children=K.children||[],K.children=Q.insertAsFirstChild?ve([he],K.children,!0):ve(ve([],K.children,!0),[he],!1))}O(ve(ve([],z??[],!0),[ge({id:he,children:[]},Q.record)],!1))}else{if(!P)return;var $=Le(x);if(P.parentId!=null){var K=$==null?void 0:$.find(function(U){return U.id===P.parentId});K&&(K.children=(G=K.children)===null||G===void 0?void 0:G.filter(function(U){return U!=he}))}D(void 0),O($==null?void 0:$.filter(function(X){return X.id!==he}))}}),M=qt(void 0,t.expandedKeys),k=M[0],R=M[1],T=te(function(Q){R(function(G){var z,K,$=typeof Q=="function"?Q(G??[]):Q,X=(z=G==null?void 0:G.filter(function(ee){return!$.includes(ee)}))!==null&&z!==void 0?z:[],U=(K=X==null?void 0:X.flatMap(function(ee){return Zt(ee,x??[])},[]))!==null&&K!==void 0?K:[];return $.filter(function(ee){return!U.includes(ee)})})}),B=mr(e,{meta:u})[0],q=wr(e,{meta:u})[0],I=yr(e),L=$e(),W=te(function(Q){var G=Q.type,z=Ze(Q,["type"]),K=d(function(){return Ve(void 0,void 0,void 0,function(){return Ye(this,function(X){switch(X.label){case 0:return[4,I()];case 1:return X.sent(),L("ra-tree.item_moved",{undoable:o==="undoable"}),[2]}})})},"successSideEffect"),$=d(function(X){return Ve(void 0,void 0,void 0,function(){return Ye(this,function(U){return L(X.message,{type:"error"}),[2]})})},"errorSideEffect");G==="child"?B(e,z,{onSuccess:K,onError:$,mutationMode:o}):q(e,z,{onSuccess:K,onError:$,mutationMode:o})}),V=n("ra.page.list",{name:i(e,2)});return{data:x,defaultTitle:V,error:w,expandedKeys:k,handleAddNode:A,handleDrop:W,handleExpand:T,isLoading:h,isFetching:y,isPending:v,loadChildNodes:C,newNode:P,lazy:a,setFinalData:O}},"useTreeController"),Ft=N.createContext(void 0),Ne=function(){return Ne=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ne.apply(this,arguments)},bt=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},Nr=d(function(t){var n=t.id,e=t.label,i=t.multiple,r=t.sx,a=t.className,c=t.helperText,s=t.fullWidth,l=t.margin,o=l===void 0?"dense":l,u=t.variant,f=u===void 0?"filled":u,b=t.size,g=b===void 0?"small":b,j=bt(t,["id","label","multiple","sx","className","helperText","fullWidth","margin","variant","size"]),S=$r(t),_=S.data,w=S.resource,h=S.source,v=S.fetchError,y=S.isLoading,p=S.isRequired,x=S.field,O=S.fieldState,C=S.formState,m=be(),P=O.isTouched,D=O.invalid,A=O.error,M=C.isSubmitted,k=N.useMemo(function(){return(x==null?void 0:x.value)||(i?[]:"")},[x,i]),R=N.useMemo(function(){return _.filter(function(B){return i?k.includes(B.id):k===B.id})},[k,_,i]),T={standard:It,outlined:Kt,filled:Bt}[f];return v?E.jsxs(Fe,{className:a,sx:r,"data-testid":"error",variant:f,size:g,margin:o,error:!0,children:[E.jsx(He,{error:!0,margin:o==="dense"?o:void 0,size:g==="medium"?"normal":g,variant:f,children:E.jsx(Be,{resource:w,label:e,isRequired:p,source:h})}),E.jsx(T,{inputComponent:at}),E.jsx(wt,{error:!0,children:E.jsx(_t,{error:m("ra-tree.treeSelectInput.fetchError",{_:"Error fetching tree data"}),helperText:c})})]}):y||!_?E.jsxs(Fe,{className:a,sx:r,"data-testid":"loading",variant:f,size:g,margin:o,children:[E.jsx(He,{margin:o==="dense"?o:void 0,size:g==="medium"?"normal":g,variant:f,children:E.jsx(Be,{resource:w,label:e,isRequired:p,source:h})}),E.jsx(T,{inputComponent:at,endAdornment:E.jsx(Cn,{color:"inherit",size:"30px"})})]}):E.jsxs(Fe,{className:a,sx:r,variant:f,size:g,margin:o,children:[E.jsx(He,{htmlFor:n??h,error:D,margin:o==="dense"?o:void 0,shrink:R.length>0,size:g==="medium"?"normal":g,variant:f,children:E.jsx(Be,{resource:w,label:e,isRequired:p,source:h})}),E.jsx(Dr,Ne({source:h,multiple:i,className:Pr.tree,field:x,fullWidth:s},j,{data:_,variant:f,size:g,margin:o,id:n??h})),(P||M)&&A||c?E.jsx(wt,{error:(P||M)&&!!A,children:E.jsx(_t,{error:A==null?void 0:A.message,helperText:c})}):null]})},"TreeInput"),en="RaTreeInput",Pr={tree:"".concat(en,"-tree")},Fe=we(Pn,{name:en,overridesResolver:d(function(t,n){return n.root},"overridesResolver")})(function(t){var n=t.theme;return{"& .MuiInputBase-input":{height:"auto",minHeight:"1.4375em"},"& .MuiChip-root":{marginTop:n.spacing(.5),marginRight:n.spacing(.5)}}}),Dr=d(function(t){var n,e=t.className,i=t.data,r=t.multiple,a=t.field,c=t.checkStrictly,s=c===void 0?!0:c,l=t.expandAction,o=l===void 0?!1:l,u=t.titleField,f=t.margin,b=f===void 0?"dense":f,g=t.variant,j=g===void 0?"filled":g,S=t.size,_=S===void 0?"small":S,w=t.label,h=t.isRequired,v=t.source,y=t.id,p=t.sx,x=bt(t,["className","data","multiple","field","checkStrictly","expandAction","titleField","margin","variant","size","label","isRequired","source","id","sx"]),O=N.useMemo(function(){return(a==null?void 0:a.value)||(r?[]:"")},[a,r]),C=N.useMemo(function(){return i.filter(function($){return r?O.includes($.id):O===$.id})},[O,i,r]),m=N.useState(0),P=m[0],D=m[1],A=N.useRef(!0);N.useEffect(function(){A.current&&D(function($){return $+1}),A.current=!0},[O]);var M=te(function($,X){A.current=!1,a==null||a.onChange(X.map(function(U){return U.id}))}),k=te(function($,X){var U;A.current=!1,a==null||a.onChange((U=X==null?void 0:X.id)!==null&&U!==void 0?U:null),W()}),R=N.useState(!1),T=R[0],B=R[1],q=te(function($){($.key==="Enter"||$.key===" ")&&($.preventDefault(),B(!0))}),I=N.useRef(null),L=d(function(){B(!0)},"handleClick"),W=d(function(){B(!1)},"handleClose"),V=N.useRef(null),Q=d(function(){var $;($=V.current)===null||$===void 0||$.updatePosition()},"handleExpand"),G=re(t),z=kt(G),K={standard:It,outlined:Kt,filled:Bt}[j];return E.jsxs(E.Fragment,{children:[E.jsx(K,{id:y,ref:I,onClick:L,endAdornment:E.jsx(En,{}),size:_,margin:b,inputComponent:at,className:e,onKeyDown:q,label:E.jsx(Be,{resource:G,label:w,isRequired:h,source:v}),notched:j==="outlined"?C.length>0:void 0,inputProps:{children:C.length===0?null:E.jsx(Sn,{direction:"row",flexWrap:"wrap",children:r?C.map(function($){return E.jsx(jn,{size:_,onDelete:d(function(X){M(X,C.filter(function(U){return U.id!==$.id}),$,!1)},"onDelete"),label:E.jsx(Dt,{record:$,titleField:u||z})},$.id)}):E.jsx(Dt,{record:C[0],titleField:u||z})})}}),E.jsx(Nn,{action:V,open:T,anchorEl:I.current,onClose:W,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},slotProps:{paper:{sx:{minWidth:I?(n=I.current)===null||n===void 0?void 0:n.clientWidth:"auto"}}},children:N.createElement(Lt,Ne({},x,{key:P,checkStrictly:s,expandAction:o,checkable:r,selectable:!r,checkedKeys:r?O:[],selectedKeys:r?[]:[O],defaultCheckedKeys:r?O:void 0,defaultSelectedKeys:r?void 0:[O],defaultExpandedKeys:r?O:[O],onCheck:M,onSelect:k,onExpand:Q,data:i,onBlur:a==null?void 0:a.onBlur,sx:Ne({padding:1},p)}))})]})},"TreeInputTree"),at=N.forwardRef(d(function(n,e){var i=n.className,r=n.children,a=bt(n,["className","children"]);return E.jsxs(Dn,{className:i,children:[E.jsx("input",Ne({ref:e},a,{style:An})),r]})},"TreeInputInput")),Dt=d(function(t){var n=t.titleField,e=t.record;return e?typeof n=="function"?n(e):Rn(e,n):null},"ChoiceLabel"),Ar=d(function(t){var n=t.reference,e=t.source,i=t.meta,r=$t(n,{meta:i}),a=r.data,c=r.error,s=r.isLoading,l=r.isFetching;return{source:e,resource:n,data:a,error:c??void 0,isLoading:s,isFetching:l}},"useReferenceNodeInputController"),Rr=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},ga=d(function(t){var n=t.children,e=n===void 0?E.jsx(Nr,{}):n,i=Ar(t),r=i.resource,a=Rr(i,["resource"]);return E.jsx(kn,{value:r,children:E.jsx(kr,{value:a,children:e})})},"ReferenceNodeInput"),kr=d(function(t){var n=t.children,e=t.value;return E.jsx(Ft.Provider,{value:e,children:n})},"TreeChoicesContextProvider"),Mr=d(function(){return N.useContext(Ft)||{}},"useTreeChoicesContext"),ze=function(){return ze=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ze.apply(this,arguments)},Tr=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},$r=d(function(t){var n=t.source,e=t.data;t.hideRootNodes;var i=Tr(t,["source","data","hideRootNodes"]),r=re(t);if(r==null)throw new Error("The useTreeInputController hook must be used inside a ResourceContext or must be passed a resource prop.");var a=Mr(),c=a.source,s=a.data,l=a.isLoading,o=a.isFetching,u=a.error,f=e??s,b=n??c;if(b==null)throw new Error("The useTreeInputController hook must be used inside a ReferenceNodeInput or have a source prop");var g=Mn(ze(ze({},i),{resource:r,source:b,type:"text"})),j=g.isRequired,S=g.field,_=g.fieldState,w=g.formState;return{resource:r,source:b,data:f??[],fetchError:u,isLoading:l,isFetching:o,isRequired:j,field:S,fieldState:_,formState:w}},"useTreeInputController"),qr=d(function(t){var n=t.children,e=t.value;return E.jsx(Tn.Provider,{value:e,children:n})},"TreeContextProvider"),it=function(){return it=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},it.apply(this,arguments)},ma=d(function(t){var n=Or(t);return E.jsx($n,{value:n,children:E.jsx(qn,it({},t,n))})},"CreateNode"),ot=function(){return ot=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ot.apply(this,arguments)},At=function(t,n,e){if(e||arguments.length===2)for(var i=0,r=n.length,a;i<r;i++)(a||!(i in n))&&(a||(a=Array.prototype.slice.call(n,0,i)),a[i]=n[i]);return t.concat(a||Array.prototype.slice.call(n))},ba=d(function(t){var n=t.id,e=Bn().id;if(!e&&!n)throw new Error("ShowNode requires an id prop or a route with an /:id? parameter.");var i=n??e,r=qt(),a=r[1];N.useEffect(function(){a(function(s){var l=i.toString();return Array.isArray(s)?s.includes(l)?s:At(At([],s,!0),[l],!1):[l]})},[t.resource,i,a]);var c=Zn(t);return E.jsx(er,{value:c,children:E.jsx(or,ot({},t))})},"ShowNode"),ut=function(){return ut=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ut.apply(this,arguments)},Br=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},Kr=d(function(t){var n=t.className,e=t.confirmTitle,i=e===void 0?"ra.message.delete_title":e,r=t.confirmContent,a=r===void 0?"ra.message.delete_content":r,c=t.label,s=c===void 0?"ra.action.delete":c,l=t.mutationMode,o=t.onClick;t.record,t.resource;var u=t.ref,f=t.redirect,b=f===void 0?"list":f,g=Br(t,["className","confirmTitle","confirmContent","label","mutationMode","onClick","record","resource","ref","redirect"]),j=re(t);if(!j)throw new Error("The DeleteMenuItemWithConfirmation component must be used inside a ResourceContext or must be passed a resource prop.");var S=_e(t);if(!S)throw new Error("The DeleteMenuItemWithConfirmation component must be used inside a RecordContext or must be passed a record prop.");var _=Vt({mutationMode:l,record:S,resource:j,redirect:b}),w=_.handleDelete,h=_.handleDialogClose,v=_.handleDialogOpen,y=_.isPending,p=_.open,x=be(),O=d(function(C){C.stopPropagation(),o&&o(C),C.isDefaultPrevented()||v(C)},"handleClick");return E.jsxs(E.Fragment,{children:[E.jsx(Wt,ut({className:n,onClick:O,ref:u},g,{children:x(s,{_:s})})),E.jsx(Qt,{isOpen:p,loading:y,title:i,content:a,translateOptions:{name:We.humanize(x("resources.".concat(j,".name"),{smart_count:1,_:We.singularize(j)}),!0),id:S.id},onConfirm:w,onClose:h})]})},"DeleteMenuItemWithConfirmation"),ct=function(){return ct=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ct.apply(this,arguments)},Ir=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},Lr=d(function(t){var n=t.className,e=t.label,i=e===void 0?"ra.action.delete":e;t.mutationMode;var r=t.onClick;t.record;var a=t.ref;t.resource;var c=t.redirect,s=c===void 0?"list":c,l=Ir(t,["className","label","mutationMode","onClick","record","ref","resource","redirect"]),o=re(t);if(!o)throw new Error("The DeleteMenuItemWithUndo component must be used inside a ResourceContext or must be passed a resource prop.");var u=_e(t);if(!u)throw new Error("The DeleteMenuItemWithUndo component must be used inside a RecordContext or must be passed a record prop.");var f=Yt({record:u,resource:o,redirect:s}),b=f.handleDelete,g=f.isPending,j=be(),S=d(function(_){_.stopPropagation(),r&&r(_),_.isDefaultPrevented()||b(_)},"handleClick");return E.jsx(Wt,ct({className:n,disabled:g,onClick:S,ref:a},l,{children:j(i,{_:i})}))},"DeleteMenuItemWithUndo"),Ue=function(){return Ue=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ue.apply(this,arguments)},Wr=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},tn=d(function(t){var n=t.mutationMode,e=n===void 0?"undoable":n,i=Wr(t,["mutationMode"]);return e==="undoable"?E.jsx(Lr,Ue({},i,{mutationMode:e})):E.jsx(Kr,Ue({},i,{mutationMode:e}))},"DeleteMenuItem");tn.displayName="DeleteMenuItem";var Qr=N.createContext(null),zr=Qr.Provider,Ur=d(function(t){var n=t.children,e=n===void 0?E.jsx(tn,{}):n,i=t.className,r=N.useState(null),a=r[0],c=r[1],s=d(function(u){u.stopPropagation(),c(u.currentTarget)},"handleClick"),l=N.useCallback(function(u){u.stopPropagation(),c(null)},[]),o=N.useMemo(function(){return{close:l}},[l]);return E.jsxs(Xr,{className:i,children:[E.jsx("button",{className:Gr.menuButton,onClick:s,children:E.jsx(Kn,{})}),E.jsx(In,{anchorEl:a,open:!!a,onClose:l,children:E.jsx(zr,{value:o,children:e})})]})},"NodeActions"),nn="RaNodeActions",Gr={menuButton:"".concat(nn,"-menuButton")},Xr=we("div",{name:nn,overridesResolver:d(function(t,n){return n.root},"overridesResolver")})(function(){return{}}),dt=function(){return dt=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},dt.apply(this,arguments)},Hr=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},Jr=d(function(t){var n=t.label,e=n===void 0?"ra.action.delete":n,i=t.className,r=t.icon,a=r===void 0?Yr:r,c=t.onClick;t.resource,t.record;var s=t.redirect,l=s===void 0?"list":s,o=Hr(t,["label","className","icon","onClick","resource","record","redirect"]),u=re(t);if(!u)throw new Error("The DeleteBranchWithUndoButton component must be used inside a ResourceContext or must be passed a resource prop.");var f=_e(t);if(!f)throw new Error("The DeleteBranchWithUndoButton component must be used inside a RecordContext or must be passed a record prop.");var b=Yt({resource:u,record:f,redirect:l}),g=b.handleDelete,j=b.isPending,S=d(function(_){c&&c(_),_.isDefaultPrevented()||g(_)},"handleClick");return E.jsx(Vr,dt({onClick:S,disabled:j,label:e,className:Te("ra-delete-button",i)},o,{children:a}),"button")},"DeleteBranchWithUndoButton"),Vr=we(zt,{name:"RaDeleteBranchWithUndoButton",overridesResolver:d(function(t,n){return n.root},"overridesResolver")})(function(t){var n=t.theme;return{color:n.palette.error.main,"&:hover":{backgroundColor:Ut(n.palette.error.main,.12),"@media (hover: none)":{backgroundColor:"transparent"}}}}),Yr=E.jsx(Gt,{}),st=function(){return st=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},st.apply(this,arguments)},Zr=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},Fr=d(function(t){var n=t.className,e=t.confirmTitle,i=e===void 0?"ra.message.delete_title":e,r=t.confirmContent,a=r===void 0?"ra.message.delete_content":r,c=t.icon,s=c===void 0?ea:c,l=t.label,o=l===void 0?"ra.action.delete":l,u=t.mutationMode,f=t.onClick;t.record,t.resource;var b=t.redirect,g=b===void 0?"list":b,j=Zr(t,["className","confirmTitle","confirmContent","icon","label","mutationMode","onClick","record","resource","redirect"]),S=be(),_=re(t);if(!_)throw new Error("The DeleteBranchWithConfirmButton component must be used inside a ResourceContext or must be passed a resource prop.");var w=_e(t);if(!w)throw new Error("The DeleteBranchWithConfirmButton component must be used inside a RecordContext or must be passed a record prop.");var h=Vt({mutationMode:u,resource:_,record:w,redirect:g}),v=h.handleDelete,y=h.handleDialogClose,p=h.handleDialogOpen,x=h.isPending,O=h.open,C=d(function(m){f&&f(m),m.isDefaultPrevented()||p(m)},"handleClick");return E.jsxs(ta,{className:n,children:[E.jsx(zt,st({onClick:C,label:o,className:Te("ra-delete-button",an.deleteButton)},j,{children:s}),"button"),E.jsx(Qt,{isOpen:O,loading:x,title:i,content:a,translateOptions:{name:S("resources.".concat(_,".forcedCaseName"),{smart_count:1,_:We.humanize(S("resources.".concat(_,".name"),{smart_count:1,_:We.singularize(_)}),!0)}),id:w.id},onConfirm:v,onClose:y})]})},"DeleteBranchWithConfirmButton"),ea=E.jsx(Gt,{}),rn="RaDeleteBranchWithConfirmButton",an={deleteButton:"".concat(rn,"-deleteButton")},ta=we("div",{name:rn})(function(t){var n,e=t.theme;return n={},n["& .".concat(an.deleteButton)]={color:e.palette.error.main,"&:hover":{backgroundColor:Ut(e.palette.error.main,.12),"@media (hover: none)":{backgroundColor:"transparent"}}},n}),Ge=function(){return Ge=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ge.apply(this,arguments)},na=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},ra=d(function(t){var n=t.mutationMode,e=n===void 0?"undoable":n;t.record;var i=na(t,["mutationMode","record"]),r=_e(t),a=Ln();if(!r||r.id==null)return null;var c=e||(a!=null&&a.mutationMode?a.mutationMode:"undoable");return c==="undoable"?E.jsx(Jr,Ge({record:r},i)):E.jsx(Fr,Ge({mutationMode:c,record:r},i))},"DeleteBranchButton");function et(t){var n=Wn();return Qn((n??"")+t)}d(et,"useMatchWithBasename");var lt=function(){return lt=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},lt.apply(this,arguments)},aa=function(t,n,e,i){function r(a){return a instanceof e?a:new e(function(c){c(a)})}return d(r,"adopt"),new(e||(e=Promise))(function(a,c){function s(u){try{o(i.next(u))}catch(f){c(f)}}d(s,"fulfilled");function l(u){try{o(i.throw(u))}catch(f){c(f)}}d(l,"rejected");function o(u){u.done?a(u.value):r(u.value).then(s,l)}d(o,"step"),o((i=i.apply(t,n||[])).next())})},ia=function(t,n){var e={label:0,sent:d(function(){if(a[0]&1)throw a[1];return a[1]},"sent"),trys:[],ops:[]},i,r,a,c;return c={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function s(o){return function(u){return l([o,u])}}function l(o){if(i)throw new TypeError("Generator is already executing.");for(;c&&(c=0,o[0]&&(e=0)),e;)try{if(i=1,r&&(a=o[0]&2?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[o[0]&2,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,r=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){e.label=o[1];break}if(o[0]===6&&e.label<a[1]){e.label=a[1],a=o;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(o);break}a[2]&&e.ops.pop(),e.trys.pop();continue}o=n.call(t,e)}catch(u){o=[6,u],r=0}finally{i=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},on=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},Oe,wa=d(function(t){var n=t.allowMultipleRoots,e=n===void 0?!1:n,i=t.className,r=t.create,a=t.defaultExpandedKeys,c=t.edit,s=t.filter,l=t.hideRootNodes,o=t.lazy,u=o===void 0?!1:o;t.linkTo;var f=t.nodeActions,b=f===void 0?E.jsx(Ur,{}):f,g=t.show,j=t.showLine,S=t.sx,_=t.title,w=t.titleField,h=t.addRootButton,v=h===void 0?E.jsx(zn,{label:"ra-tree.action.add_root",sx:{marginTop:".75rem"}}):h,y=t.meta,p=t.mutationMode,x=t.expandedKeys,O=t.onExpand,C=t.onClick,m=t.onDrop,P=on(t,["allowMultipleRoots","className","create","defaultExpandedKeys","edit","filter","hideRootNodes","lazy","linkTo","nodeActions","show","showLine","sx","title","titleField","addRootButton","meta","mutationMode","expandedKeys","onExpand","onClick","onDrop"]),D=re(t);if(D==null)throw new Error("The TreeWithDetails hook must be used inside a ResourceContext or must be passed a resource prop.");var A=Un(),M=Gn(),k=et("/".concat(D,"/create/*")),R=et("/".concat(D,"/:id/*")),T=et("/".concat(D,"/:id/show/*")),B=ca(t),q=N.useState(function(){if(k)return[he];if(R)return[R.params.id];if(T)return[T.params.id]}),I=q[0],L=q[1];N.useEffect(function(){if(k){L([he]);return}if(R){L([R.params.id]);return}if(T){L([T.params.id]);return}},[k,R,T]);var W=Er({lazy:u,resource:D,filter:s,meta:y,mutationMode:p,expandedKeys:x??a}),V=W.data,Q=W.defaultTitle,G=W.handleExpand,z=W.isPending,K=W.loadChildNodes,$=W.handleDrop,X=W.expandedKeys,U=te(function(J,F){if(C&&C(J,F),!J.defaultPrevented&&B)return A(M({resource:D,id:F.id,type:B}))}),ee=te(function(J,F,xe,Re){O&&O(J,F,xe,Re),J.defaultPrevented||G(F.map(function(ke){var un=ke.id;return un}))}),Y=te(function(J,F){m&&m(J,F),$(F)}),Z=N.useCallback(function(J){return aa(void 0,void 0,void 0,function(){return ia(this,function(F){return u?[2,K(J.record.id)]:[2,Promise.resolve()]})})},[u,K]),ae=N.useMemo(function(){var J;return(J=V==null?void 0:V.reduce(function(F,xe){return V.some(function(Re){var ke;return(ke=Re.children)===null||ke===void 0?void 0:ke.includes(xe.id)})||F.push(xe.id),F},[]))!==null&&J!==void 0?J:[]},[V]),se=te(function(J){var F=J.destination,xe=J.position;if(V==null)return!1;if(e)return!0;var Re=ae.includes(F.id);return!(Re&&xe===-1)});if(z||V==null)return null;var pe=!V||V.length===0||e;return E.jsx(qr,{value:W,children:E.jsxs(ua,{className:i,sx:S,children:[E.jsx("div",{className:me.cardTree,children:E.jsx(Mt,{children:E.jsxs(Xn,{className:me.cardContentTree,children:[E.jsx(Lt,lt({allowDrop:se,data:V,hideRootNodes:l,titleField:w,onDrop:Y,onExpand:ee,onClick:U,selectedKeys:I,showLine:j,nodeActions:b,loadData:u?Z:void 0,loadedKeys:void 0,expandAction:!1,expandedKeys:X},oa(P))),pe?v:null]})})}),E.jsx("div",{className:me.actionCard,children:E.jsxs(Hn,{children:[r?E.jsx(qe,{path:"create/*",element:typeof r=="function"?E.jsx(r,{}):r}):null,g?E.jsx(qe,{path:":id/show/*",element:typeof g=="function"?E.jsx(g,{}):g}):null,c?E.jsx(qe,{path:":id/*",element:typeof c=="function"?E.jsx(c,{}):c}):null,_!==!1?E.jsx(qe,{path:"*",element:E.jsx(Tt,{title:_,defaultTitle:Q})}):null]})})]})})},"TreeWithDetails"),oa=d(function(t){t.basePath,t.history,t.location,t.match,t.options,t.hasList,t.hasEdit,t.hasShow,t.hasCreate,t.syncWithLocation;var n=on(t,["basePath","history","location","match","options","hasList","hasEdit","hasShow","hasCreate","syncWithLocation"]);return n},"sanitizeRestProps"),Me="RaTreeWithDetails",me={container:"".concat(Me,"-container"),cardTree:"".concat(Me,"-cardTree"),cardContentTree:"".concat(Me,"-cardContentTree"),actionCard:"".concat(Me,"-actionCard")},ua=we("div",{name:Me,overridesResolver:d(function(t,n){return n.root},"overridesResolver")})((Oe={display:"flex"},Oe["& .".concat(me.actionCard)]={width:"100%"},Oe["& .".concat(me.cardTree)]={minWidth:"300px",marginTop:"1em",marginRight:"1em"},Oe["& .".concat(me.cardContentTree)]={},Oe["& .".concat(me.container)]={display:"flex"},Oe)),ca=d(function(t){var n=t.linkTo,e=t.show,i=t.edit;return n||(e?"show":i?"edit":!1)},"getLinkTo"),ft=function(){return ft=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++){n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ft.apply(this,arguments)},da=function(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]]);return e},_a=d(function(t){var n,e=t.children,i=t.className,r=t.resource,a=da(t,["children","className","resource"]),c=Jn(function(s){return s.breakpoints.down("sm")});return E.jsx(sa,ft({className:Te((n={},n[Ee.mobileToolbar]=c,n[Ee.desktopToolbar]=!c,n),i),role:"toolbar"},a,{children:N.Children.count(e)===0?E.jsxs("div",{className:Ee.defaultToolbar,children:[E.jsx(Vn,{}),E.jsx(ra,{resource:r})]}):e}))},"EditNodeToolbar"),Ie="RaEditNodeToolbar",Ee={desktopToolbar:"".concat(Ie,"-desktopToolbar"),mobileToolbar:"".concat(Ie,"-mobileToolbar"),defaultToolbar:"".concat(Ie,"-defaultToolbar")},sa=we(Yn,{name:Ie,overridesResolver:d(function(t,n){return n.root},"overridesResolver")})(function(t){var n,e=t.theme;return n={backgroundColor:e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[900]},n["&.".concat(Ee.desktopToolbar)]={},n["&.".concat(Ee.mobileToolbar)]={position:"fixed",bottom:0,left:0,right:0,padding:"16px",width:"100%",boxSizing:"border-box",flexShrink:0,zIndex:2},n["& .".concat(Ee.defaultToolbar)]={flex:1,display:"flex",justifyContent:"space-between"},n});export{Oa as AddChildButton,ma as CreateNode,ra as DeleteBranchButton,Fr as DeleteBranchWithConfirmButton,Jr as DeleteBranchWithUndoButton,tn as DeleteMenuItem,Kr as DeleteMenuItemWithConfirmation,Lr as DeleteMenuItemWithUndo,an as DeleteWithConfirmButtonClasses,Ca as EditNode,_a as EditNodeToolbar,Ee as EditNodeToolbarClasses,Ur as NodeActions,Sa as NodeEditActions,ga as ReferenceNodeInput,ba as ShowNode,Lt as Tree,Ft as TreeChoicesContext,kr as TreeChoicesContextProvider,Tn as TreeContext,qr as TreeContextProvider,Nr as TreeInput,Pr as TreeInputClasses,Dr as TreeInputTree,wa as TreeWithDetails,me as TreeWithDetailsClasses,he as UNSAVED_NEW_NODE,ja as addTreeMethodsBasedOnChildren,va as addTreeMethodsBasedOnParentAndPosition,mn as deleteBranchByDeletingAllChildren,gn as deleteBranchByDeletingNode,ya as fixFakeRestDataProvider,Ea as getRCTree,Na as getRCTreeDatum,Pa as getRecordTree,Da as getRootAndChildNodes,Aa as raTreeLanguageEnglish,Ra as raTreeLanguageFrench,ha as removeChildren,ka as renderSwitcherIcon,bn as updateQueryCacheFromGetTree,pn as useAddChildNode,fr as useAddRootNode,Or as useCreateNodeController,Xt as useDeleteBranch,Vt as useDeleteBranchWithConfirmController,Yt as useDeleteBranchWithUndoController,Ma as useEditNodeController,qt as useExpandedKeys,hr as useGetChildNodesCallback,On as useGetRootNodes,$t as useGetTree,yr as useGetTreeCallback,mr as useMoveAsNthChildOf,wr as useMoveAsNthSiblingOf,Ar as useReferenceNodeInputController,Mr as useTreeChoicesContext,gt as useTreeContext,Er as useTreeController,$r as useTreeInputController};
//# sourceMappingURL=index-B9UjA7bd.js.map
