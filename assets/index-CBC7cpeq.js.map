{"version":3,"file":"index-CBC7cpeq.js","sources":["../../node_modules/ra-core/dist/controller/show/useShowController.js","../../node_modules/ra-core/dist/controller/show/ShowContext.js","../../node_modules/ra-core/dist/controller/show/ShowContextProvider.js","../../node_modules/ra-core/dist/controller/show/useShowContext.js","../../node_modules/ra-ui-materialui/dist/detail/ShowActions.js","../../node_modules/ra-ui-materialui/dist/detail/ShowView.js","../../node_modules/@react-admin/ra-tree/esm/src/dataProvider/builder/addTreeMethodsBasedOnParentAndPosition.js","../../node_modules/@react-admin/ra-tree/esm/src/dataProvider/useAddRootNode.js","../../node_modules/@react-admin/ra-tree/esm/src/dataProvider/useDeleteBranch.js","../../node_modules/@react-admin/ra-tree/esm/src/dataProvider/useGetChildNodesCallback.js","../../node_modules/@react-admin/ra-tree/esm/src/util/removeChildren.js","../../node_modules/@react-admin/ra-tree/esm/src/dataProvider/useGetTreeCallback.js","../../node_modules/@react-admin/ra-tree/esm/src/dataProvider/useMoveAsNthChildOf.js","../../node_modules/@react-admin/ra-tree/esm/src/dataProvider/useMoveAsNthSiblingOf.js","../../node_modules/@react-admin/ra-tree/esm/src/dataProvider/fixFakeRestDataProvider.js","../../node_modules/@react-admin/ra-tree/esm/src/util/removeNode.js","../../node_modules/@react-admin/ra-tree/esm/src/controllers/useDeleteBranchWithConfirmController.js","../../node_modules/@react-admin/ra-tree/esm/src/controllers/useDeleteBranchWithUndoController.js","../../node_modules/@react-admin/ra-tree/esm/src/controllers/useCreateNodeController.js","../../node_modules/@react-admin/ra-tree/esm/src/controllers/getNodesIdsRecursively.js","../../node_modules/@react-admin/ra-tree/esm/src/controllers/useTreeController.js","../../node_modules/@react-admin/ra-tree/esm/src/reference/TreeChoicesContext.js","../../node_modules/@react-admin/ra-tree/esm/src/TreeInput.js","../../node_modules/@react-admin/ra-tree/esm/src/reference/useReferenceNodeInputController.js","../../node_modules/@react-admin/ra-tree/esm/src/reference/ReferenceNodeInput.js","../../node_modules/@react-admin/ra-tree/esm/src/reference/TreeChoicesContextProvider.js","../../node_modules/@react-admin/ra-tree/esm/src/reference/useTreeChoicesContext.js","../../node_modules/@react-admin/ra-tree/esm/src/controllers/useTreeInputController.js","../../node_modules/@react-admin/ra-tree/esm/src/controllers/TreeContextProvider.js","../../node_modules/@react-admin/ra-tree/esm/src/CreateNode.js","../../node_modules/@react-admin/ra-tree/esm/src/ShowNode.js","../../node_modules/@react-admin/ra-tree/esm/src/DeleteMenuItemWithConfirmation.js","../../node_modules/@react-admin/ra-tree/esm/src/DeleteMenuItemWithUndo.js","../../node_modules/@react-admin/ra-tree/esm/src/DeleteMenuItem.js","../../node_modules/@react-admin/ra-tree/esm/src/NodeActionsContext.js","../../node_modules/@react-admin/ra-tree/esm/src/NodeActions.js","../../node_modules/@react-admin/ra-tree/esm/src/DeleteBranchWithUndoButton.js","../../node_modules/@react-admin/ra-tree/esm/src/DeleteBranchWithConfirmButton.js","../../node_modules/@react-admin/ra-tree/esm/src/DeleteBranchButton.js","../../node_modules/@react-admin/ra-tree/esm/src/useMatchWithBasename.js","../../node_modules/@react-admin/ra-tree/esm/src/TreeWithDetails.js","../../node_modules/@react-admin/ra-tree/esm/src/EditNodeToolbar.js"],"sourcesContent":["import { useAuthenticated, useRequireAccess } from \"../../auth/index.js\";\nimport { useGetOne, } from \"../../dataProvider/index.js\";\nimport { useTranslate } from \"../../i18n/index.js\";\nimport { useRedirect, useParams } from \"../../routing/index.js\";\nimport { useNotify } from \"../../notification/index.js\";\nimport { useResourceContext, useGetResourceLabel, useGetRecordRepresentation, } from \"../../core/index.js\";\n/**\n * Prepare data for the Show view.\n *\n * useShowController does a few things:\n * - it grabs the id from the URL and the resource name from the ResourceContext,\n * - it fetches the record via useGetOne,\n * - it prepares the page title.\n *\n * @param {Object} props The props passed to the Show component.\n *\n * @return {Object} controllerProps Fetched data and callbacks for the Show view\n *\n * @example\n *\n * import { useShowController } from 'react-admin';\n * import ShowView from './ShowView';\n *\n * const MyShow = () => {\n *     const controllerProps = useShowController();\n *     return <ShowView {...controllerProps} />;\n * };\n *\n * @example // useShowController can also take its parameters from props\n *\n * import { useShowController } from 'react-admin';\n * import ShowView from './ShowView';\n *\n * const MyShow = () => {\n *     const controllerProps = useShowController({ resource: 'posts', id: 1234 });\n *     return <ShowView {...controllerProps} />;\n * };\n */\nexport const useShowController = (props = {}) => {\n    const { disableAuthentication = false, id: propsId, queryOptions = {}, redirectOnError = DefaultRedirectOnError, } = props;\n    const resource = useResourceContext(props);\n    if (!resource) {\n        throw new Error(`useShowController requires a non-empty resource prop or context`);\n    }\n    const { isPending: isPendingAuthenticated } = useAuthenticated({\n        enabled: !disableAuthentication,\n    });\n    const { isPending: isPendingCanAccess } = useRequireAccess({\n        action: 'show',\n        resource,\n        enabled: !disableAuthentication && !isPendingAuthenticated,\n    });\n    const getRecordRepresentation = useGetRecordRepresentation(resource);\n    const translate = useTranslate();\n    const notify = useNotify();\n    const redirect = useRedirect();\n    const { id: routeId } = useParams();\n    if (!routeId && !propsId) {\n        throw new Error('useShowController requires an id prop or a route with an /:id? parameter.');\n    }\n    const id = propsId != null ? propsId : routeId;\n    const { meta, ...otherQueryOptions } = queryOptions;\n    const { data: record, error, isLoading, isFetching, isPaused, isPending, isPlaceholderData, refetch, } = useGetOne(resource, { id, meta }, {\n        enabled: (!isPendingAuthenticated && !isPendingCanAccess) ||\n            disableAuthentication,\n        onError: () => {\n            notify('ra.notification.item_doesnt_exist', {\n                type: 'error',\n            });\n            redirect(redirectOnError, resource, id);\n        },\n        retry: false,\n        ...otherQueryOptions,\n    });\n    // eslint-disable-next-line eqeqeq\n    if (record && record.id && record.id != id) {\n        throw new Error(`useShowController: Fetched record's id attribute (${record.id}) must match the requested 'id' (${id})`);\n    }\n    const getResourceLabel = useGetResourceLabel();\n    const recordRepresentation = getRecordRepresentation(record);\n    const defaultTitle = translate(`resources.${resource}.page.show`, {\n        id,\n        record,\n        recordRepresentation: typeof recordRepresentation === 'string'\n            ? recordRepresentation\n            : '',\n        _: translate('ra.page.show', {\n            name: getResourceLabel(resource, 1),\n            id,\n            record,\n            recordRepresentation: typeof recordRepresentation === 'string'\n                ? recordRepresentation\n                : '',\n        }),\n    });\n    return {\n        defaultTitle,\n        error,\n        isLoading,\n        isFetching,\n        isPaused,\n        isPending,\n        isPlaceholderData,\n        record,\n        redirectOnError,\n        refetch,\n        resource,\n    };\n};\nconst DefaultRedirectOnError = 'list';\n//# sourceMappingURL=useShowController.js.map","import { createContext } from 'react';\n/**\n * Context to store the result of the useShowController() hook.\n *\n * Use the useShowContext() hook to read the context. That's what the Show components do in react-admin.\n *\n * @example\n *\n * import { useShowController, ShowContextProvider } from 'ra-core';\n *\n * const Show = props => {\n *     const controllerProps = useShowController(props);\n *     return (\n *         <ShowContextProvider value={controllerProps}>\n *             ...\n *         </ShowContextProvider>\n *     );\n * };\n */\nexport const ShowContext = createContext(null);\nShowContext.displayName = 'ShowContext';\n//# sourceMappingURL=ShowContext.js.map","import * as React from 'react';\nimport { RecordContextProvider } from \"../record/RecordContext.js\";\nimport { ShowContext } from \"./ShowContext.js\";\n/**\n * Create a Show Context.\n *\n * @example\n *\n * const MyShow = (props) => {\n *     const controllerProps = useShowController(props);\n *     return (\n *         <ShowContextProvider value={controllerProps}>\n *             <MyShowView>\n *         </ShowContextProvider>\n *     );\n * };\n *\n * const MyShowView = () => {\n *     const record = useRecordContext();\n * }\n *\n * @see ShowContext\n * @see RecordContext\n */\nexport const ShowContextProvider = ({ children, value, }) => (React.createElement(ShowContext.Provider, { value: value },\n    React.createElement(RecordContextProvider, { value: value && value.record }, children)));\n//# sourceMappingURL=ShowContextProvider.js.map","import { useContext } from 'react';\nimport { ShowContext } from \"./ShowContext.js\";\n/**\n * Hook to read the show controller props from the ShowContext.\n *\n * Used within a <ShowContextProvider> (e.g. as a descendent of <Show>).\n *\n * @returns {ShowControllerResult} create controller props\n *\n * @see useShowController for how it is filled\n */\nexport const useShowContext = () => {\n    const context = useContext(ShowContext);\n    // Props take precedence over the context\n    if (!context) {\n        throw new Error('useShowContext must be used inside a ShowContextProvider');\n    }\n    return context;\n};\n//# sourceMappingURL=useShowContext.js.map","import * as React from 'react';\nimport { useResourceDefinition } from 'ra-core';\nimport { EditButton } from \"../button/index.js\";\nimport TopToolbar from \"../layout/TopToolbar.js\";\n/**\n * Action Toolbar for the Show view\n *\n * Internal component. If you want to add or remove actions for a Show view,\n * write your own ShowActions Component. Then, in the <Show> component,\n * use it in the `actions` prop to pass a custom component.\n *\n * @example\n *     import Button from '@mui/material/Button';\n *     import { TopToolbar, ShowButton, Show } from 'react-admin';\n *\n *     const PostShowActions = () => (\n *         <TopToolbar>\n *             <ShowButton />\n *             // Add your custom actions here //\n *             <Button color=\"primary\" onClick={customAction}>Custom Action</Button>\n *         </TopToolbar>\n *     );\n *\n *     export const PostShow = (props) => (\n *         <Show actions={<PostShowActions />} {...props}>\n *             ...\n *         </Show>\n *     );\n */\nexport const ShowActions = (props) => {\n    const { hasEdit } = useResourceDefinition(props);\n    return (React.createElement(TopToolbar, { ...sanitizeRestProps(props) }, hasEdit && React.createElement(EditButton, null)));\n};\nconst sanitizeRestProps = ({ hasCreate, hasEdit, hasShow, hasList, resource, ...rest }) => rest;\n//# sourceMappingURL=ShowActions.js.map","import * as React from 'react';\nimport { Card, styled, } from '@mui/material';\nimport clsx from 'clsx';\nimport { useShowContext, useResourceDefinition, } from 'ra-core';\nimport { ShowActions } from \"./ShowActions.js\";\nimport { Title } from \"../layout/index.js\";\nimport { Offline } from \"../Offline.js\";\nconst defaultActions = React.createElement(ShowActions, null);\nconst defaultOffline = React.createElement(Offline, null);\nexport const ShowView = (props) => {\n    const { actions, aside, children, render, className, component: Content = Card, emptyWhileLoading = false, offline = defaultOffline, error, title, ...rest } = props;\n    const showContext = useShowContext();\n    const { resource, defaultTitle, isPaused, isPending, record, error: errorState, } = showContext;\n    const { hasEdit } = useResourceDefinition();\n    const finalActions = typeof actions === 'undefined' && hasEdit ? defaultActions : actions;\n    const showOffline = isPaused && isPending && offline !== undefined && offline !== false;\n    const showError = errorState && error !== false && error !== undefined;\n    if (!record &&\n        isPending &&\n        emptyWhileLoading &&\n        !showOffline &&\n        !showError) {\n        return null;\n    }\n    return (React.createElement(Root, { className: clsx('show-page', className), ...rest },\n        title !== false && (React.createElement(Title, { title: title, defaultTitle: defaultTitle, preferenceKey: `${resource}.show.title` })),\n        finalActions !== false && finalActions,\n        React.createElement(\"div\", { className: clsx(ShowClasses.main, {\n                [ShowClasses.noActions]: !finalActions,\n            }) },\n            React.createElement(Content, { className: ShowClasses.card }, showOffline\n                ? offline\n                : showError\n                    ? error\n                    : render\n                        ? render(showContext)\n                        : children),\n            aside)));\n};\nconst PREFIX = 'RaShow';\nexport const ShowClasses = {\n    main: `${PREFIX}-main`,\n    noActions: `${PREFIX}-noActions`,\n    card: `${PREFIX}-card`,\n};\nconst Root = styled('div', {\n    name: PREFIX,\n    overridesResolver: (props, styles) => styles.root,\n})({\n    [`& .${ShowClasses.main}`]: {\n        display: 'flex',\n    },\n    [`& .${ShowClasses.noActions}`]: {\n        marginTop: '1em',\n    },\n    [`& .${ShowClasses.card}`]: {\n        flex: '1 1 auto',\n    },\n});\n//# sourceMappingURL=ShowView.js.map","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { deleteBranchByDeletingAllChildren } from './deleteBranchByDeletingAllChildren';\nimport { deleteBranchByDeletingNode } from './deleteBranchByDeletingNode';\n/**\n * Provided the records contain a parent_id and a position field,\n * augment a dataProvider by adding the Tree methods (getTree, getRootNodes, etc).\n *\n * These methods will call regular dataProvider methods (getList, getOne, update).\n *\n * @warning Do not use in production.\n *\n * The added Tree methods call the API way too much, sometimes asking for the\n * entire tree. In practice, you should implement an optimized API route for\n * each of the Tree methods.\n *\n * @example // Compatible APIs should return records like\n * {\n *     id: 1234,\n *     name: 'hello',\n *     parent_id: 35,\n *     position: 4, // zero-based\n * }\n *\n * @param {DataProvider} dataProvider The dataProvider to augment\n * @param {string} parentIdField The name of the field containing the parent id. Defaults to 'parent_id'\n * @param {string} positionField The name of the field containing the position of a node inside its parent. Defaults to 'position'\n * @param {boolean} apiSupportBranchDeletion Indicates whether the API will handle children deletion when deleting a node as well as the siblings update. If false, the dataProvider will handle it by making multiple requests in the right order. Defaults to `false`.\n */\nexport var addTreeMethodsBasedOnParentAndPosition = function (dataProvider, parentIdField, positionField, apiSupportBranchDeletion) {\n    if (parentIdField === void 0) { parentIdField = 'parent_id'; }\n    if (positionField === void 0) { positionField = 'position'; }\n    if (apiSupportBranchDeletion === void 0) { apiSupportBranchDeletion = false; }\n    var deleteBranch = apiSupportBranchDeletion\n        ? deleteBranchByDeletingNode\n        : deleteBranchByDeletingAllChildren;\n    var treeDataProvider = __assign(__assign({}, dataProvider), { getTree: function (resource, params) { return __awaiter(void 0, void 0, void 0, function () {\n            var data, treeRecords;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, dataProvider.getList(resource, {\n                            filter: params === null || params === void 0 ? void 0 : params.filter,\n                            sort: { field: positionField, order: 'ASC' },\n                            pagination: { page: 1, perPage: 1000 },\n                            meta: params === null || params === void 0 ? void 0 : params.meta,\n                        })];\n                    case 1:\n                        data = (_a.sent()).data;\n                        treeRecords = data.map(function (record) { return (__assign(__assign({}, record), { children: data\n                                // eslint-disable-next-line eqeqeq\n                                .filter(function (r) { return r[parentIdField] == record.id; })\n                                .sort(function (a, b) { return a[positionField] - b[positionField]; })\n                                .map(function (child) { return child.id; }) })); });\n                        return [2 /*return*/, {\n                                data: treeRecords,\n                            }];\n                }\n            });\n        }); }, getRootNodes: function (resource, params) { return __awaiter(void 0, void 0, void 0, function () {\n            var data, treeRecords;\n            var _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, dataProvider.getList(resource, {\n                            filter: __assign(__assign({}, params === null || params === void 0 ? void 0 : params.filter), (_a = {}, _a[parentIdField] = null, _a)),\n                            sort: { field: positionField, order: 'ASC' },\n                            pagination: { page: 1, perPage: 1000 },\n                            meta: params === null || params === void 0 ? void 0 : params.meta,\n                        })];\n                    case 1:\n                        data = (_b.sent()).data;\n                        return [4 /*yield*/, Promise.all(data.map(function (record) {\n                                var _a;\n                                return dataProvider\n                                    .getList(resource, {\n                                    filter: (_a = {}, _a[parentIdField] = record.id, _a),\n                                    sort: {\n                                        field: positionField,\n                                        order: 'ASC',\n                                    },\n                                    pagination: { page: 1, perPage: 1000 },\n                                    meta: params === null || params === void 0 ? void 0 : params.meta,\n                                })\n                                    .then(function (_a) {\n                                    var data = _a.data;\n                                    return (__assign(__assign({}, record), { children: data.map(function (_a) {\n                                            var id = _a.id;\n                                            return id;\n                                        }) }));\n                                });\n                            }))];\n                    case 2:\n                        treeRecords = _b.sent();\n                        return [2 /*return*/, {\n                                data: treeRecords,\n                            }];\n                }\n            });\n        }); }, getParentNode: function (resource_1, _a) { return __awaiter(void 0, [resource_1, _a], void 0, function (resource, _b) {\n            var tree, child, parent;\n            var childId = _b.childId, meta = _b.meta;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0: return [4 /*yield*/, treeDataProvider.getTree(resource, { meta: meta })];\n                    case 1:\n                        tree = (_c.sent()).data;\n                        child = tree.find(function (node) { return node.id === childId; });\n                        if (!child) {\n                            return [2 /*return*/, { data: undefined }];\n                        }\n                        parent = tree.find(function (node) { return node.id === child[parentIdField]; });\n                        return [2 /*return*/, {\n                                data: parent,\n                            }];\n                }\n            });\n        }); }, getChildNodes: function (resource_1, _a) { return __awaiter(void 0, [resource_1, _a], void 0, function (resource, _b) {\n            var data, treeRecords;\n            var _c;\n            var parentId = _b.parentId, meta = _b.meta;\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0: return [4 /*yield*/, dataProvider.getList(resource, {\n                            filter: (_c = {}, _c[parentIdField] = parentId, _c),\n                            sort: { field: positionField, order: 'ASC' },\n                            pagination: { page: 1, perPage: 1000 },\n                            meta: meta,\n                        })];\n                    case 1:\n                        data = (_d.sent()).data;\n                        return [4 /*yield*/, Promise.all(data.map(function (record) {\n                                var _a;\n                                return dataProvider\n                                    .getList(resource, {\n                                    filter: (_a = {}, _a[parentIdField] = record.id, _a),\n                                    sort: {\n                                        field: positionField,\n                                        order: 'ASC',\n                                    },\n                                    pagination: { page: 1, perPage: 1000 },\n                                    meta: meta,\n                                })\n                                    .then(function (_a) {\n                                    var data = _a.data;\n                                    return (__assign(__assign({}, record), { children: data.map(function (_a) {\n                                            var id = _a.id;\n                                            return id;\n                                        }) }));\n                                });\n                            }))];\n                    case 2:\n                        treeRecords = _d.sent();\n                        return [2 /*return*/, {\n                                data: treeRecords,\n                            }];\n                }\n            });\n        }); }, moveAsNthChildOf: function (resource_1, _a) { return __awaiter(void 0, [resource_1, _a], void 0, function (resource, _b) {\n            var destinationSiblings, sourceSiblings, newRecord;\n            var _c, _d, _e;\n            var source = _b.source, destination = _b.destination, position = _b.position, meta = _b.meta;\n            return __generator(this, function (_f) {\n                switch (_f.label) {\n                    case 0: return [4 /*yield*/, dataProvider.getList(resource, {\n                            filter: (_c = {},\n                                _c[parentIdField] = destination.id,\n                                _c[\"\".concat(positionField, \"_gte\")] = position,\n                                _c),\n                            sort: {\n                                field: positionField,\n                                order: 'ASC',\n                            },\n                            pagination: { page: 1, perPage: 1000 },\n                            meta: meta,\n                        })];\n                    case 1:\n                        destinationSiblings = (_f.sent()).data;\n                        if (!(destinationSiblings.length > 0)) return [3 /*break*/, 3];\n                        return [4 /*yield*/, Promise.all(destinationSiblings.map(function (item) {\n                                var _a;\n                                return dataProvider.update(resource, {\n                                    id: item.id,\n                                    data: (_a = {}, _a[positionField] = item[positionField] + 1, _a),\n                                    previousData: item,\n                                    meta: meta,\n                                });\n                            }))];\n                    case 2:\n                        _f.sent();\n                        _f.label = 3;\n                    case 3: return [4 /*yield*/, dataProvider.getList(resource, {\n                            filter: (_d = {},\n                                _d[parentIdField] = source[parentIdField],\n                                _d[\"\".concat(positionField, \"_gt\")] = source[positionField],\n                                _d),\n                            sort: {\n                                field: positionField,\n                                order: 'ASC',\n                            },\n                            pagination: { page: 1, perPage: 1000 },\n                            meta: meta,\n                        })];\n                    case 4:\n                        sourceSiblings = (_f.sent()).data;\n                        if (!(sourceSiblings.length > 0)) return [3 /*break*/, 6];\n                        return [4 /*yield*/, Promise.all(sourceSiblings.map(function (item) {\n                                var _a;\n                                return dataProvider.update(resource, {\n                                    id: item.id,\n                                    data: (_a = {}, _a[positionField] = item[positionField] - 1, _a),\n                                    previousData: item,\n                                    meta: meta,\n                                });\n                            }))];\n                    case 5:\n                        _f.sent();\n                        _f.label = 6;\n                    case 6: return [4 /*yield*/, dataProvider.update(resource, {\n                            id: source.id,\n                            data: (_e = {},\n                                _e[parentIdField] = destination.id,\n                                _e[positionField] = position,\n                                _e),\n                            previousData: source,\n                            meta: meta,\n                        })];\n                    case 7:\n                        newRecord = (_f.sent()).data;\n                        return [2 /*return*/, { data: newRecord }];\n                }\n            });\n        }); }, moveAsNthSiblingOf: function (resource_1, _a) { return __awaiter(void 0, [resource_1, _a], void 0, function (resource, _b) {\n            var destinationSiblingsToUpdateFilter, destinationSiblings, sourceSiblingsToUpdateFilters, sourceSiblings, finalPosition;\n            var _c, _d, _e, _f, _g, _h, _j, _k;\n            var _l;\n            var source = _b.source, destination = _b.destination, position = _b.position, meta = _b.meta;\n            return __generator(this, function (_m) {\n                switch (_m.label) {\n                    case 0:\n                        if (position === 0 || position === -1) {\n                            destinationSiblingsToUpdateFilter = (_c = {},\n                                _c[parentIdField] = destination[parentIdField],\n                                _c);\n                        }\n                        if (source[positionField] > destination[positionField] &&\n                            source[parentIdField] === destination[parentIdField]) {\n                            if (position === -1) {\n                                destinationSiblingsToUpdateFilter = (_d = {},\n                                    _d[parentIdField] = destination[parentIdField],\n                                    _d[\"\".concat(positionField, \"_gte\")] = destination[positionField],\n                                    _d);\n                            }\n                            else {\n                                destinationSiblingsToUpdateFilter = (_e = {},\n                                    _e[parentIdField] = destination[parentIdField],\n                                    _e[\"\".concat(positionField, \"_gt\")] = destination[positionField],\n                                    _e);\n                            }\n                        }\n                        if (source[parentIdField] !== destination[parentIdField] &&\n                            position > 0) {\n                            destinationSiblingsToUpdateFilter = (_f = {},\n                                _f[parentIdField] = destination[parentIdField],\n                                _f[\"\".concat(positionField, \"_gt\")] = destination[positionField],\n                                _f);\n                        }\n                        if (!destinationSiblingsToUpdateFilter) return [3 /*break*/, 3];\n                        return [4 /*yield*/, dataProvider.getList(resource, {\n                                filter: destinationSiblingsToUpdateFilter,\n                                sort: {\n                                    field: positionField,\n                                    order: 'ASC',\n                                },\n                                pagination: { page: 1, perPage: 1000 },\n                                meta: meta,\n                            })];\n                    case 1:\n                        destinationSiblings = (_m.sent()).data;\n                        if (!(destinationSiblings.length > 0)) return [3 /*break*/, 3];\n                        return [4 /*yield*/, Promise.all(destinationSiblings.map(function (item) {\n                                var _a;\n                                return item.id === source.id\n                                    ? Promise.resolve(undefined)\n                                    : dataProvider.update(resource, {\n                                        id: item.id,\n                                        data: (_a = {},\n                                            _a[positionField] = item[positionField] + 1,\n                                            _a),\n                                        previousData: item,\n                                        meta: meta,\n                                    });\n                            }))];\n                    case 2:\n                        _m.sent();\n                        _m.label = 3;\n                    case 3:\n                        if (source[parentIdField] === destination[parentIdField]) {\n                            if (source[positionField] > destination[positionField]) {\n                                sourceSiblingsToUpdateFilters = (_g = {},\n                                    _g[parentIdField] = source[parentIdField],\n                                    _g[\"\".concat(positionField, \"_gt\")] = source[positionField],\n                                    _g);\n                            }\n                            else {\n                                sourceSiblingsToUpdateFilters = (_h = {},\n                                    _h[parentIdField] = source[parentIdField],\n                                    _h[\"\".concat(positionField, \"_gt\")] = source[positionField],\n                                    _h[\"\".concat(positionField, \"_lte\")] = destination[positionField],\n                                    _h);\n                            }\n                        }\n                        else {\n                            sourceSiblingsToUpdateFilters = (_j = {},\n                                _j[parentIdField] = source[parentIdField],\n                                _j[\"\".concat(positionField, \"_gt\")] = source[positionField],\n                                _j);\n                        }\n                        return [4 /*yield*/, dataProvider.getList(resource, {\n                                filter: sourceSiblingsToUpdateFilters,\n                                sort: {\n                                    field: positionField,\n                                    order: 'ASC',\n                                },\n                                pagination: { page: 1, perPage: 1000 },\n                                meta: meta,\n                            })];\n                    case 4:\n                        sourceSiblings = (_m.sent()).data;\n                        if (!(sourceSiblings.length > 0)) return [3 /*break*/, 6];\n                        return [4 /*yield*/, Promise.all(sourceSiblings.map(function (item) {\n                                var _a;\n                                return item.id === source.id\n                                    ? Promise.resolve(undefined)\n                                    : dataProvider.update(resource, {\n                                        id: item.id,\n                                        data: (_a = {},\n                                            _a[positionField] = item[positionField] - 1,\n                                            _a),\n                                        previousData: item,\n                                        meta: meta,\n                                    });\n                            }))];\n                    case 5:\n                        _m.sent();\n                        _m.label = 6;\n                    case 6:\n                        finalPosition = source[parentIdField] === destination[parentIdField]\n                            ? source[positionField] > destination[positionField]\n                                ? destination[positionField] + 1\n                                : destination[positionField]\n                            : position < 0\n                                ? 0\n                                : position;\n                        if (position === -1) {\n                            finalPosition = 0;\n                        }\n                        return [4 /*yield*/, dataProvider.update(resource, {\n                                id: source.id,\n                                data: (_k = {},\n                                    // Set parent to null if moving to root (can't set to undefined as that would keep the previous parent)\n                                    _k[parentIdField] = (_l = destination[parentIdField]) !== null && _l !== void 0 ? _l : null,\n                                    _k[positionField] = finalPosition,\n                                    _k),\n                                previousData: source,\n                                meta: meta,\n                            })];\n                    case 7:\n                        _m.sent();\n                        return [2 /*return*/, { data: undefined }];\n                }\n            });\n        }); }, addRootNode: function (resource_1, _a) { return __awaiter(void 0, [resource_1, _a], void 0, function (resource, _b) {\n            var roots, rootPosition, newRoot;\n            var _c, _d;\n            var data = _b.data, meta = _b.meta;\n            return __generator(this, function (_e) {\n                switch (_e.label) {\n                    case 0: return [4 /*yield*/, dataProvider.getList(resource, {\n                            filter: (_c = {}, _c[parentIdField] = null, _c),\n                            sort: { field: positionField, order: 'ASC' },\n                            pagination: { page: 1, perPage: 1000 },\n                            meta: meta,\n                        })];\n                    case 1:\n                        roots = (_e.sent()).data;\n                        rootPosition = roots.length > 0\n                            ? roots.reduce(function (acc, curr) {\n                                return curr[positionField] > acc\n                                    ? curr[positionField]\n                                    : acc;\n                            }, -Infinity) + 1\n                            : 0;\n                        return [4 /*yield*/, dataProvider.create(resource, {\n                                data: __assign(__assign({}, data), (_d = {}, _d[parentIdField] = null, _d[positionField] = rootPosition, _d)),\n                                meta: meta,\n                            })];\n                    case 2:\n                        newRoot = (_e.sent()).data;\n                        return [2 /*return*/, { data: __assign(__assign({}, newRoot), { children: [] }) }];\n                }\n            });\n        }); }, addChildNode: function (resource_1, _a) { return __awaiter(void 0, [resource_1, _a], void 0, function (resource, _b) {\n            var siblings, maxPosition, childPosition, newRoot;\n            var _c, _d;\n            var parentId = _b.parentId, data = _b.data, meta = _b.meta, position = _b.position;\n            return __generator(this, function (_e) {\n                switch (_e.label) {\n                    case 0: return [4 /*yield*/, dataProvider.getList(resource, {\n                            filter: (_c = {}, _c[parentIdField] = parentId, _c),\n                            sort: { field: positionField, order: 'ASC' },\n                            pagination: { page: 1, perPage: 1000 },\n                            meta: meta,\n                        })];\n                    case 1:\n                        siblings = (_e.sent()).data;\n                        maxPosition = siblings.length > 0\n                            ? siblings.reduce(function (acc, curr) {\n                                return curr[positionField] > acc\n                                    ? curr[positionField]\n                                    : acc;\n                            }, -Infinity) + 1\n                            : 0;\n                        childPosition = position !== undefined &&\n                            position >= 0 &&\n                            position <= maxPosition\n                            ? position\n                            : maxPosition;\n                        return [4 /*yield*/, dataProvider.create(resource, {\n                                data: __assign(__assign({}, data), (_d = {}, _d[parentIdField] = parentId, _d[positionField] = childPosition, _d)),\n                                meta: meta,\n                            })];\n                    case 2:\n                        newRoot = (_e.sent()).data;\n                        if (position !== undefined &&\n                            position >= 0 &&\n                            position <= maxPosition) {\n                            siblings.forEach(function (sibling) {\n                                var _a;\n                                if (sibling[positionField] >= position)\n                                    dataProvider.update(resource, {\n                                        id: sibling.id,\n                                        data: __assign(__assign({}, sibling), (_a = {}, _a[positionField] = sibling[positionField] + 1, _a)),\n                                        previousData: sibling,\n                                        meta: meta,\n                                    });\n                            });\n                        }\n                        return [2 /*return*/, { data: __assign(__assign({}, newRoot), { children: [] }) }];\n                }\n            });\n        }); }, deleteBranch: function (resource, params) { return __awaiter(void 0, void 0, void 0, function () {\n            var id, previousData, meta, siblings;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        id = params.id, previousData = params.previousData, meta = params.meta;\n                        // Deletion of the record itself must be handled by specialized method.\n                        return [4 /*yield*/, deleteBranch(treeDataProvider, resource, params)];\n                    case 1:\n                        // Deletion of the record itself must be handled by specialized method.\n                        _a.sent();\n                        return [4 /*yield*/, treeDataProvider.getChildNodes(resource, {\n                                parentId: previousData[parentIdField],\n                                meta: meta,\n                            })];\n                    case 2:\n                        siblings = (_a.sent()).data;\n                        // update the siblings position\n                        return [4 /*yield*/, Promise.all(siblings\n                                .filter(function (node) {\n                                return node[positionField] > previousData[positionField] &&\n                                    node.id !== id;\n                            })\n                                .map(function (node) {\n                                var _a;\n                                return dataProvider.update(resource, {\n                                    id: node.id,\n                                    data: __assign(__assign({}, node), (_a = {}, _a[positionField] = node[positionField] - 1, _a)),\n                                    previousData: node,\n                                    meta: meta,\n                                });\n                            }))];\n                    case 3:\n                        // update the siblings position\n                        _a.sent();\n                        return [2 /*return*/, { data: previousData }];\n                }\n            });\n        }); } });\n    return treeDataProvider;\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { useRef } from 'react';\nimport { useMutation, useQueryClient, } from '@tanstack/react-query';\nimport { useDataProvider } from 'react-admin';\n/**\n * Get a callback to call the dataProvider.addRootNode() method, the result and the loading state.\n *\n * @param {string} resource\n * @param {Params} params The addRootNode parameters { data }\n * @param {Object} options Options object to pass to the queryClient.\n * May include side effects to be executed upon success or failure, e.g. { onSuccess: () => { refresh(); } }\n *\n * @typedef Params\n * @prop params.data The record to add as a root node, e.g. { title: 'hello, world' }\n *\n * @returns The current mutation state. Destructure as [addRootNode, { data, error, isLoading }].\n *\n * The return value updates according to the request state:\n *\n * - initial: [addRootNode, { isLoading: false, isIdle: true }]\n * - start:   [addRootNode, { isLoading: true }]\n * - success: [addRootNode, { data: [data from response], isLoading: false, isSuccess: true }]\n * - error:   [addRootNode, { error: [error from response], isLoading: false, isError: true }]\n *\n * The addRootNode() function must be called with a resource and a parameter object: addRootNode(resource, { data, meta }, options)\n *\n * This hook uses react-query useMutation under the hood.\n * This means the state object contains mutate, isIdle, reset and other react-query methods.\n *\n * @see https://react-query.tanstack.com/reference/useMutation\n *\n * @example // set params when calling the addRootNode callback\n *\n * import { useAddRootNode } from '@react-admin/ra-tree';\n *\n * const AddNodeButton = () => {\n *     const node = { title: 'a root node' };\n *     const [addRootNode, { isLoading, error }] = useAddRootNode();\n *     const handleClick = () => {\n *         addRootNode('nodes', { data: node })\n *     }\n *     if (error) { return <p>ERROR</p>; }\n *     return <button disabled={isLoading} onClick={() => addRootNode()}>Add a new root node</button>;\n * };\n *\n * @example // set params when calling the hook\n *\n * import { useAddRootNode } from '@react-admin/ra-tree';\n *\n * const AddNodeButton = () => {\n *     const node = { title: 'a root node' };\n *     const [addRootNode, { isLoading, error }] = useAddRootNode('nodes', { data: node });\n *     if (error) { return <p>ERROR</p>; }\n *     return <button disabled={isLoading} onClick={() => addRootNode()}>Add a new root node</button>;\n * };\n *\n * @example // TypeScript\n * const [addRootNode, { data }] = useAddRootNode<Product>('products', { data: product });\n *                    \\-- data is Product\n */\nexport var useAddRootNode = function (resource, params, options) {\n    if (params === void 0) { params = {}; }\n    if (options === void 0) { options = {}; }\n    var dataProvider = useDataProvider();\n    var queryClient = useQueryClient();\n    var paramsRef = useRef(params);\n    var mutation = useMutation(__assign(__assign({ mutationFn: function (_a) {\n            var _b = _a === void 0 ? {} : _a, _c = _b.resource, callTimeResource = _c === void 0 ? resource : _c, _d = _b.data, callTimeData = _d === void 0 ? paramsRef.current.data : _d, _e = _b.meta, callTimeMeta = _e === void 0 ? paramsRef.current.meta : _e;\n            if (!callTimeResource) {\n                throw new Error('useAddRootNode mutation requires a non-empty resource');\n            }\n            if (callTimeData == null) {\n                throw new Error('useAddRootNode mutation requires non-empty data');\n            }\n            return dataProvider\n                .addRootNode(callTimeResource, {\n                data: callTimeData,\n                meta: callTimeMeta,\n            })\n                .then(function (_a) {\n                var data = _a.data;\n                return data;\n            });\n        } }, options), { onSuccess: function (data, variables, context) {\n            if (variables === void 0) { variables = {}; }\n            var _a = variables.resource, callTimeResource = _a === void 0 ? resource : _a;\n            queryClient.setQueryData([callTimeResource, 'getOne', { id: String(data.id) }], data);\n            if (options.onSuccess) {\n                options.onSuccess(data, variables, context);\n            }\n            // call-time success callback is executed by react-query\n        } }));\n    var addRootNode = function () {\n        var args_1 = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args_1[_i] = arguments[_i];\n        }\n        return __awaiter(void 0, __spreadArray([], args_1, true), void 0, function (callTimeResource, callTimeParams, callTimeOptions) {\n            var returnPromise, otherOptions;\n            if (callTimeResource === void 0) { callTimeResource = resource; }\n            if (callTimeParams === void 0) { callTimeParams = {}; }\n            if (callTimeOptions === void 0) { callTimeOptions = {}; }\n            return __generator(this, function (_a) {\n                returnPromise = callTimeOptions.returnPromise, otherOptions = __rest(callTimeOptions, [\"returnPromise\"]);\n                if (returnPromise) {\n                    return [2 /*return*/, mutation.mutateAsync(__assign({ resource: callTimeResource }, callTimeParams), callTimeOptions)];\n                }\n                mutation.mutate(__assign({ resource: callTimeResource }, callTimeParams), otherOptions);\n                return [2 /*return*/];\n            });\n        });\n    };\n    return [addRootNode, mutation];\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { useRef } from 'react';\nimport { useMutation, useQueryClient, } from '@tanstack/react-query';\nimport { undoableEventEmitter, useDataProvider, } from 'react-admin';\n/**\n * Get a callback to call the dataProvider.deleteBranch() method, the result and the loading state.\n *\n * @param {string} resource\n * @param {Params} params The deleteBranch parameters { id, previousData }\n * @param {Object} options Options object to pass to the queryClient.\n * May include side effects to be executed upon success or failure, e.g. { onSuccess: () => { refresh(); } }\n * May include a mutation mode (optimistic/pessimistic/undoable), e.g. { mutationMode: 'undoable' }\n *\n * @typedef Params\n * @prop params.id The resource identifier, e.g. 123\n * @prop params.previousData The record before the update is applied\n *\n * @returns The current mutation state. Destructure as [deleteBranch, { data, error, isPending }].\n *\n * The return value updates according to the request state:\n *\n * - initial: [deleteBranch, { isPending: false, isIdle: true }]\n * - start:   [deleteBranch, { isPending: true }]\n * - success: [deleteBranch, { data: [data from response], isPending: false, isSuccess: true }]\n * - error:   [deleteBranch, { error: [error from response], isPending: false, isError: true }]\n *\n * The deleteBranch() function must be called with a resource and a parameter object: deleteBranch(resource, { id, previousData, meta }, options)\n *\n * This hook uses react-query useMutation under the hood.\n * This means the state object contains mutate, isIdle, reset and other react-query methods.\n *\n * @see https://react-query.tanstack.com/reference/useMutation\n *\n * @example // set params when calling the deleteBranch callback\n *\n * import { useDeleteBranch } from 'react-admin';\n *\n * const DeleteButton = ({ record }) => {\n *     const [deleteBranch, { isPending, error }] = useDeleteBranch();\n *     const handleClick = () => {\n *         deleteBranch('nodes', { id: record.id }, record)\n *     }\n *     if (error) { return <p>ERROR</p>; }\n *     return <button disabled={isPending} onClick={handleClick}>Delete</div>;\n * };\n *\n * @example // set params when calling the hook\n *\n * import { useDeleteBranch } from 'react-admin';\n *\n * const DeleteButton = ({ record }) => {\n *     const [deleteBranch, { isPending, error }] = useDeleteBranch('nodes', { id: record.id }, record);\n *     if (error) { return <p>ERROR</p>; }\n *     return <button disabled={isPending} onClick={() => deleteBranch()}>Delete</button>;\n * };\n *\n * @example // TypeScript\n * const [delete, { data }] = deleteBranch<Category>('nodes', { id });\n *                    \\-- data is Category\n */\nexport var useDeleteBranch = function (resource, params, options) {\n    if (params === void 0) { params = {}; }\n    if (options === void 0) { options = {}; }\n    var dataProvider = useDataProvider();\n    var queryClient = useQueryClient();\n    var id = params.id, previousData = params.previousData;\n    var _a = options.mutationMode, mutationMode = _a === void 0 ? 'pessimistic' : _a, reactMutationOptions = __rest(options, [\"mutationMode\"]);\n    var mode = useRef(mutationMode);\n    var paramsRef = useRef(params);\n    var snapshot = useRef([]);\n    var updateCache = function (_a) {\n        var resource = _a.resource, id = _a.id;\n        // hack: only way to tell react-query not to fetch this query for the next 5 seconds\n        // because setQueryData doesn't accept a stale time option\n        var now = Date.now();\n        var updatedAt = mode.current === 'undoable' ? now + 5 * 1000 : now;\n        var removeRecord = function (old, parentId) {\n            var index = old.findIndex(\n            // eslint-disable-next-line eqeqeq\n            function (record) { return record.id == parentId; });\n            if (index === -1) {\n                return old;\n            }\n            var record = old[index];\n            var newRecords = __spreadArray(__spreadArray([], old.slice(0, index), true), old.slice(index + 1), true);\n            var children = record.children || [];\n            for (var _i = 0, children_1 = children; _i < children_1.length; _i++) {\n                var childId = children_1[_i];\n                newRecords = removeRecord(newRecords, childId);\n            }\n            return newRecords;\n        };\n        var updateCollection = function (old) {\n            var newRecords = removeRecord(old, id);\n            return newRecords.map(function (record) { return (__assign(__assign({}, record), { children: record.children\n                    ? record.children.filter(function (childId) { return childId !== id; })\n                    : record.children })); });\n        };\n        queryClient.setQueriesData({\n            queryKey: [resource, 'getTree'],\n        }, function (res) {\n            if (!res)\n                return res;\n            var newCollection = updateCollection(res);\n            var recordWasFound = newCollection.length < res.length;\n            return recordWasFound ? newCollection : res;\n        }, { updatedAt: updatedAt });\n        queryClient.setQueriesData({\n            queryKey: [resource, 'getRootNodes'],\n        }, function (res) {\n            return res && res.length > 0 ? updateCollection(res) : res;\n        }, { updatedAt: updatedAt });\n        queryClient.setQueriesData({\n            queryKey: [resource, 'getChildNodes'],\n        }, function (res) {\n            if (!res)\n                return res;\n            var newCollection = updateCollection(res);\n            var recordWasFound = newCollection.length < res.length;\n            return recordWasFound ? newCollection : res;\n        }, { updatedAt: updatedAt });\n    };\n    var mutation = useMutation(__assign(__assign({ mutationFn: function (_a) {\n            var _b = _a === void 0 ? {} : _a, _c = _b.resource, callTimeResource = _c === void 0 ? resource : _c, _d = _b.id, callTimeId = _d === void 0 ? paramsRef.current.id : _d, _e = _b.previousData, callTimePreviousData = _e === void 0 ? paramsRef.current.previousData : _e, _f = _b.meta, callTimeMeta = _f === void 0 ? paramsRef.current.meta : _f;\n            if (!callTimeResource) {\n                throw new Error('useDeleteBranch mutation requires a non-empty resource');\n            }\n            if (callTimeId == null) {\n                throw new Error('useDeleteBranch mutation requires non-empty id');\n            }\n            if (callTimePreviousData == null) {\n                throw new Error('useDeleteBranch mutation requires non-empty previousData');\n            }\n            return dataProvider\n                .deleteBranch(callTimeResource, {\n                id: callTimeId,\n                previousData: callTimePreviousData,\n                meta: callTimeMeta,\n            })\n                .then(function (_a) {\n                var data = _a.data;\n                return data;\n            });\n        } }, reactMutationOptions), { onMutate: function (variables) { return __awaiter(void 0, void 0, void 0, function () {\n            var userContext;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!reactMutationOptions.onMutate) return [3 /*break*/, 2];\n                        return [4 /*yield*/, reactMutationOptions.onMutate(variables)];\n                    case 1:\n                        userContext = (_a.sent()) || {};\n                        return [2 /*return*/, __assign({ snapshot: snapshot.current }, userContext)];\n                    case 2: \n                    // Return a context object with the snapshot value\n                    return [2 /*return*/, { snapshot: snapshot.current }];\n                }\n            });\n        }); }, onError: function (error, variables, context) {\n            if (mode.current === 'optimistic' || mode.current === 'undoable') {\n                // If the mutation fails, use the context returned from onMutate to rollback\n                context.snapshot.forEach(function (_a) {\n                    var key = _a[0], value = _a[1];\n                    queryClient.setQueryData(key, value);\n                });\n            }\n            if (reactMutationOptions.onError) {\n                return reactMutationOptions.onError(error, variables, context);\n            }\n            // call-time error callback is executed by react-query\n        }, onSuccess: function (data, variables, context) {\n            if (variables === void 0) { variables = {}; }\n            if (mode.current === 'pessimistic') {\n                // update the getOne and getList query cache with the new result\n                var _a = variables.resource, callTimeResource = _a === void 0 ? resource : _a, _b = variables.id, callTimeId = _b === void 0 ? id : _b;\n                updateCache({\n                    resource: callTimeResource,\n                    id: callTimeId,\n                });\n                if (reactMutationOptions.onSuccess) {\n                    // @ts-ignore\n                    reactMutationOptions.onSuccess(data, variables, context);\n                }\n                // call-time success callback is executed by react-query\n            }\n        }, onSettled: function (data, error, variables, context) {\n            if (variables === void 0) { variables = {}; }\n            if (mode.current === 'optimistic' || mode.current === 'undoable') {\n                // Always refetch after error or success:\n                context.snapshot.forEach(function (_a) {\n                    var key = _a[0];\n                    queryClient.invalidateQueries({ queryKey: key });\n                });\n            }\n            if (reactMutationOptions.onSettled) {\n                return reactMutationOptions.onSettled(data, error, variables, context);\n            }\n        } }));\n    var mutate = function () {\n        var args_1 = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args_1[_i] = arguments[_i];\n        }\n        return __awaiter(void 0, __spreadArray([], args_1, true), void 0, function (callTimeResource, callTimeParams, callTimeOptions) {\n            var mutationMode, onSuccess, onSettled, onError, _a, callTimeId, _b, callTimePreviousData, queryKeys;\n            if (callTimeResource === void 0) { callTimeResource = resource; }\n            if (callTimeParams === void 0) { callTimeParams = {}; }\n            if (callTimeOptions === void 0) { callTimeOptions = {}; }\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        mutationMode = callTimeOptions.mutationMode, onSuccess = callTimeOptions.onSuccess, onSettled = callTimeOptions.onSettled, onError = callTimeOptions.onError;\n                        // store the hook time params *at the moment of the call*\n                        // because they may change afterwards, which would break the undoable mode\n                        // as the previousData would be overwritten by the optimistic update\n                        paramsRef.current = params;\n                        if (mutationMode) {\n                            mode.current = mutationMode;\n                        }\n                        if (mode.current === 'pessimistic') {\n                            return [2 /*return*/, mutation.mutate(__assign({ resource: callTimeResource }, callTimeParams), { onSuccess: onSuccess, onSettled: onSettled, onError: onError })];\n                        }\n                        _a = callTimeParams.id, callTimeId = _a === void 0 ? id : _a, _b = callTimeParams.previousData, callTimePreviousData = _b === void 0 ? previousData : _b;\n                        queryKeys = [\n                            [callTimeResource, 'getTree'],\n                            [callTimeResource, 'getRootNodes'],\n                            [callTimeResource, 'getChildNodes'],\n                        ];\n                        /**\n                         * Snapshot the previous values via queryClient.getQueriesData()\n                         *\n                         * The snapshotData ref will contain an array of tuples [query key, associated data]\n                         *\n                         * @example\n                         * [\n                         *   [['posts', 'getList'], { data: [{ id: 1, title: 'Hello' }], total: 1 }],\n                         *   [['posts', 'getMany'], [{ id: 1, title: 'Hello' }]],\n                         * ]\n                         *\n                         * @see https://react-query.tanstack.com/reference/QueryClient#queryclientgetqueriesdata\n                         */\n                        snapshot.current = queryKeys.reduce(function (prev, curr) {\n                            return prev.concat(queryClient.getQueriesData({ queryKey: curr }));\n                        }, []);\n                        // Cancel any outgoing re-fetches (so they don't overwrite our optimistic update)\n                        return [4 /*yield*/, Promise.all(snapshot.current.map(function (_a) {\n                                var key = _a[0];\n                                return queryClient.cancelQueries({ queryKey: key });\n                            }))];\n                    case 1:\n                        // Cancel any outgoing re-fetches (so they don't overwrite our optimistic update)\n                        _c.sent();\n                        // Optimistically update to the new value\n                        updateCache({\n                            resource: callTimeResource,\n                            id: callTimeId,\n                        });\n                        // run the success callbacks during the next tick\n                        if (onSuccess) {\n                            setTimeout(function () {\n                                return onSuccess(callTimePreviousData, __assign({ resource: callTimeResource }, callTimeParams), { snapshot: snapshot.current });\n                            }, 0);\n                        }\n                        if (reactMutationOptions.onSuccess) {\n                            setTimeout(function () {\n                                if (reactMutationOptions.onSuccess) {\n                                    reactMutationOptions.onSuccess(callTimePreviousData, __assign({ resource: callTimeResource }, callTimeParams), { snapshot: snapshot.current });\n                                }\n                            }, 0);\n                        }\n                        if (mode.current === 'optimistic') {\n                            // call the mutate method without success side effects\n                            return [2 /*return*/, mutation.mutate(__assign({ resource: callTimeResource }, callTimeParams), { onSettled: onSettled, onError: onError })];\n                        }\n                        else {\n                            // undoable mutation: register the mutation for later\n                            undoableEventEmitter.once('end', function (_a) {\n                                var isUndo = _a.isUndo;\n                                if (isUndo) {\n                                    // rollback\n                                    snapshot.current.forEach(function (_a) {\n                                        var key = _a[0], value = _a[1];\n                                        queryClient.setQueryData(key, value);\n                                    });\n                                }\n                                else {\n                                    // call the mutate method without success side effects\n                                    mutation.mutate(__assign({ resource: callTimeResource }, callTimeParams), { onSettled: onSettled, onError: onError });\n                                }\n                            });\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return [mutate, mutation];\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { useDataProvider, useEvent, } from 'react-admin';\nimport { useMutation, } from '@tanstack/react-query';\n/**\n * Internal hook used to lazy load a node children using the dataProvider.getChildNodes() method.\n *\n * @param {string} resource The resource name, e.g. 'posts'\n * @param {Params} params The getChildNodes parameters\n * @param {Object} options Options object to pass to the queryClient.\n * May include side effects to be executed upon success or failure, e.g. { onSuccess: () => { refresh(); } }\n *\n * @typedef Params\n * @prop params.parentId The parent node identifier\n * @prop params.meta Optional meta parameters\n\n * The data structure is a flat array of TreeRecords (i.e. Records with a children field containing an array of Identifiers).\n *\n * @example // sample return value\n * [\n *   { id: 1, title: 'foo1', children: [3, 4] },\n *   { id: 2, title: 'foo2', children: [] },\n *   { id: 3, title: 'foo3', children: [5] },\n *   { id: 4, title: 'foo4', children: [] },\n *   { id: 5, title: 'foo5', children: [] },\n * ]\n */\nexport var useGetChildNodesCallback = function (resource, params, options) {\n    var dataProvider = useDataProvider();\n    var mutation = useMutation(__assign({ mutationKey: [resource, 'getChildNodes', params], mutationFn: function (variables) {\n            return dataProvider\n                .getChildNodes(resource, __assign(__assign({}, params), variables))\n                .then(function (_a) {\n                var data = _a.data;\n                return data;\n            });\n        } }, options));\n    var callback = useEvent(function (parentId) {\n        return mutation.mutateAsync(__assign(__assign({}, params), { parentId: parentId }));\n    });\n    return callback;\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar removeChildren = function (record) { return (__assign(__assign({}, record), { children: record.children.map(function (record) { return record.id; }) })); };\nexport default removeChildren;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { useCallback } from 'react';\nimport { useDataProvider } from 'react-admin';\nimport { useMutation, useQueryClient, } from '@tanstack/react-query';\nimport { updateQueryCacheFromGetTree } from './useGetTree';\n/**\n * Get a callback to call the dataProvider.getTree() method.\n *\n * Useful for refreshing the tree in an event handler.\n *\n * @param {string} resource The resource name, e.g. 'posts'\n * @param {Params} params The getTree parameters { meta }\n * @param {Object} options Options object to pass to the queryClient.\n * May include side effects to be executed upon success or failure, e.g. { onSuccess: () => { refresh(); } }\n *\n * The data structure is a flat array of TreeRecords (i.e. Records with a children field containing an array of Identifiers).\n *\n * @example // sample return value\n * [\n *   { id: 1, title: 'foo1', children: [3, 4] },\n *   { id: 2, title: 'foo2', children: [] },\n *   { id: 3, title: 'foo3', children: [5] },\n *   { id: 4, title: 'foo4', children: [] },\n *   { id: 5, title: 'foo5', children: [] },\n * ]\n *\n * @example // usage\n *\n * import { useNotify } from 'react-admin';\n * import { useGetTreeCallback } from '@react-admin/ra-tree';\n *\n * const MyComponent = () => {\n *     const refreshTree = useGetTreeCallback(resource);\n *\n *     const handleClick = () => {\n *         refreshTree()\n *             .then(tree => {\n *                 notify(`Reloaded ${tree.length} tree nodes`);\n *             });\n *     };\n *\n *     return <button onClick={handleClick}>Refresh tree</button>;\n * }\n */\nexport var useGetTreeCallback = function (resource, params, options) {\n    if (params === void 0) { params = {}; }\n    if (options === void 0) { options = {}; }\n    var dataProvider = useDataProvider();\n    var queryClient = useQueryClient();\n    var mutation = useMutation(__assign({ mutationKey: [resource, 'getTree', params], mutationFn: function () {\n            return dataProvider\n                .getTree(resource, params)\n                .then(function (_a) {\n                var data = _a.data;\n                return data;\n            });\n        }, onSuccess: function (data) {\n            updateQueryCacheFromGetTree(queryClient, resource, data, params);\n        } }, options));\n    var callback = useCallback(function () { return mutation.mutateAsync(params); }, [mutation, params]);\n    return callback;\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { useRef } from 'react';\nimport { useMutation, useQueryClient, } from '@tanstack/react-query';\nimport { undoableEventEmitter, useDataProvider, } from 'react-admin';\nimport cloneDeep from 'lodash/cloneDeep';\n/**\n * Get a callback to call the dataProvider.moveAsNthChildOf() method, the result and the loading state.\n *\n * @param {string} resource\n * @param {Params} params The moveAsNthChildOf parameters { id, previousData }\n * @param {Object} options Options object to pass to the queryClient.\n * May include side effects to be executed upon success or failure, e.g. { onSuccess: () => { refresh(); } }\n * May include a mutation mode (optimistic/pessimistic/undoable), e.g. { mutationMode: 'undoable' }\n *\n * @typedef Params\n * @prop params.id The resource identifier, e.g. 123\n * @prop params.previousData The record before the update is applied\n *\n * @returns The current mutation state. Destructure as [moveAsNthChildOf, { data, error, isLoading }].\n *\n * The return value updates according to the request state:\n *\n * - initial: [moveAsNthChildOf, { isLoading: false, isIdle: true }]\n * - start:   [moveAsNthChildOf, { isLoading: true }]\n * - success: [moveAsNthChildOf, { data: [data from response], isLoading: false, isSuccess: true }]\n * - error:   [moveAsNthChildOf, { error: [error from response], isLoading: false, isError: true }]\n *\n * The moveAsNthChildOf() function must be called with a resource and a parameter object: moveAsNthChildOf(resource, { id, previousData, meta }, options)\n *\n * This hook uses react-query useMutation under the hood.\n * This means the state object contains mutate, isIdle, reset and other react-query methods.\n *\n * @see https://react-query.tanstack.com/reference/useMutation\n *\n * @example // set params when calling the moveAsNthChildOf callback\n *\n * import { useMoveAsNthChildOf } from '@react-admin/ra-tree';\n *\n * const MoveAsNthChildOfButton = ({ record }) => {\n *     const [moveAsNthChildOf, { isLoading, error }] = useMoveAsNthChildOf();\n *     const handleClick = () => {\n *         moveAsNthChildOf('nodes', { id: record.id }, record)\n *     }\n *     if (error) { return <p>ERROR</p>; }\n *     return <button disabled={isLoading} onClick={handleClick}>Delete</div>;\n * };\n *\n * @example // set params when calling the hook\n *\n * import { useMoveAsNthChildOf } from '@react-admin/ra-tree';\n *\n * const DeleteButton = ({ record }) => {\n *     const [moveAsNthChildOf, { isLoading, error }] = useMoveAsNthChildOf('nodes', { id: record.id }, record);\n *     if (error) { return <p>ERROR</p>; }\n *     return <button disabled={isLoading} onClick={() => moveAsNthChildOf()}>Delete</button>;\n * };\n *\n * @example // TypeScript\n * const [delete, { data }] = useMoveAsNthChildOf<Product>('products', { id, previousData: product });\n *                    \\-- data is Product\n */\nexport var useMoveAsNthChildOf = function (resource, params, options) {\n    if (params === void 0) { params = {\n        source: undefined,\n        destination: undefined,\n        position: undefined,\n        meta: undefined,\n    }; }\n    if (options === void 0) { options = {}; }\n    var dataProvider = useDataProvider();\n    var queryClient = useQueryClient();\n    var source = params.source, destination = params.destination, position = params.position;\n    var _a = options.mutationMode, mutationMode = _a === void 0 ? 'undoable' : _a, reactMutationOptions = __rest(options, [\"mutationMode\"]);\n    var mode = useRef(mutationMode);\n    var paramsRef = useRef(params);\n    var snapshot = useRef([]);\n    var updateCache = function (_a) {\n        var resource = _a.resource, position = _a.position, source = _a.source, destination = _a.destination;\n        // hack: only way to tell react-query not to fetch this query for the next 5 seconds\n        // because setQueryData doesn't accept a stale time option\n        var now = Date.now();\n        var updatedAt = mode.current === 'undoable' ? now + 5 * 1000 : now;\n        var updateCollection = function (old) {\n            var _a, _b, _c, _d, _e;\n            var newRecords = cloneDeep(old);\n            // Remove the node from its previous parent\n            var oldParent = newRecords.find(function (record) { var _a; return (_a = record.children) === null || _a === void 0 ? void 0 : _a.includes(source.id); });\n            if (oldParent) {\n                oldParent.children = (_a = oldParent.children) === null || _a === void 0 ? void 0 : _a.filter(function (childId) { return childId !== source.id; });\n            }\n            else {\n                // It's a root node\n                newRecords = newRecords.filter(function (record) { return record.id !== source.id; });\n            }\n            // Add the node to the new parent\n            var newParent = newRecords.find(function (record) { return record.id === destination.id; });\n            if (newParent) {\n                newParent.children = __spreadArray(__spreadArray(__spreadArray([], ((_c = (_b = newParent.children) === null || _b === void 0 ? void 0 : _b.slice(0, position)) !== null && _c !== void 0 ? _c : []), true), [\n                    source.id\n                ], false), ((_e = (_d = newParent.children) === null || _d === void 0 ? void 0 : _d.slice(position)) !== null && _e !== void 0 ? _e : []), true);\n            }\n            else {\n                // It's a root node\n                newRecords = newRecords.filter(function (record) { return record.id !== source.id; });\n                newRecords = __spreadArray(__spreadArray(__spreadArray([], newRecords.slice(0, position), true), [\n                    source\n                ], false), newRecords.slice(position), true);\n            }\n            return newRecords;\n        };\n        queryClient.setQueriesData({\n            queryKey: [resource, 'getTree'],\n        }, function (res) {\n            return res && res.length > 0 ? updateCollection(res) : res;\n        }, { updatedAt: updatedAt });\n        queryClient.setQueriesData({\n            queryKey: [resource, 'getRootNodes'],\n        }, function (res) {\n            return res && res.length > 0 ? updateCollection(res) : res;\n        }, { updatedAt: updatedAt });\n        queryClient.setQueriesData({\n            queryKey: [resource, 'getChildNodes'],\n        }, function (res) {\n            return res && res.length > 0 ? updateCollection(res) : res;\n        }, { updatedAt: updatedAt });\n    };\n    var mutation = useMutation(__assign(__assign({ mutationFn: function (_a) {\n            var _b = _a === void 0 ? {} : _a, _c = _b.resource, callTimeResource = _c === void 0 ? resource : _c, _d = _b.position, callTimePosition = _d === void 0 ? paramsRef.current.position : _d, _e = _b.source, callTimeSource = _e === void 0 ? paramsRef.current.source : _e, _f = _b.destination, callTimeDestination = _f === void 0 ? paramsRef.current.destination : _f, _g = _b.meta, callTimeMeta = _g === void 0 ? paramsRef.current.meta : _g;\n            if (callTimeResource == null) {\n                throw new Error('useMoveAsNthChildOf mutation requires a non-empty resource');\n            }\n            if (callTimePosition == null) {\n                throw new Error('useMoveAsNthChildOf mutation requires a non-empty position');\n            }\n            if (callTimeSource == null) {\n                throw new Error('useMoveAsNthChildOf mutation requires a non-empty source');\n            }\n            if (callTimeDestination == null) {\n                throw new Error('useMoveAsNthChildOf mutation requires a non-empty destination');\n            }\n            return dataProvider\n                .moveAsNthChildOf(callTimeResource, {\n                position: callTimePosition,\n                source: callTimeSource,\n                destination: callTimeDestination,\n                meta: callTimeMeta,\n            })\n                .then(function (_a) {\n                var data = _a.data;\n                return data;\n            });\n        } }, reactMutationOptions), { onMutate: function (variables) { return __awaiter(void 0, void 0, void 0, function () {\n            var userContext;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!reactMutationOptions.onMutate) return [3 /*break*/, 2];\n                        return [4 /*yield*/, reactMutationOptions.onMutate(variables)];\n                    case 1:\n                        userContext = (_a.sent()) || {};\n                        return [2 /*return*/, __assign({ snapshot: snapshot.current }, userContext)];\n                    case 2: \n                    // Return a context object with the snapshot value\n                    return [2 /*return*/, { snapshot: snapshot.current }];\n                }\n            });\n        }); }, onError: function (error, variables, context) {\n            if (mode.current === 'optimistic' || mode.current === 'undoable') {\n                // If the mutation fails, use the context returned from onMutate to rollback\n                context.snapshot.forEach(function (_a) {\n                    var key = _a[0], value = _a[1];\n                    queryClient.setQueryData(key, value);\n                });\n            }\n            if (reactMutationOptions.onError) {\n                return reactMutationOptions.onError(error, variables, context);\n            }\n            // call-time error callback is executed by react-query\n        }, onSettled: function (data, error, variables, context) {\n            if (variables === void 0) { variables = {}; }\n            // Moving a node might have updated other nodes, so we need to invalidate the cache in all cases\n            var _a = variables.resource, callTimeResource = _a === void 0 ? resource : _a;\n            queryClient.invalidateQueries({\n                queryKey: [callTimeResource, 'getTree'],\n            });\n            queryClient.invalidateQueries({\n                queryKey: [callTimeResource, 'getRootNodes'],\n            });\n            queryClient.invalidateQueries({\n                queryKey: [callTimeResource, 'getChildNodes'],\n            });\n            if (reactMutationOptions.onSettled) {\n                return reactMutationOptions.onSettled(data, error, variables, context);\n            }\n        } }));\n    var mutate = function () {\n        var args_1 = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args_1[_i] = arguments[_i];\n        }\n        return __awaiter(void 0, __spreadArray([], args_1, true), void 0, function (callTimeResource, callTimeParams, callTimeOptions) {\n            var mutationMode, onSuccess, onSettled, onError, _a, callTimePosition, _b, callTimeSource, _c, callTimeDestination, queryKeys;\n            if (callTimeResource === void 0) { callTimeResource = resource; }\n            if (callTimeParams === void 0) { callTimeParams = {}; }\n            if (callTimeOptions === void 0) { callTimeOptions = {}; }\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0:\n                        mutationMode = callTimeOptions.mutationMode, onSuccess = callTimeOptions.onSuccess, onSettled = callTimeOptions.onSettled, onError = callTimeOptions.onError;\n                        // store the hook time params *at the moment of the call*\n                        // because they may change afterwards, which would break the undoable mode\n                        // as the previousData would be overwritten by the optimistic update\n                        paramsRef.current = params;\n                        if (mutationMode) {\n                            mode.current = mutationMode;\n                        }\n                        if (mode.current === 'pessimistic') {\n                            return [2 /*return*/, mutation.mutate(__assign({ resource: callTimeResource }, callTimeParams), { onSuccess: onSuccess, onSettled: onSettled, onError: onError })];\n                        }\n                        _a = callTimeParams.position, callTimePosition = _a === void 0 ? position : _a, _b = callTimeParams.source, callTimeSource = _b === void 0 ? source : _b, _c = callTimeParams.destination, callTimeDestination = _c === void 0 ? destination : _c;\n                        if (callTimeResource == null) {\n                            throw new Error('useMoveAsNthChildOf mutation requires a non-empty resource');\n                        }\n                        if (callTimePosition == null) {\n                            throw new Error('useMoveAsNthChildOf mutation requires a non-empty position');\n                        }\n                        if (callTimeSource == null) {\n                            throw new Error('useMoveAsNthChildOf mutation requires a non-empty source');\n                        }\n                        if (callTimeDestination == null) {\n                            throw new Error('useMoveAsNthChildOf mutation requires a non-empty destination');\n                        }\n                        queryKeys = [\n                            [callTimeResource, 'getTree'],\n                            [callTimeResource, 'getRootNodes'],\n                            [callTimeResource, 'getChildNodes'],\n                        ];\n                        /**\n                         * Snapshot the previous values via queryClient.getQueriesData()\n                         *\n                         * The snapshotData ref will contain an array of tuples [query key, associated data]\n                         *\n                         * @example\n                         * [\n                         *   [['posts', 'getList'], { data: [{ id: 1, title: 'Hello' }], total: 1 }],\n                         *   [['posts', 'getMany'], [{ id: 1, title: 'Hello' }]],\n                         * ]\n                         *\n                         * @see https://react-query.tanstack.com/reference/QueryClient#queryclientgetqueriesdata\n                         */\n                        snapshot.current = queryKeys.reduce(function (prev, curr) {\n                            return prev.concat(queryClient.getQueriesData({ queryKey: curr }));\n                        }, []);\n                        // Cancel any outgoing re-fetches (so they don't overwrite our optimistic update)\n                        return [4 /*yield*/, Promise.all(snapshot.current.map(function (_a) {\n                                var key = _a[0];\n                                return queryClient.cancelQueries({ queryKey: key });\n                            }))];\n                    case 1:\n                        // Cancel any outgoing re-fetches (so they don't overwrite our optimistic update)\n                        _d.sent();\n                        // Optimistically update to the new value\n                        updateCache({\n                            resource: callTimeResource,\n                            position: callTimePosition,\n                            source: callTimeSource,\n                            destination: callTimeDestination,\n                        });\n                        // run the success callbacks during the next tick\n                        if (onSuccess) {\n                            setTimeout(function () {\n                                return onSuccess(undefined, __assign({ resource: callTimeResource }, callTimeParams), { snapshot: snapshot.current });\n                            }, 0);\n                        }\n                        if (reactMutationOptions.onSuccess) {\n                            setTimeout(function () {\n                                if (reactMutationOptions.onSuccess) {\n                                    reactMutationOptions.onSuccess(undefined, __assign({ resource: callTimeResource }, callTimeParams), { snapshot: snapshot.current });\n                                }\n                            }, 0);\n                        }\n                        if (mode.current === 'optimistic') {\n                            // call the mutate method without success side effects\n                            return [2 /*return*/, mutation.mutate(__assign({ resource: callTimeResource }, callTimeParams), { onSettled: onSettled, onError: onError })];\n                        }\n                        else {\n                            // undoable mutation: register the mutation for later\n                            undoableEventEmitter.once('end', function (_a) {\n                                var isUndo = _a.isUndo;\n                                if (isUndo) {\n                                    // rollback\n                                    snapshot.current.forEach(function (_a) {\n                                        var key = _a[0], value = _a[1];\n                                        queryClient.setQueryData(key, value);\n                                    });\n                                }\n                                else {\n                                    // call the mutate method without success side effects\n                                    mutation.mutate(__assign({ resource: callTimeResource }, callTimeParams), { onSettled: onSettled, onError: onError });\n                                }\n                            });\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return [mutate, mutation];\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { useRef } from 'react';\nimport { useMutation, useQueryClient, } from '@tanstack/react-query';\nimport { undoableEventEmitter, useDataProvider, } from 'react-admin';\nimport cloneDeep from 'lodash/cloneDeep';\n/**\n * Get a callback to call the dataProvider.moveAsNthChildOf() method, the result and the loading state.\n *\n * @param {string} resource\n * @param {Params} params The moveAsNthChildOf parameters { source, destination, position, meta }\n * @param {Object} options Options object to pass to the queryClient.\n * May include side effects to be executed upon success or failure, e.g. { onSuccess: () => { refresh(); } }\n * May include a mutation mode (optimistic/pessimistic/undoable), e.g. { mutationMode: 'undoable' }\n *\n * @typedef Params\n * @prop params.id The resource identifier, e.g. 123\n * @prop params.previousData The record before the update is applied\n *\n * @returns The current mutation state. Destructure as [moveAsNthChildOf, { data, error, isPending }].\n *\n * The return value updates according to the request state:\n *\n * - initial: [moveAsNthChildOf, { isPending: false, isIdle: true }]\n * - start:   [moveAsNthChildOf, { isPending: true }]\n * - success: [moveAsNthChildOf, { data: [data from response], isPending: false, isSuccess: true }]\n * - error:   [moveAsNthChildOf, { error: [error from response], isPending: false, isError: true }]\n *\n * The moveAsNthChildOf() function must be called with a resource and a parameter object: moveAsNthChildOf(resource, { id, previousData, meta }, options)\n *\n * This hook uses react-query useMutation under the hood.\n * This means the state object contains mutate, isIdle, reset and other react-query methods.\n *\n * @see https://react-query.tanstack.com/reference/useMutation\n *\n * @example // set params when calling the moveAsNthChildOf callback\n *\n * import { useMoveAsNthSiblingOf } from '@react-admin/ra-tree';\n *\n * const MoveAsNthChildOfButton = ({ record }) => {\n *     const [moveAsNthChildOf, { isPending, error }] = useMoveAsNthSiblingOf();\n *     const handleClick = () => {\n *         moveAsNthChildOf('nodes', { id: record.id }, record)\n *     }\n *     if (error) { return <p>ERROR</p>; }\n *     return <button disabled={isPending} onClick={handleClick}>Delete</div>;\n * };\n *\n * @example // set params when calling the hook\n *\n * import { useMoveAsNthSiblingOf } from '@react-admin/ra-tree';\n *\n * const DeleteButton = ({ record }) => {\n *     const [moveAsNthChildOf, { isPending, error }] = useMoveAsNthSiblingOf('nodes', { id: record.id }, record);\n *     if (error) { return <p>ERROR</p>; }\n *     return <button disabled={isPending} onClick={() => moveAsNthChildOf()}>Delete</button>;\n * };\n *\n * @example // TypeScript\n * const [delete, { data }] = useMoveAsNthSiblingOf<Product>('products', { id, previousData: product });\n *                    \\-- data is Product\n */\nexport var useMoveAsNthSiblingOf = function (resource, params, options) {\n    if (params === void 0) { params = {\n        source: undefined,\n        destination: undefined,\n        position: undefined,\n        meta: undefined,\n    }; }\n    if (options === void 0) { options = {}; }\n    var dataProvider = useDataProvider();\n    var queryClient = useQueryClient();\n    var source = params.source, destination = params.destination, position = params.position;\n    var _a = options.mutationMode, mutationMode = _a === void 0 ? 'undoable' : _a, reactMutationOptions = __rest(options, [\"mutationMode\"]);\n    var mode = useRef(mutationMode);\n    var paramsRef = useRef(params);\n    var snapshot = useRef([]);\n    var updateCache = function (_a) {\n        var resource = _a.resource, position = _a.position, source = _a.source, destination = _a.destination;\n        // hack: only way to tell react-query not to fetch this query for the next 5 seconds\n        // because setQueryData doesn't accept a stale time option\n        var now = Date.now();\n        var updatedAt = mode.current === 'undoable' ? now + 5 * 1000 : now;\n        var updateCollection = function (old) {\n            var _a, _b, _c, _d, _e;\n            var newRecords = cloneDeep(old);\n            var oldParent = newRecords.find(function (record) { var _a; return (_a = record.children) === null || _a === void 0 ? void 0 : _a.includes(source.id); });\n            var newParent = newRecords.find(function (record) { var _a; return (_a = record.children) === null || _a === void 0 ? void 0 : _a.includes(destination.id); });\n            // if source and dest come from the same parent, and if the source was moved to a lower position,\n            // the final position will be position - 1\n            var finalPosition = position;\n            if (oldParent &&\n                newParent &&\n                oldParent.id === newParent.id &&\n                oldParent.children &&\n                oldParent.children.findIndex(function (child) { return child === source.id; }) <\n                    oldParent.children.findIndex(function (child) { return child === destination.id; })) {\n                finalPosition = position - 1;\n            }\n            var optimisticFinalPosition = finalPosition < 0 ? 0 : finalPosition;\n            if (oldParent) {\n                // Remove the node from its old parent\n                oldParent.children = (_a = oldParent.children) === null || _a === void 0 ? void 0 : _a.filter(function (child) { return child !== source.id; });\n            }\n            else {\n                // It's a root node\n                newRecords = newRecords.filter(function (record) { return record.id !== source.id; });\n            }\n            // Add the node to its new parent at correct position\n            if (newParent) {\n                newParent.children = __spreadArray(__spreadArray(__spreadArray([], ((_c = (_b = newParent.children) === null || _b === void 0 ? void 0 : _b.slice(0, optimisticFinalPosition)) !== null && _c !== void 0 ? _c : []), true), [\n                    source.id\n                ], false), ((_e = (_d = newParent.children) === null || _d === void 0 ? void 0 : _d.slice(optimisticFinalPosition)) !== null && _e !== void 0 ? _e : []), true);\n            }\n            else {\n                // It's a root node\n                newRecords = newRecords.filter(function (record) { return record.id !== source.id; });\n                newRecords = __spreadArray(__spreadArray(__spreadArray([], newRecords.slice(0, optimisticFinalPosition), true), [\n                    source\n                ], false), newRecords.slice(optimisticFinalPosition), true);\n            }\n            return newRecords;\n        };\n        queryClient.setQueriesData({\n            queryKey: [resource, 'getTree'],\n        }, function (res) {\n            return res && res.length > 0 ? updateCollection(res) : res;\n        }, { updatedAt: updatedAt });\n        queryClient.setQueriesData({\n            queryKey: [resource, 'getRootNodes'],\n        }, function (res) {\n            return res && res.length > 0 ? updateCollection(res) : res;\n        }, { updatedAt: updatedAt });\n        queryClient.setQueriesData({\n            queryKey: [resource, 'getChildNodes'],\n        }, function (res) {\n            return res && res.length > 0 ? updateCollection(res) : res;\n        }, { updatedAt: updatedAt });\n    };\n    var mutation = useMutation(__assign(__assign({ mutationFn: function (_a) {\n            var _b = _a === void 0 ? {} : _a, _c = _b.resource, callTimeResource = _c === void 0 ? resource : _c, _d = _b.position, callTimePosition = _d === void 0 ? paramsRef.current.position : _d, _e = _b.source, callTimeSource = _e === void 0 ? paramsRef.current.source : _e, _f = _b.destination, callTimeDestination = _f === void 0 ? paramsRef.current.destination : _f, _g = _b.meta, callTimeMeta = _g === void 0 ? paramsRef.current.meta : _g;\n            if (callTimeResource == null) {\n                throw new Error('useMoveAsNthSiblingOf mutation requires a non-empty resource');\n            }\n            if (callTimePosition == null) {\n                throw new Error('useMoveAsNthSiblingOf mutation requires a non-empty position');\n            }\n            if (callTimeSource == null) {\n                throw new Error('useMoveAsNthSiblingOf mutation requires a non-empty source');\n            }\n            if (callTimeDestination == null) {\n                throw new Error('useMoveAsNthSiblingOf mutation requires a non-empty destination');\n            }\n            return dataProvider\n                .moveAsNthSiblingOf(callTimeResource, {\n                position: callTimePosition,\n                source: callTimeSource,\n                destination: callTimeDestination,\n                meta: callTimeMeta,\n            })\n                .then(function (_a) {\n                var data = _a.data;\n                return data;\n            });\n        } }, reactMutationOptions), { onMutate: function (variables) { return __awaiter(void 0, void 0, void 0, function () {\n            var userContext;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!reactMutationOptions.onMutate) return [3 /*break*/, 2];\n                        return [4 /*yield*/, reactMutationOptions.onMutate(variables)];\n                    case 1:\n                        userContext = (_a.sent()) || {};\n                        return [2 /*return*/, __assign({ snapshot: snapshot.current }, userContext)];\n                    case 2: \n                    // Return a context object with the snapshot value\n                    return [2 /*return*/, { snapshot: snapshot.current }];\n                }\n            });\n        }); }, onError: function (error, variables, context) {\n            if (mode.current === 'optimistic' || mode.current === 'undoable') {\n                // If the mutation fails, use the context returned from onMutate to rollback\n                context.snapshot.forEach(function (_a) {\n                    var key = _a[0], value = _a[1];\n                    queryClient.setQueryData(key, value);\n                });\n            }\n            if (reactMutationOptions.onError) {\n                return reactMutationOptions.onError(error, variables, context);\n            }\n            // call-time error callback is executed by react-query\n        }, onSettled: function (data, error, variables, context) {\n            if (variables === void 0) { variables = {}; }\n            // Moving a node might have updated other nodes, so we need to invalidate the cache in all cases\n            var _a = variables.resource, callTimeResource = _a === void 0 ? resource : _a;\n            queryClient.invalidateQueries({\n                queryKey: [callTimeResource, 'getTree'],\n            });\n            queryClient.invalidateQueries({\n                queryKey: [callTimeResource, 'getRootNodes'],\n            });\n            queryClient.invalidateQueries({\n                queryKey: [callTimeResource, 'getChildNodes'],\n            });\n            if (reactMutationOptions.onSettled) {\n                return reactMutationOptions.onSettled(data, error, variables, context);\n            }\n        } }));\n    var mutate = function () {\n        var args_1 = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args_1[_i] = arguments[_i];\n        }\n        return __awaiter(void 0, __spreadArray([], args_1, true), void 0, function (callTimeResource, callTimeParams, callTimeOptions) {\n            var mutationMode, onSuccess, onSettled, onError, _a, callTimePosition, _b, callTimeSource, _c, callTimeDestination, queryKeys;\n            if (callTimeResource === void 0) { callTimeResource = resource; }\n            if (callTimeParams === void 0) { callTimeParams = {}; }\n            if (callTimeOptions === void 0) { callTimeOptions = {}; }\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0:\n                        mutationMode = callTimeOptions.mutationMode, onSuccess = callTimeOptions.onSuccess, onSettled = callTimeOptions.onSettled, onError = callTimeOptions.onError;\n                        // store the hook time params *at the moment of the call*\n                        // because they may change afterwards, which would break the undoable mode\n                        // as the previousData would be overwritten by the optimistic update\n                        paramsRef.current = params;\n                        if (mutationMode) {\n                            mode.current = mutationMode;\n                        }\n                        if (mode.current === 'pessimistic') {\n                            return [2 /*return*/, mutation.mutate(__assign({ resource: callTimeResource }, callTimeParams), { onSuccess: onSuccess, onSettled: onSettled, onError: onError })];\n                        }\n                        _a = callTimeParams.position, callTimePosition = _a === void 0 ? position : _a, _b = callTimeParams.source, callTimeSource = _b === void 0 ? source : _b, _c = callTimeParams.destination, callTimeDestination = _c === void 0 ? destination : _c;\n                        if (callTimeResource == null) {\n                            throw new Error('useMoveAsNthSiblingOf mutation requires a non-empty resource');\n                        }\n                        if (callTimePosition == null) {\n                            throw new Error('useMoveAsNthSiblingOf mutation requires a non-empty position');\n                        }\n                        if (callTimeSource == null) {\n                            throw new Error('useMoveAsNthSiblingOf mutation requires a non-empty source');\n                        }\n                        if (callTimeDestination == null) {\n                            throw new Error('useMoveAsNthSiblingOf mutation requires a non-empty destination');\n                        }\n                        queryKeys = [\n                            [callTimeResource, 'getTree'],\n                            [callTimeResource, 'getRootNodes'],\n                            [callTimeResource, 'getChildNodes'],\n                        ];\n                        /**\n                         * Snapshot the previous values via queryClient.getQueriesData()\n                         *\n                         * The snapshotData ref will contain an array of tuples [query key, associated data]\n                         *\n                         * @example\n                         * [\n                         *   [['posts', 'getList'], { data: [{ id: 1, title: 'Hello' }], total: 1 }],\n                         *   [['posts', 'getMany'], [{ id: 1, title: 'Hello' }]],\n                         * ]\n                         *\n                         * @see https://react-query.tanstack.com/reference/QueryClient#queryclientgetqueriesdata\n                         */\n                        snapshot.current = queryKeys.reduce(function (prev, curr) {\n                            return prev.concat(queryClient.getQueriesData({ queryKey: curr }));\n                        }, []);\n                        // Cancel any outgoing re-fetches (so they don't overwrite our optimistic update)\n                        return [4 /*yield*/, Promise.all(snapshot.current.map(function (_a) {\n                                var key = _a[0];\n                                return queryClient.cancelQueries({ queryKey: key });\n                            }))];\n                    case 1:\n                        // Cancel any outgoing re-fetches (so they don't overwrite our optimistic update)\n                        _d.sent();\n                        // Optimistically update to the new value\n                        updateCache({\n                            resource: callTimeResource,\n                            position: callTimePosition,\n                            source: callTimeSource,\n                            destination: callTimeDestination,\n                        });\n                        // run the success callbacks during the next tick\n                        if (onSuccess) {\n                            setTimeout(function () {\n                                return onSuccess(undefined, __assign({ resource: callTimeResource }, callTimeParams), { snapshot: snapshot.current });\n                            }, 0);\n                        }\n                        if (reactMutationOptions.onSuccess) {\n                            setTimeout(function () {\n                                if (reactMutationOptions.onSuccess) {\n                                    reactMutationOptions.onSuccess(undefined, __assign({ resource: callTimeResource }, callTimeParams), { snapshot: snapshot.current });\n                                }\n                            }, 0);\n                        }\n                        if (mode.current === 'optimistic') {\n                            // call the mutate method without success side effects\n                            return [2 /*return*/, mutation.mutate(__assign({ resource: callTimeResource }, callTimeParams), { onSettled: onSettled, onError: onError })];\n                        }\n                        else {\n                            // undoable mutation: register the mutation for later\n                            undoableEventEmitter.once('end', function (_a) {\n                                var isUndo = _a.isUndo;\n                                if (isUndo) {\n                                    // rollback\n                                    snapshot.current.forEach(function (_a) {\n                                        var key = _a[0], value = _a[1];\n                                        queryClient.setQueryData(key, value);\n                                    });\n                                }\n                                else {\n                                    // call the mutate method without success side effects\n                                    mutation.mutate(__assign({ resource: callTimeResource }, callTimeParams), { onSettled: onSettled, onError: onError });\n                                }\n                            });\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return [mutate, mutation];\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/**\n * Helper method to workaround the inability of FakeRest to filter by null values\n * @param dataProvider the base dataProvider\n * @returns a dataProvider with a patched `getRootNodes` method, that will only keep nodes where `node.parent_id === 'undefined'`\n */\nexport var fixFakeRestDataProvider = function (dataProvider) { return (__assign(__assign({}, dataProvider), { getRootNodes: function (resource, params) { return __awaiter(void 0, void 0, void 0, function () {\n        var data, filteredNodes;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, dataProvider.getRootNodes(resource, params)];\n                case 1:\n                    data = (_a.sent()).data;\n                    filteredNodes = data.filter(function (node) { return node.parent_id == null; });\n                    return [2 /*return*/, {\n                            data: filteredNodes,\n                            total: filteredNodes.length,\n                        }];\n            }\n        });\n    }); }, addRootNode: function (resource_1, _a) { return __awaiter(void 0, [resource_1, _a], void 0, function (resource, _b) {\n        var roots, filteredRoots, rootPosition, newRoot;\n        var data = _b.data, meta = _b.meta;\n        return __generator(this, function (_c) {\n            switch (_c.label) {\n                case 0: return [4 /*yield*/, dataProvider.getList(resource, {\n                        filter: { parent_id: null },\n                        sort: { field: 'position', order: 'ASC' },\n                        pagination: { page: 1, perPage: 1000 },\n                        meta: meta,\n                    })];\n                case 1:\n                    roots = (_c.sent()).data;\n                    filteredRoots = roots.filter(function (node) { return typeof node.parent_id === 'undefined'; });\n                    rootPosition = filteredRoots.length > 0\n                        ? filteredRoots.reduce(function (acc, curr) {\n                            return curr['position'] > acc ? curr['position'] : acc;\n                        }, -Infinity) + 1\n                        : 0;\n                    return [4 /*yield*/, dataProvider.create(resource, {\n                            data: __assign(__assign({}, data), { parent_id: null, position: rootPosition }),\n                            meta: meta,\n                        })];\n                case 2:\n                    newRoot = (_c.sent()).data;\n                    return [2 /*return*/, { data: __assign(__assign({}, newRoot), { children: [] }) }];\n            }\n        });\n    }); } })); };\n","var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nexport var removeNode = function (data, node) {\n    var _a;\n    var newNodes = data.filter(function (r) { return r.id !== node.id; });\n    var parentNode = newNodes.find(function (r) { var _a; return (_a = r.children) === null || _a === void 0 ? void 0 : _a.includes(node.id); });\n    if (parentNode) {\n        parentNode.children = (_a = parentNode.children) === null || _a === void 0 ? void 0 : _a.filter(function (id) { return id !== node.id; });\n    }\n    if (!node.children || node.children.length === 0) {\n        return newNodes;\n    }\n    var childrenIdsToRemove = getNodeChildrenRecursive(newNodes, node);\n    newNodes = newNodes.filter(function (r) { return !childrenIdsToRemove.includes(r); });\n    return newNodes;\n};\nvar getNodeChildrenRecursive = function (data, node) {\n    if (!node) {\n        return [];\n    }\n    if (!node.children || node.children.length === 0) {\n        return [];\n    }\n    return __spreadArray(__spreadArray([], node.children, true), node.children.flatMap(function (childId) {\n        var child = data.find(function (r) { return r.id === childId; });\n        if (!child) {\n            return [];\n        }\n        return getNodeChildrenRecursive(data, child);\n    }), true);\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { useCallback, useState, } from 'react';\nimport { useNotify, useRecordContext, useRedirect, useRefresh, useResourceContext, } from 'react-admin';\nimport { useDeleteBranch } from '../dataProvider';\nimport { useTreeContext } from './useTreeContext';\nimport { removeNode } from '../util/removeNode';\n/**\n * Prepare a set of callbacks for a delete branch button guarded by confirmation dialog\n *\n * @example\n *\n * const DeleteBranchButton = ({\n *     resource,\n *     record,\n *     redirect,\n *     onClick,\n *     ...rest\n * }) => {\n *     const {\n *         open,\n *         isPending,\n *         handleDialogOpen,\n *         handleDialogClose,\n *         handleDelete,\n *     } = useDeleteBranchWithConfirmController({\n *         resource,\n *         record,\n *         redirect,\n *         onClick,\n *     });\n *\n *     return (\n *         <Fragment>\n *             <Button\n *                 onClick={handleDialogOpen}\n *                 label=\"ra.action.delete\"\n *                 {...rest}\n *             >\n *                 {icon}\n *             </Button>\n *             <Confirm\n *                 isOpen={open}\n *                 loading={isPending}\n *                 title=\"ra.message.delete_title\"\n *                 content=\"ra.message.delete_content\"\n *                 translateOptions={{\n *                     name: resource,\n *                     id: record.id,\n *                 }}\n *                 onConfirm={handleDelete}\n *                 onClose={handleDialogClose}\n *             />\n *         </Fragment>\n *     );\n * };\n */\nexport var useDeleteBranchWithConfirmController = function (props) {\n    var mutationMode = props.mutationMode, mutationOptions = props.mutationOptions, _a = props.redirect, redirectTo = _a === void 0 ? 'list' : _a;\n    var notify = useNotify();\n    var redirect = useRedirect();\n    var refresh = useRefresh();\n    var resource = useResourceContext(props);\n    if (resource == null) {\n        throw new Error('The useDeleteBranchWithConfirmController hook must be used inside a ResourceContext or must be passed a resource prop.');\n    }\n    var record = useRecordContext(props);\n    if (record == null) {\n        throw new Error('The useDeleteBranchWithConfirmController hook must be used inside a RecordContext or must be passed a record prop.');\n    }\n    var _b = useDeleteBranch(), deleteBranch = _b[0], isPending = _b[1].isPending;\n    var _c = useState(false), open = _c[0], setOpen = _c[1];\n    var setFinalData = useTreeContext().setFinalData;\n    var handleDelete = useCallback(function (event) {\n        event.stopPropagation();\n        deleteBranch(resource, {\n            id: record.id,\n            previousData: record,\n        }, __assign({ mutationMode: mutationMode, onSuccess: function () {\n                notify('ra.notification.deleted', {\n                    type: 'info',\n                    messageArgs: { smart_count: 1 },\n                });\n                redirect(redirectTo, resource);\n                if (mutationMode === 'pessimistic') {\n                    refresh();\n                }\n                else {\n                    setFinalData &&\n                        setFinalData(function (previous) {\n                            return removeNode(previous, record);\n                        });\n                }\n            }, onError: function (error) {\n                notify(typeof error === 'string'\n                    ? error\n                    : error.message || 'ra.notification.http_error', { type: 'warning' });\n            } }, mutationOptions));\n    }, [\n        deleteBranch,\n        mutationMode,\n        mutationOptions,\n        notify,\n        record,\n        redirect,\n        redirectTo,\n        refresh,\n        resource,\n        setFinalData,\n    ]);\n    var handleDialogOpen = function (e) {\n        e.stopPropagation();\n        setOpen(true);\n    };\n    var handleDialogClose = function (e) {\n        e.stopPropagation();\n        setOpen(false);\n    };\n    return {\n        handleDelete: handleDelete,\n        handleDialogOpen: handleDialogOpen,\n        handleDialogClose: handleDialogClose,\n        isPending: isPending,\n        open: open,\n    };\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { useCallback } from 'react';\nimport { useNotify, useRecordContext, useRedirect, useResourceContext, } from 'react-admin';\nimport { useDeleteBranch } from '../dataProvider';\nimport { useTreeContext } from './useTreeContext';\nimport { removeNode } from '../util/removeNode';\n/**\n * Prepare callback for a delete branch button with undo support\n *\n * @example\n *\n * import React from 'react';\n * import ActionDelete from '@material-ui/icons/Delete';\n * import { Button, useDeleteBranchWithUndoController } from '@react-admin/ra-tree';\n *\n * const DeleteButton = ({\n *     resource,\n *     record,\n *     basePath,\n *     redirect,\n *     onClick,\n *     ...rest\n * }) => {\n *     const [handleDelete, { isPending }] = useDeleteBranchWithUndoController({\n *         resource,\n *         record,\n *         redirect,\n *     });\n *\n *     const handleClick = () => {\n *         handleDelete();\n *     }\n *\n *     return (\n *         <Button\n *             onClick={handleClick}\n *             disabled={isPending}\n *             label=\"ra.action.delete\"\n *             {...rest}\n *         >\n *             <ActionDelete />\n *         </Button>\n *     );\n * };\n */\nexport var useDeleteBranchWithUndoController = function (props) {\n    var mutationOptions = props.mutationOptions, _a = props.redirect, redirectTo = _a === void 0 ? 'list' : _a;\n    var notify = useNotify();\n    var redirect = useRedirect();\n    var setFinalData = useTreeContext().setFinalData;\n    var resource = useResourceContext(props);\n    if (resource == null) {\n        throw new Error('The useDeleteBranchWithUndoController hook must be used inside a ResourceContext or must be passed a resource prop.');\n    }\n    var record = useRecordContext(props);\n    if (record == null) {\n        throw new Error('The useDeleteBranchWithUndoController hook must be used inside a RecordContext or must be passed a record prop.');\n    }\n    var _b = useDeleteBranch(), deleteBranch = _b[0], isPending = _b[1].isPending;\n    var handleDelete = useCallback(function (event) {\n        event.stopPropagation();\n        deleteBranch(resource, {\n            id: record.id,\n            previousData: record,\n        }, __assign({ onSuccess: function () {\n                notify('ra.notification.deleted', {\n                    type: 'info',\n                    messageArgs: { smart_count: 1 },\n                    undoable: true,\n                });\n                if (setFinalData) {\n                    setFinalData(function (previous) {\n                        return removeNode(previous, record);\n                    });\n                }\n                redirect(redirectTo, resource);\n            }, onError: function (error) {\n                return notify(typeof error === 'string'\n                    ? error\n                    : error.message || 'ra.notification.http_error', { type: 'warning' });\n            }, mutationMode: 'undoable' }, mutationOptions));\n    }, [\n        deleteBranch,\n        mutationOptions,\n        notify,\n        record,\n        redirect,\n        redirectTo,\n        resource,\n        setFinalData,\n    ]);\n    return { handleDelete: handleDelete, isPending: isPending };\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { useEffect, useCallback } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { HttpError, useAuthenticated, useEvent, useGetResourceLabel, useNotify, useRedirect, useResourceContext, useResourceDefinition, useTranslate, } from 'react-admin';\nimport { useQueryClient } from '@tanstack/react-query';\nimport { useAddRootNode, useAddChildNode } from '../dataProvider';\nimport { useTreeContext } from './useTreeContext';\n/**\n * Prepare data for the Create view\n *\n * @param {Object} props The props passed to the Create component.\n *\n * @return {Object} controllerProps Fetched data and callbacks for the Create view\n *\n * @example\n *\n * import { CreateView } from 'react-admin';\n * import { useCreateNodeController } from '@react-admin/ra-tree';\n *\n * const MyCreateNode = props => {\n *     const controllerProps = useCreateNodeController(props);\n *     return <CreateView {...controllerProps} {...props} />;\n * }\n */\nexport var useCreateNodeController = function (props) {\n    var disableAuthentication = props.disableAuthentication, _a = props.record, record = _a === void 0 ? {} : _a, redirectTo = props.redirect, _b = props.mutationOptions, mutationOptions = _b === void 0 ? {} : _b, transform = props.transform;\n    useAuthenticated({ enabled: !disableAuthentication });\n    var resource = useResourceContext(props);\n    if (resource == null) {\n        throw new Error('The useCreateNodeController hook must be used inside a ResourceContext or must be passed a resource prop.');\n    }\n    var getResourceLabel = useGetResourceLabel();\n    var queryClient = useQueryClient();\n    var location = useLocation();\n    var handleAddNode = useTreeContext().handleAddNode;\n    var parentId = location.state && location.state.parentId;\n    var insertAsFirstChild = location.state &&\n        location.state.insertAsFirstChild;\n    var isChild = typeof parentId !== 'undefined' && parentId !== null;\n    var recordToUse = (location.state && location.state.record) ||\n        record;\n    var onSuccess = mutationOptions.onSuccess, onError = mutationOptions.onError, otherMutationOptions = __rest(mutationOptions, [\"onSuccess\", \"onError\"]);\n    var _c = useResourceDefinition(props), hasEdit = _c.hasEdit, hasShow = _c.hasShow;\n    var finalRedirectTo = redirectTo || getDefaultRedirectRoute(hasShow, hasEdit);\n    var _d = useAddRootNode(resource, undefined, otherMutationOptions), createRoot = _d[0], createRootState = _d[1];\n    var _e = useAddChildNode(resource, undefined, otherMutationOptions), createChild = _e[0], createChildState = _e[1];\n    var handleAddNodeEvent = useEvent(handleAddNode !== null && handleAddNode !== void 0 ? handleAddNode : noop);\n    // show a local new node in the tree on mount, remove it on unmount\n    useEffect(function () {\n        handleAddNodeEvent({\n            record: {},\n            parentId: parentId,\n            insertAsFirstChild: insertAsFirstChild,\n        });\n        return function () {\n            handleAddNodeEvent(undefined);\n        };\n    }, [handleAddNodeEvent, parentId, insertAsFirstChild]);\n    var translate = useTranslate();\n    var notify = useNotify();\n    var redirect = useRedirect();\n    var save = useCallback(function (data, _a) {\n        var _b = _a === void 0 ? {} : _a, onSuccessFromSave = _b.onSuccess, onErrorFromSave = _b.onError, transformFromSave = _b.transform;\n        var defaultOnSuccess = function (newNode) {\n            notify('ra.notification.created', {\n                type: 'info',\n                messageArgs: {\n                    smart_count: 1,\n                },\n            });\n            redirect(finalRedirectTo, resource, newNode.id, newNode);\n            queryClient.refetchQueries({\n                queryKey: [resource, 'getTree'],\n                type: 'active',\n            });\n            queryClient.refetchQueries({\n                queryKey: [resource, 'getRootNodes'],\n                type: 'active',\n            });\n        };\n        var defaultOnError = function (error) {\n            notify(typeof error === 'string'\n                ? error\n                : error.message || 'ra.notification.http_error', { type: 'error' });\n        };\n        return Promise.resolve(transformFromSave\n            ? transformFromSave(data)\n            : transform\n                ? transform(data)\n                : data).then(function (data) { return __awaiter(void 0, void 0, void 0, function () {\n            var options, error_1;\n            var _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        options = {\n                            onSuccess: function (data, variables, context) {\n                                handleAddNodeEvent(undefined);\n                                onSuccessFromSave\n                                    ? onSuccessFromSave(data, variables, context)\n                                    : onSuccess\n                                        ? onSuccess(data, variables, context)\n                                        : defaultOnSuccess(data);\n                            },\n                            onError: onErrorFromSave\n                                ? onErrorFromSave\n                                : onError\n                                    ? onError\n                                    : defaultOnError,\n                        };\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 6, , 7]);\n                        if (!isChild) return [3 /*break*/, 3];\n                        return [4 /*yield*/, createChild(resource, {\n                                data: data,\n                                parentId: parentId,\n                                meta: otherMutationOptions.meta,\n                                position: insertAsFirstChild ? 0 : undefined,\n                            }, __assign(__assign({}, options), { returnPromise: true }))];\n                    case 2:\n                        _b.sent();\n                        return [3 /*break*/, 5];\n                    case 3: return [4 /*yield*/, createRoot(resource, { data: data, meta: otherMutationOptions.meta }, __assign(__assign({}, options), { returnPromise: true }))];\n                    case 4:\n                        _b.sent();\n                        _b.label = 5;\n                    case 5: return [3 /*break*/, 7];\n                    case 6:\n                        error_1 = _b.sent();\n                        if ((error_1 instanceof HttpError ||\n                            (typeof error_1 === 'object' &&\n                                error_1 !== null &&\n                                error_1.hasOwnProperty('body'))) &&\n                            ((_a = error_1.body) === null || _a === void 0 ? void 0 : _a.errors) != null) {\n                            return [2 /*return*/, error_1.body.errors];\n                        }\n                        return [3 /*break*/, 7];\n                    case 7: return [2 /*return*/];\n                }\n            });\n        }); });\n    }, [\n        createChild,\n        createRoot,\n        handleAddNodeEvent,\n        isChild,\n        notify,\n        onError,\n        onSuccess,\n        parentId,\n        queryClient,\n        redirect,\n        resource,\n        transform,\n        otherMutationOptions.meta,\n        finalRedirectTo,\n        insertAsFirstChild,\n    ]);\n    var resourceName = getResourceLabel(resource, 1);\n    var defaultTitle = translate('ra.page.create', {\n        name: \"\".concat(resourceName),\n    });\n    return {\n        isLoading: false,\n        isFetching: false,\n        defaultTitle: defaultTitle,\n        save: save,\n        saving: createRootState.isPending || createChildState.isPending,\n        isPending: createRootState.isPending || createChildState.isPending,\n        resource: resource,\n        record: recordToUse,\n        redirect: finalRedirectTo,\n    };\n};\nvar getDefaultRedirectRoute = function (hasShow, hasEdit) {\n    if (hasEdit) {\n        return 'edit';\n    }\n    if (hasShow) {\n        return 'show';\n    }\n    return 'list';\n};\nvar noop = function () {\n    /* */\n};\n","var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nexport var getNodeIdsRecursively = function (nodeKey, allNodes) {\n    var node = allNodes.find(function (node) { return node.id == nodeKey; });\n    if (!node)\n        return [];\n    return __spreadArray([\n        node.id\n    ], (node.children || []).flatMap(function (key) {\n        return getNodeIdsRecursively(key, allNodes);\n    }), true);\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { useEffect, useMemo, useState } from 'react';\nimport { useGetResourceLabel, useTranslate, useResourceContext, useNotify, useEvent, } from 'react-admin';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { useGetChildNodesCallback, useGetRootNodes, useGetTree, useGetTreeCallback, useMoveAsNthChildOf, useMoveAsNthSiblingOf, } from '../dataProvider';\nimport { useExpandedKeys } from '../util';\nimport { UNSAVED_NEW_NODE } from '../constants';\nimport { getNodeIdsRecursively } from './getNodesIdsRecursively';\nexport var useTreeController = function (options) {\n    var translate = useTranslate();\n    var resource = useResourceContext(options);\n    if (resource == null) {\n        throw new Error('The useTreeController hook must be used inside a ResourceContext or must be passed a resource prop.');\n    }\n    var getResourceLabel = useGetResourceLabel();\n    var _a = options.lazy, lazy = _a === void 0 ? false : _a, _b = options.filter, filter = _b === void 0 ? {} : _b, _c = options.mutationMode, mutationMode = _c === void 0 ? 'undoable' : _c, meta = options.meta;\n    // load entire tree on mount if lazy loading is not enabled\n    var treeState = useGetTree(resource, { filter: filter, meta: meta }, {\n        enabled: !lazy,\n    });\n    // load only the root nodes on mount if lazy loading is enabled\n    var rootNodesState = useGetRootNodes(resource, { filter: filter, meta: meta }, {\n        enabled: lazy,\n        // FIXME - workaround for issues when loading the tree a second time\n        // (e.g. when switching from a resource to another and back)\n        gcTime: 0,\n    });\n    var innerLoadChildNodes = useGetChildNodesCallback(resource, {\n        meta: meta,\n    });\n    // remove the children in lazy mode, otherwise rc-tree won't offer to load them\n    var lazyDataWithoutChildren = useMemo(function () {\n        var _a;\n        return (_a = rootNodesState.data) === null || _a === void 0 ? void 0 : _a.map(function (record) {\n            var children = record.children, rest = __rest(record, [\"children\"]);\n            return (children === null || children === void 0 ? void 0 : children.length) ? rest : record;\n        });\n    }, \n    // FIXME: Force a recompute when the root nodes are being fetched to avoid issues with new nodes in lazy mode\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [rootNodesState.data, rootNodesState.isFetching]);\n    var _d = lazy\n        ? __assign(__assign({}, rootNodesState), { data: lazyDataWithoutChildren }) : treeState, data = _d.data, error = _d.error, isLoading = _d.isLoading, isPending = _d.isPending, isFetching = _d.isFetching;\n    var _e = useState(data), finalData = _e[0], setFinalData = _e[1];\n    var loadChildNodes = useEvent(function (parentId) { return __awaiter(void 0, void 0, void 0, function () {\n        var records;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, innerLoadChildNodes(parentId)];\n                case 1:\n                    records = _a.sent();\n                    setFinalData(function (previous) {\n                        var _a;\n                        // remove the children in lazy mode, otherwise rc-tree won't offer to load them\n                        var recordsWithoutChildren = records.map(function (record) {\n                            var children = record.children, rest = __rest(record, [\"children\"]);\n                            var childrenAreLoaded = previous === null || previous === void 0 ? void 0 : previous.some(function (node) { var _a; return (_a = record.children) === null || _a === void 0 ? void 0 : _a.includes(node.id); });\n                            return (children === null || children === void 0 ? void 0 : children.length) && !childrenAreLoaded ? rest : record;\n                        });\n                        var updated = __spreadArray(__spreadArray([], ((_a = previous === null || previous === void 0 ? void 0 : previous.map(function (node) {\n                            if (node.id === parentId) {\n                                return __assign(__assign({}, node), { \n                                    // now we can set the children for rc-tree\n                                    children: recordsWithoutChildren.map(function (record) { return record.id; }) });\n                            }\n                            return node;\n                        })) !== null && _a !== void 0 ? _a : []), true), recordsWithoutChildren, true);\n                        // If loadChildNodes is called multiple times on the same node,\n                        // we need to make sure we don't duplicate the children in the tree.\n                        // So we search for duplicates and only keep the last instance.\n                        var updatedAsMap = updated.reduce(function (acc, curr) {\n                            acc[curr.id] = curr;\n                            return acc;\n                        }, {});\n                        return Object.values(updatedAsMap);\n                    });\n                    return [2 /*return*/];\n            }\n        });\n    }); });\n    useEffect(function () {\n        setFinalData(data);\n    }, [data]);\n    // Node creation support\n    var _f = useState(), newNode = _f[0], setNewNode = _f[1];\n    var handleAddNode = useEvent(function (nodeToCreate) {\n        var _a;\n        var newNodes = cloneDeep(finalData);\n        if (nodeToCreate) {\n            setNewNode(nodeToCreate);\n            if (nodeToCreate.parentId != null) {\n                var parentNode = newNodes === null || newNodes === void 0 ? void 0 : newNodes.find(function (node) { return node.id === nodeToCreate.parentId; });\n                if (parentNode) {\n                    parentNode.children = parentNode.children || [];\n                    parentNode.children = nodeToCreate.insertAsFirstChild\n                        ? __spreadArray([UNSAVED_NEW_NODE], parentNode.children, true) : __spreadArray(__spreadArray([], parentNode.children, true), [UNSAVED_NEW_NODE], false);\n                }\n            }\n            setFinalData(__spreadArray(__spreadArray([], (newNodes !== null && newNodes !== void 0 ? newNodes : []), true), [\n                // @ts-ignore\n                __assign({ id: UNSAVED_NEW_NODE, children: [] }, nodeToCreate.record),\n            ], false));\n        }\n        else {\n            if (!newNode)\n                return;\n            var newNodes_1 = cloneDeep(finalData);\n            if (newNode.parentId != null) {\n                var parentNode = newNodes_1 === null || newNodes_1 === void 0 ? void 0 : newNodes_1.find(function (node) { return node.id === newNode.parentId; });\n                if (parentNode) {\n                    parentNode.children = (_a = parentNode.children) === null || _a === void 0 ? void 0 : _a.filter(function (node) { return node != UNSAVED_NEW_NODE; });\n                }\n            }\n            setNewNode(undefined);\n            setFinalData(newNodes_1 === null || newNodes_1 === void 0 ? void 0 : newNodes_1.filter(function (record) { return record.id !== UNSAVED_NEW_NODE; }));\n        }\n    });\n    var _g = useExpandedKeys(undefined, options.expandedKeys), expandedKeys = _g[0], setExpandedKeys = _g[1];\n    var handleExpand = useEvent(function (value) {\n        setExpandedKeys(function (previousValue) {\n            var _a, _b;\n            var newValue = typeof value === 'function'\n                ? value(previousValue !== null && previousValue !== void 0 ? previousValue : [])\n                : value;\n            var closedNodes = (_a = previousValue === null || previousValue === void 0 ? void 0 : previousValue.filter(function (key) { return !newValue.includes(key); })) !== null && _a !== void 0 ? _a : [];\n            var allClosedNodes = (_b = closedNodes === null || closedNodes === void 0 ? void 0 : closedNodes.flatMap(function (nodeKey) {\n                return getNodeIdsRecursively(nodeKey, finalData !== null && finalData !== void 0 ? finalData : []);\n            }, [])) !== null && _b !== void 0 ? _b : [];\n            return newValue.filter(function (key) { return !allClosedNodes.includes(key); });\n        });\n    });\n    // prepare hooks for drag and drop\n    var moveAsNthChildOf = useMoveAsNthChildOf(resource, { meta: meta })[0];\n    var moveAsNthSiblingOf = useMoveAsNthSiblingOf(resource, { meta: meta })[0];\n    var refreshTree = useGetTreeCallback(resource);\n    var notify = useNotify();\n    /**\n     * Call dataProvider.moveXXX() method on drop.\n     *\n     * Heavily inspired by https://github.com/react-component/tree/blob/master/examples/draggable.jsx\n     *\n     * @see https://github.com/react-component/tree/blob/master/examples/draggable.jsx\n     */\n    var handleDrop = useEvent(function (_a) {\n        var type = _a.type, data = __rest(_a, [\"type\"]);\n        // refresh tree on success\n        var successSideEffect = function () { return __awaiter(void 0, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, refreshTree()];\n                    case 1:\n                        _a.sent();\n                        notify('ra-tree.item_moved', {\n                            undoable: mutationMode === 'undoable',\n                        });\n                        return [2 /*return*/];\n                }\n            });\n        }); };\n        var errorSideEffect = function (error) { return __awaiter(void 0, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                notify(error.message, {\n                    type: 'error',\n                });\n                return [2 /*return*/];\n            });\n        }); };\n        if (type === 'child') {\n            // Drop on a node\n            // move dragObject as first child of targetObject\n            moveAsNthChildOf(resource, data, {\n                // TODO: allow setting mutationOptions\n                onSuccess: successSideEffect,\n                onError: errorSideEffect,\n                mutationMode: mutationMode,\n            });\n        }\n        else {\n            // drop between nodes\n            // move dragObject to sibling targetPosition of targetObject\n            moveAsNthSiblingOf(resource, data, {\n                // TODO: allow setting mutationOptions\n                onSuccess: successSideEffect,\n                onError: errorSideEffect,\n                mutationMode: mutationMode,\n            });\n        }\n    });\n    var defaultTitle = translate('ra.page.list', {\n        name: getResourceLabel(resource, 2),\n    });\n    return {\n        data: finalData,\n        defaultTitle: defaultTitle,\n        error: error,\n        expandedKeys: expandedKeys,\n        handleAddNode: handleAddNode,\n        handleDrop: handleDrop,\n        handleExpand: handleExpand,\n        isLoading: isLoading,\n        isFetching: isFetching,\n        // Because the tree is computed from our data, the isPending state must be controlled by us\n        // If tree is null, we have not yet built it from the data\n        isPending: isPending,\n        loadChildNodes: loadChildNodes,\n        newNode: newNode,\n        lazy: lazy,\n        setFinalData: setFinalData,\n    };\n};\n","import { createContext } from 'react';\nexport var TreeChoicesContext = createContext(undefined);\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { createElement as _createElement } from \"react\";\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nimport * as React from 'react';\nimport { Box, Chip, CircularProgress, FilledInput, FormControl, FormHelperText, Input, InputLabel, OutlinedInput, Popover, Stack, styled, } from '@mui/material';\nimport { visuallyHidden } from '@mui/utils';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport { FieldTitle, InputHelperText, useEvent, useGetRecordRepresentation, useResourceContext, useTranslate, } from 'react-admin';\nimport get from 'lodash/get';\nimport { useTreeInputController, } from './controllers/useTreeInputController';\nimport { Tree } from './Tree';\n/**\n * The `<TreeInput>` component allows to select one or several nodes from a tree. It expects a `data` prop in the format returned by `getTree`.\n *\n * @example\n * ```tsx\n * import { TreeInput } from '@react-admin/ra-tree';\n * import { SimpleForm } from 'react-admin';\n * import treeData from './treeData';\n *\n * export const SimpleTreeForm = () => (\n *     <SimpleForm>\n *         <TreeInput source=\"category\" data={treeData} />\n *     </SimpleForm>\n * );\n * ```\n */\nexport var TreeInput = function (props) {\n    var id = props.id, label = props.label, multiple = props.multiple, sx = props.sx, className = props.className, helperText = props.helperText, fullWidth = props.fullWidth, _a = props.margin, margin = _a === void 0 ? 'dense' : _a, _b = props.variant, variant = _b === void 0 ? 'filled' : _b, _c = props.size, size = _c === void 0 ? 'small' : _c, rest = __rest(props, [\"id\", \"label\", \"multiple\", \"sx\", \"className\", \"helperText\", \"fullWidth\", \"margin\", \"variant\", \"size\"]);\n    var _d = useTreeInputController(props), data = _d.data, resource = _d.resource, source = _d.source, fetchError = _d.fetchError, isLoading = _d.isLoading, isRequired = _d.isRequired, field = _d.field, fieldState = _d.fieldState, formState = _d.formState;\n    var translate = useTranslate();\n    var isTouched = fieldState.isTouched, invalid = fieldState.invalid, error = fieldState.error;\n    var isSubmitted = formState.isSubmitted;\n    var value = React.useMemo(function () { return (field === null || field === void 0 ? void 0 : field.value) || (multiple ? [] : ''); }, [field, multiple]);\n    var selectedRecords = React.useMemo(function () {\n        return data.filter(function (record) {\n            return multiple ? value.includes(record.id) : value === record.id;\n        });\n    }, [value, data, multiple]);\n    var InputComponent = {\n        standard: Input,\n        outlined: OutlinedInput,\n        filled: FilledInput,\n    }[variant];\n    if (fetchError) {\n        return (_jsxs(Root, { className: className, sx: sx, \"data-testid\": \"error\", variant: variant, size: size, margin: margin, error: true, children: [_jsx(InputLabel, { error: true, margin: margin === 'dense' ? margin : undefined, size: size === 'medium' ? 'normal' : size, variant: variant, children: _jsx(FieldTitle, { resource: resource, label: label, isRequired: isRequired, source: source }) }), _jsx(InputComponent, { inputComponent: TreeInputInput }), _jsx(FormHelperText, { error: true, children: _jsx(InputHelperText, { error: translate('ra-tree.treeSelectInput.fetchError', {\n                            _: 'Error fetching tree data',\n                        }), helperText: helperText }) })] }));\n    }\n    if (isLoading || !data) {\n        return (_jsxs(Root, { className: className, sx: sx, \"data-testid\": \"loading\", variant: variant, size: size, margin: margin, children: [_jsx(InputLabel, { margin: margin === 'dense' ? margin : undefined, size: size === 'medium' ? 'normal' : size, variant: variant, children: _jsx(FieldTitle, { resource: resource, label: label, isRequired: isRequired, source: source }) }), _jsx(InputComponent, { inputComponent: TreeInputInput, endAdornment: _jsx(CircularProgress, { color: \"inherit\", size: \"30px\" }) })] }));\n    }\n    return (_jsxs(Root, { className: className, sx: sx, variant: variant, size: size, margin: margin, children: [_jsx(InputLabel, { htmlFor: id !== null && id !== void 0 ? id : source, error: invalid, margin: margin === 'dense' ? margin : undefined, shrink: selectedRecords.length > 0, size: size === 'medium' ? 'normal' : size, variant: variant, children: _jsx(FieldTitle, { resource: resource, label: label, isRequired: isRequired, source: source }) }), _jsx(TreeInputTree, __assign({ source: source, multiple: multiple, className: TreeInputClasses.tree, field: field, fullWidth: fullWidth }, rest, { data: data, variant: variant, size: size, margin: margin, id: id !== null && id !== void 0 ? id : source })), !!((isTouched || isSubmitted) && !!error) || helperText ? (_jsx(FormHelperText, { error: (isTouched || isSubmitted) && !!error, children: _jsx(InputHelperText, { error: error === null || error === void 0 ? void 0 : error.message, helperText: helperText }) })) : null] }));\n};\nvar PREFIX = 'RaTreeInput';\nexport var TreeInputClasses = {\n    tree: \"\".concat(PREFIX, \"-tree\"),\n};\nvar Root = styled(FormControl, {\n    name: PREFIX,\n    overridesResolver: function (props, styles) { return styles.root; },\n})(function (_a) {\n    var theme = _a.theme;\n    return ({\n        '& .MuiInputBase-input': {\n            height: 'auto',\n            minHeight: '1.4375em',\n        },\n        '& .MuiChip-root': {\n            marginTop: theme.spacing(0.5),\n            marginRight: theme.spacing(0.5),\n        },\n    });\n});\nexport var TreeInputTree = function (props) {\n    var _a;\n    var className = props.className, data = props.data, multiple = props.multiple, field = props.field, _b = props.checkStrictly, checkStrictly = _b === void 0 ? true : _b, _c = props.expandAction, expandAction = _c === void 0 ? false : _c, titleField = props.titleField, _d = props.margin, margin = _d === void 0 ? 'dense' : _d, _e = props.variant, variant = _e === void 0 ? 'filled' : _e, _f = props.size, size = _f === void 0 ? 'small' : _f, label = props.label, isRequired = props.isRequired, source = props.source, id = props.id, sx = props.sx, rest = __rest(props, [\"className\", \"data\", \"multiple\", \"field\", \"checkStrictly\", \"expandAction\", \"titleField\", \"margin\", \"variant\", \"size\", \"label\", \"isRequired\", \"source\", \"id\", \"sx\"]);\n    var value = React.useMemo(function () { return (field === null || field === void 0 ? void 0 : field.value) || (multiple ? [] : ''); }, [field, multiple]);\n    var selectedRecords = React.useMemo(function () {\n        return data.filter(function (record) {\n            return multiple ? value.includes(record.id) : value === record.id;\n        });\n    }, [value, data, multiple]);\n    // Because the main form record is loaded asynchronously, we may have an undefined default value\n    // first which is updated later. However, the Tree component does not react to defaultSelectedKeys\n    // or defaultCheckedKeys changes, so we need to force a re-render when the value changes from outside.\n    var _g = React.useState(0), key = _g[0], setKey = _g[1];\n    // By default, we want to update the key when the value changes\n    var shouldUpdateKey = React.useRef(true);\n    React.useEffect(function () {\n        if (shouldUpdateKey.current) {\n            setKey(function (prevKey) { return prevKey + 1; });\n        }\n        // Always set it back to true\n        shouldUpdateKey.current = true;\n    }, [value]);\n    var handleCheck = useEvent(function (event, records) {\n        // We don't want to force a re-render when the user checks/unchecks nodes\n        shouldUpdateKey.current = false;\n        field === null || field === void 0 ? void 0 : field.onChange(records.map(function (record) { return record.id; }));\n    });\n    var handleSelect = useEvent(function (event, record) {\n        var _a;\n        // We don't want to force a re-render when the user selects a node\n        shouldUpdateKey.current = false;\n        field === null || field === void 0 ? void 0 : field.onChange((_a = record === null || record === void 0 ? void 0 : record.id) !== null && _a !== void 0 ? _a : null);\n        handleClose();\n    });\n    var _h = React.useState(false), open = _h[0], setOpen = _h[1];\n    var handleKeyDown = useEvent(function (event) {\n        if (event.key === 'Enter' || event.key === ' ') {\n            // Prevent the default behavior of the Enter key\n            event.preventDefault();\n            // Open the popover when the user presses Enter or Space\n            setOpen(true);\n        }\n    });\n    var anchorEl = React.useRef(null);\n    var handleClick = function () {\n        setOpen(true);\n    };\n    var handleClose = function () {\n        setOpen(false);\n    };\n    var popoverRef = React.useRef(null);\n    var handleExpand = function () {\n        var _a;\n        // To avoid issue when the popover is at close to the screen edges,\n        // we update popover position when the tree is expanded/collapsed\n        // without triggering a re-render that would reset the tree state.\n        (_a = popoverRef.current) === null || _a === void 0 ? void 0 : _a.updatePosition();\n    };\n    var resource = useResourceContext(props);\n    var getRecordRepresentation = useGetRecordRepresentation(resource);\n    var InputComponent = {\n        standard: Input,\n        outlined: OutlinedInput,\n        filled: FilledInput,\n    }[variant];\n    return (_jsxs(_Fragment, { children: [_jsx(InputComponent, { id: id, ref: anchorEl, onClick: handleClick, endAdornment: _jsx(KeyboardArrowDownIcon, {}), size: size, margin: margin, inputComponent: TreeInputInput, className: className, onKeyDown: handleKeyDown, label: _jsx(FieldTitle, { resource: resource, label: label, isRequired: isRequired, source: source }), notched: variant === 'outlined'\n                    ? selectedRecords.length > 0\n                        ? true\n                        : false\n                    : undefined, inputProps: {\n                    children: selectedRecords.length === 0 ? null : (_jsx(Stack, { direction: \"row\", flexWrap: \"wrap\", children: multiple ? (selectedRecords.map(function (record) { return (_jsx(Chip, { size: size, onDelete: function (event) {\n                                handleCheck(event, selectedRecords.filter(function (r) { return r.id !== record.id; }), record, false);\n                            }, label: _jsx(ChoiceLabel, { record: record, titleField: titleField ||\n                                    getRecordRepresentation }) }, record.id)); })) : (_jsx(ChoiceLabel, { record: selectedRecords[0], titleField: titleField ||\n                                getRecordRepresentation })) })),\n                } }), _jsx(Popover, { action: popoverRef, open: open, anchorEl: anchorEl.current, onClose: handleClose, anchorOrigin: {\n                    vertical: 'bottom',\n                    horizontal: 'right',\n                }, transformOrigin: {\n                    vertical: 'top',\n                    horizontal: 'right',\n                }, slotProps: {\n                    paper: {\n                        sx: {\n                            minWidth: anchorEl\n                                ? (_a = anchorEl.current) === null || _a === void 0 ? void 0 : _a.clientWidth\n                                : 'auto',\n                        },\n                    },\n                }, children: _createElement(Tree, __assign({}, rest, { key: key, checkStrictly: checkStrictly, expandAction: expandAction, checkable: multiple, selectable: !multiple, checkedKeys: multiple ? value : [], selectedKeys: multiple ? [] : [value], defaultCheckedKeys: multiple ? value : undefined, defaultSelectedKeys: multiple ? undefined : [value], defaultExpandedKeys: multiple ? value : [value], onCheck: handleCheck, onSelect: handleSelect, onExpand: handleExpand, data: data, onBlur: field === null || field === void 0 ? void 0 : field.onBlur, sx: __assign({ padding: 1 }, sx) })) })] }));\n};\n/**\n * Required component for MUI inputComponent prop that must accept a ref, children, and className.\n */\nvar TreeInputInput = React.forwardRef(function TreeInputInput(props, ref) {\n    var className = props.className, children = props.children, inputProps = __rest(props, [\"className\", \"children\"]);\n    return (_jsxs(Box, { className: className, children: [_jsx(\"input\", __assign({ ref: ref }, inputProps, { style: visuallyHidden })), children] }));\n});\nvar ChoiceLabel = function (_a) {\n    var titleField = _a.titleField, record = _a.record;\n    if (!record) {\n        return null;\n    }\n    if (typeof titleField === 'function') {\n        return titleField(record);\n    }\n    return get(record, titleField);\n};\n","import { useGetTree } from '../dataProvider';\nexport var useReferenceNodeInputController = function (props) {\n    var resource = props.reference, source = props.source, meta = props.meta;\n    var _a = useGetTree(resource, {\n        meta: meta,\n    }), data = _a.data, error = _a.error, isLoading = _a.isLoading, isFetching = _a.isFetching;\n    return {\n        source: source,\n        resource: resource,\n        data: data,\n        error: error !== null && error !== void 0 ? error : undefined,\n        isLoading: isLoading,\n        isFetching: isFetching,\n    };\n};\n","var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { ResourceContextProvider } from 'react-admin';\nimport { TreeChoicesContextProvider } from '.';\nimport { TreeInput } from '../TreeInput';\nimport { useReferenceNodeInputController, } from './useReferenceNodeInputController';\n/**\n * Use the `<ReferenceNodeInput>` component to select one or several nodes from a tree of a reference resource.\n *\n * @example\n * ```tsx\n * import { ReferenceNodeInput } from '@react-admin/ra-tree';\n * import { Edit, SimpleForm, TextInput } from 'react-admin';\n *\n * const ProductEdit = () => (\n *     <Edit>\n *         <SimpleForm>\n *             <TextInput source=\"name\" />\n *             <ReferenceNodeInput\n *                 source=\"category_id\"\n *                 reference=\"categories\"\n *             />\n *         </SimpleForm>\n *     </Edit>\n * );\n * ```\n */\nexport var ReferenceNodeInput = function (props) {\n    var _a = props.children, children = _a === void 0 ? _jsx(TreeInput, {}) : _a;\n    var _b = useReferenceNodeInputController(props), resource = _b.resource, rest = __rest(_b, [\"resource\"]);\n    return (_jsx(ResourceContextProvider, { value: resource, children: _jsx(TreeChoicesContextProvider, { value: rest, children: children }) }));\n};\n","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { TreeChoicesContext, } from './TreeChoicesContext';\nexport var TreeChoicesContextProvider = function (_a) {\n    var children = _a.children, value = _a.value;\n    return (_jsx(TreeChoicesContext.Provider, { value: value, children: children }));\n};\n","import { useContext } from 'react';\nimport { TreeChoicesContext, } from './TreeChoicesContext';\nexport var useTreeChoicesContext = function () {\n    return (useContext(TreeChoicesContext) || {});\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { useInput, useResourceContext, } from 'react-admin';\nimport { useTreeChoicesContext } from '../reference';\nexport var useTreeInputController = function (props) {\n    var sourceProp = props.source, dataProp = props.data, hideRootNodes = props.hideRootNodes, rest = __rest(props, [\"source\", \"data\", \"hideRootNodes\"]);\n    var resource = useResourceContext(props);\n    if (resource == null) {\n        throw new Error('The useTreeInputController hook must be used inside a ResourceContext or must be passed a resource prop.');\n    }\n    var _a = useTreeChoicesContext(), sourceFromContext = _a.source, dataFromContext = _a.data, isLoading = _a.isLoading, isFetching = _a.isFetching, error = _a.error;\n    var data = dataProp !== null && dataProp !== void 0 ? dataProp : dataFromContext;\n    var source = sourceProp !== null && sourceProp !== void 0 ? sourceProp : sourceFromContext;\n    if (source == null) {\n        throw new Error('The useTreeInputController hook must be used inside a ReferenceNodeInput or have a source prop');\n    }\n    var _b = useInput(__assign(__assign({}, rest), { resource: resource, source: source, type: 'text' })), isRequired = _b.isRequired, field = _b.field, fieldState = _b.fieldState, formState = _b.formState;\n    return {\n        resource: resource,\n        source: source,\n        data: data !== null && data !== void 0 ? data : [],\n        fetchError: error,\n        isLoading: isLoading,\n        isFetching: isFetching,\n        isRequired: isRequired,\n        field: field,\n        fieldState: fieldState,\n        formState: formState,\n    };\n};\n","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { TreeContext } from './TreeContext';\nexport var TreeContextProvider = function (_a) {\n    var children = _a.children, value = _a.value;\n    return (_jsx(TreeContext.Provider, { value: value, children: children }));\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { CreateView, CreateContextProvider } from 'react-admin';\nimport { useCreateNodeController } from './controllers';\n/**\n * Alternative to <Create> for tree nodes.\n *\n * Upon creation, calls the dataProvider.addRootNode() or dataProvider.addChildNode()\n * (depending on the presence of a parentId in the location state) instead of\n * dataProvider.create().\n */\nvar CreateNode = function (props) {\n    var controllerProps = useCreateNodeController(props);\n    return (_jsx(CreateContextProvider, { value: controllerProps, children: _jsx(CreateView, __assign({}, props, controllerProps)) }));\n};\nexport default CreateNode;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useEffect } from 'react';\nimport { useShowController, ShowView, ShowContextProvider, } from 'react-admin';\nimport { useParams } from 'react-router-dom';\nimport { useExpandedKeys } from './util';\n/**\n * Alternative to <Show> for tree nodes.\n *\n * Adds a button to add a child node in view actions.\n */\nvar ShowNode = function (props) {\n    var idProp = props.id;\n    var routeId = useParams().id;\n    if (!routeId && !idProp) {\n        throw new Error('ShowNode requires an id prop or a route with an /:id? parameter.');\n    }\n    var id = idProp !== null && idProp !== void 0 ? idProp : routeId;\n    var _a = useExpandedKeys(), setExpandedKeys = _a[1];\n    // Automatically expand the node on mount\n    useEffect(function () {\n        setExpandedKeys(function (expandedKeys) {\n            var key = id.toString();\n            if (Array.isArray(expandedKeys)) {\n                if (!expandedKeys.includes(key)) {\n                    return __spreadArray(__spreadArray([], expandedKeys, true), [key], false);\n                }\n                return expandedKeys;\n            }\n            else {\n                return [key];\n            }\n        });\n    }, [props.resource, id, setExpandedKeys]);\n    var controllerProps = useShowController(props);\n    return (_jsx(ShowContextProvider, { value: controllerProps, children: _jsx(ShowView, __assign({}, props)) }));\n};\nexport default ShowNode;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { MenuItem } from '@mui/material';\nimport * as inflection from 'inflection';\nimport { useTranslate, Confirm, useRecordContext, useResourceContext, } from 'react-admin';\nimport { useDeleteBranchWithConfirmController } from './controllers';\nexport var DeleteMenuItemWithConfirmation = function (props) {\n    var className = props.className, _a = props.confirmTitle, confirmTitle = _a === void 0 ? 'ra.message.delete_title' : _a, _b = props.confirmContent, confirmContent = _b === void 0 ? 'ra.message.delete_content' : _b, _c = props.label, label = _c === void 0 ? 'ra.action.delete' : _c, mutationMode = props.mutationMode, onClick = props.onClick, recordProp = props.record, resourceProp = props.resource, ref = props.ref, _d = props.redirect, redirectTo = _d === void 0 ? 'list' : _d, rest = __rest(props, [\"className\", \"confirmTitle\", \"confirmContent\", \"label\", \"mutationMode\", \"onClick\", \"record\", \"resource\", \"ref\", \"redirect\"]);\n    var resource = useResourceContext(props);\n    if (!resource) {\n        throw new Error('The DeleteMenuItemWithConfirmation component must be used inside a ResourceContext or must be passed a resource prop.');\n    }\n    var record = useRecordContext(props);\n    if (!record) {\n        throw new Error('The DeleteMenuItemWithConfirmation component must be used inside a RecordContext or must be passed a record prop.');\n    }\n    var _e = useDeleteBranchWithConfirmController({\n        mutationMode: mutationMode,\n        record: record,\n        resource: resource,\n        redirect: redirectTo,\n    }), handleDelete = _e.handleDelete, handleDialogClose = _e.handleDialogClose, handleDialogOpen = _e.handleDialogOpen, isPending = _e.isPending, open = _e.open;\n    var translate = useTranslate();\n    var handleClick = function (event) {\n        event.stopPropagation();\n        if (onClick) {\n            onClick(event);\n        }\n        if (!event.isDefaultPrevented()) {\n            handleDialogOpen(event);\n        }\n    };\n    return (_jsxs(_Fragment, { children: [_jsx(MenuItem, __assign({ className: className, onClick: handleClick, ref: ref }, rest, { children: translate(label, { _: label }) })), _jsx(Confirm, { isOpen: open, loading: isPending, title: confirmTitle, content: confirmContent, translateOptions: {\n                    name: inflection.humanize(translate(\"resources.\".concat(resource, \".name\"), {\n                        smart_count: 1,\n                        _: inflection.singularize(resource),\n                    }), true),\n                    id: record.id,\n                }, onConfirm: handleDelete, onClose: handleDialogClose })] }));\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { MenuItem } from '@mui/material';\nimport { useTranslate, useResourceContext, useRecordContext, } from 'react-admin';\nimport { useDeleteBranchWithUndoController } from './controllers';\nexport var DeleteMenuItemWithUndo = function (props) {\n    var className = props.className, _a = props.label, label = _a === void 0 ? 'ra.action.delete' : _a, mutationMode = props.mutationMode, onClick = props.onClick, recordProp = props.record, ref = props.ref, resourceProp = props.resource, _b = props.redirect, redirectTo = _b === void 0 ? 'list' : _b, rest = __rest(props, [\"className\", \"label\", \"mutationMode\", \"onClick\", \"record\", \"ref\", \"resource\", \"redirect\"]);\n    var resource = useResourceContext(props);\n    if (!resource) {\n        throw new Error('The DeleteMenuItemWithUndo component must be used inside a ResourceContext or must be passed a resource prop.');\n    }\n    var record = useRecordContext(props);\n    if (!record) {\n        throw new Error('The DeleteMenuItemWithUndo component must be used inside a RecordContext or must be passed a record prop.');\n    }\n    var _c = useDeleteBranchWithUndoController({\n        record: record,\n        resource: resource,\n        redirect: redirectTo,\n    }), handleDelete = _c.handleDelete, isPending = _c.isPending;\n    var translate = useTranslate();\n    var handleClick = function (event) {\n        event.stopPropagation();\n        if (onClick) {\n            onClick(event);\n        }\n        if (!event.isDefaultPrevented()) {\n            handleDelete(event);\n        }\n    };\n    return (_jsx(MenuItem, __assign({ className: className, disabled: isPending, onClick: handleClick, ref: ref }, rest, { children: translate(label, { _: label }) })));\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { DeleteMenuItemWithConfirmation } from './DeleteMenuItemWithConfirmation';\nimport { DeleteMenuItemWithUndo } from './DeleteMenuItemWithUndo';\n/**\n * MenuItem used to delete a branch. Added by default by the <NodeActions> of the TreeWithDetails component.\n *\n * @typedef {Object} Props The props you can use (other props are injected if you used it in the <NodeActions>)\n * @param {Prop} props\n * @prop {string} mutationMode Either 'undoable', 'optimistic' or 'pessimistic'. When using 'optimistic' or 'pessimistic', a confirmation dialog is displayed before the deletion. When using 'undoable', a notification is displayed and users have the possibility to undo the deletion.\n * @prop {string} className\n * @prop {string} label MenuItem label. Defaults to 'ra.action.delete, translated.\n *\n * @example\n * import { NodeActions, DeleteMenuItem, TreeWithDetails } from '@react-admin/ra-tree';\n *\n * const MyCustomActionMenuItem = ({ record, resource, parentId }) => {\n *     const handleClick = () => {\n *         // Do something with dataProvider ?\n *     }\n *     return (\n *         <MenuItem onClick={handleClick}>\n *             Do something\n *         </MenuItem>\n *     );\n * };\n *\n * const MyActions = (props) => (\n *     <NodeActions {...props}>\n *         <MyCustomActionMenuItem />\n *         <DeleteMenuItem />\n *     </NodeActions>\n * );\n *\n * const CategoriesList: FC<Props> = props => (\n *     <TreeWithDetails\n *         titleField=\"name\"\n *         edit={CategoriesEdit}\n *         draggable\n *         showLine\n *         nodeActions={<MyActions />}\n *         {...props}\n *     />\n * );\n */\nexport var DeleteMenuItem = function (props) {\n    var _a = props.mutationMode, mutationMode = _a === void 0 ? 'undoable' : _a, rest = __rest(props, [\"mutationMode\"]);\n    return mutationMode === 'undoable' ? (_jsx(DeleteMenuItemWithUndo, __assign({}, rest, { mutationMode: mutationMode }))) : (_jsx(DeleteMenuItemWithConfirmation, __assign({}, rest, { mutationMode: mutationMode })));\n};\nDeleteMenuItem.displayName = 'DeleteMenuItem';\n","import { createContext, useContext } from 'react';\nvar NodeActionsContext = createContext(null);\nexport var NodeActionsContextProvider = NodeActionsContext.Provider;\nexport var useNodeActionsContext = function () {\n    var context = useContext(NodeActionsContext);\n    if (!context) {\n        throw new Error('useNodeActionsContext must be used within a NodeActionsContextProvider');\n    }\n    return context;\n};\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useCallback, useMemo, useState } from 'react';\nimport { Menu, styled } from '@mui/material';\nimport MoreVertIcon from '@mui/icons-material/MoreVert';\nimport { DeleteMenuItem } from './DeleteMenuItem';\nimport { NodeActionsContextProvider } from './NodeActionsContext';\n/**\n * Provides a dropdown menu for each node.\n * It accepts children which must return a MaterialUI MenuItem component\n *\n * @example\n * import { NodeActions, DeleteMenuItem, TreeWithDetails } from '@react-admin/ra-tree';\n *\n * const MyCustomActionMenuItem = ({ record, resource, parentId }) => {\n *     const handleClick = () => {\n *         // Do something with dataProvider ?\n *     }\n *     return (\n *         <MenuItem onClick={handleClick}>\n *             Do something\n *         </MenuItem>\n *     );\n * };\n *\n * const MyActions = (props) => (\n *     <NodeActions {...props}>\n *         <MyCustomActionMenuItem />\n *         <DeleteMenuItem />\n *     </NodeActions>\n * );\n *\n * const CategoriesList: FC<Props> = props => (\n *     <TreeWithDetails\n *         titleField=\"name\"\n *         edit={CategoriesEdit}\n *         draggable\n *         showLine\n *         nodeActions={<MyActions />}\n *         {...props}\n *     />\n * );\n */\nvar NodeActions = function (props) {\n    var _a = props.children, children = _a === void 0 ? _jsx(DeleteMenuItem, {}) : _a, className = props.className;\n    var _b = useState(null), anchorEl = _b[0], setAnchorEl = _b[1];\n    var handleClick = function (event) {\n        event.stopPropagation();\n        setAnchorEl(event.currentTarget);\n    };\n    var handleClose = useCallback(function (event) {\n        event.stopPropagation();\n        setAnchorEl(null);\n    }, []);\n    var context = useMemo(function () { return ({ close: handleClose }); }, [handleClose]);\n    return (_jsxs(Root, { className: className, children: [_jsx(\"button\", { className: RaNodeActionsClasses.menuButton, onClick: handleClick, children: _jsx(MoreVertIcon, {}) }), _jsx(Menu, { anchorEl: anchorEl, open: !!anchorEl, onClose: handleClose, children: _jsx(NodeActionsContextProvider, { value: context, children: children }) })] }));\n};\nexport default NodeActions;\nvar PREFIX = 'RaNodeActions';\nexport var RaNodeActionsClasses = {\n    menuButton: \"\".concat(PREFIX, \"-menuButton\"),\n};\nvar Root = styled('div', {\n    name: PREFIX,\n    overridesResolver: function (props, styles) { return styles.root; },\n})(function () { return ({}); });\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { alpha, styled } from '@mui/material';\nimport ActionDelete from '@mui/icons-material/Delete';\nimport clsx from 'clsx';\nimport { Button, useRecordContext, useResourceContext, } from 'react-admin';\nimport { useDeleteBranchWithUndoController } from './controllers';\nexport var DeleteBranchWithUndoButton = function (props) {\n    var _a = props.label, label = _a === void 0 ? 'ra.action.delete' : _a, className = props.className, _b = props.icon, icon = _b === void 0 ? defaultIcon : _b, onClick = props.onClick, resourceProp = props.resource, recordProp = props.record, _c = props.redirect, redirect = _c === void 0 ? 'list' : _c, rest = __rest(props, [\"label\", \"className\", \"icon\", \"onClick\", \"resource\", \"record\", \"redirect\"]);\n    var resource = useResourceContext(props);\n    if (!resource) {\n        throw new Error('The DeleteBranchWithUndoButton component must be used inside a ResourceContext or must be passed a resource prop.');\n    }\n    var record = useRecordContext(props);\n    if (!record) {\n        throw new Error('The DeleteBranchWithUndoButton component must be used inside a RecordContext or must be passed a record prop.');\n    }\n    var _d = useDeleteBranchWithUndoController({\n        resource: resource,\n        record: record,\n        redirect: redirect,\n    }), handleDelete = _d.handleDelete, isPending = _d.isPending;\n    var handleClick = function (event) {\n        if (onClick) {\n            onClick(event);\n        }\n        if (!event.isDefaultPrevented()) {\n            handleDelete(event);\n        }\n    };\n    return (_jsx(Root, __assign({ onClick: handleClick, disabled: isPending, label: label, className: clsx('ra-delete-button', className) }, rest, { children: icon }), \"button\"));\n};\nvar Root = styled(Button, {\n    name: 'RaDeleteBranchWithUndoButton',\n    overridesResolver: function (props, styles) { return styles.root; },\n})(function (_a) {\n    var theme = _a.theme;\n    return ({\n        color: theme.palette.error.main,\n        '&:hover': {\n            backgroundColor: alpha(theme.palette.error.main, 0.12),\n            // Reset on mouse devices\n            '@media (hover: none)': {\n                backgroundColor: 'transparent',\n            },\n        },\n    });\n});\nvar defaultIcon = _jsx(ActionDelete, {});\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { alpha, styled } from '@mui/material';\nimport ActionDelete from '@mui/icons-material/Delete';\nimport clsx from 'clsx';\nimport * as inflection from 'inflection';\nimport { useTranslate, Button, Confirm, useResourceContext, useRecordContext, } from 'react-admin';\nimport { useDeleteBranchWithConfirmController } from './controllers';\nexport var DeleteBranchWithConfirmButton = function (props) {\n    var className = props.className, _a = props.confirmTitle, confirmTitle = _a === void 0 ? 'ra.message.delete_title' : _a, _b = props.confirmContent, confirmContent = _b === void 0 ? 'ra.message.delete_content' : _b, _c = props.icon, icon = _c === void 0 ? defaultIcon : _c, _d = props.label, label = _d === void 0 ? 'ra.action.delete' : _d, mutationMode = props.mutationMode, onClick = props.onClick, recordProp = props.record, resourceProp = props.resource, _e = props.redirect, redirect = _e === void 0 ? 'list' : _e, rest = __rest(props, [\"className\", \"confirmTitle\", \"confirmContent\", \"icon\", \"label\", \"mutationMode\", \"onClick\", \"record\", \"resource\", \"redirect\"]);\n    var translate = useTranslate();\n    var resource = useResourceContext(props);\n    if (!resource) {\n        throw new Error('The DeleteBranchWithConfirmButton component must be used inside a ResourceContext or must be passed a resource prop.');\n    }\n    var record = useRecordContext(props);\n    if (!record) {\n        throw new Error('The DeleteBranchWithConfirmButton component must be used inside a RecordContext or must be passed a record prop.');\n    }\n    var _f = useDeleteBranchWithConfirmController({\n        mutationMode: mutationMode,\n        resource: resource,\n        record: record,\n        redirect: redirect,\n    }), handleDelete = _f.handleDelete, handleDialogClose = _f.handleDialogClose, handleDialogOpen = _f.handleDialogOpen, isPending = _f.isPending, open = _f.open;\n    var handleClick = function (event) {\n        if (onClick) {\n            onClick(event);\n        }\n        if (!event.isDefaultPrevented()) {\n            handleDialogOpen(event);\n        }\n    };\n    return (_jsxs(Root, { className: className, children: [_jsx(Button, __assign({ onClick: handleClick, label: label, className: clsx('ra-delete-button', DeleteWithConfirmButtonClasses.deleteButton) }, rest, { children: icon }), \"button\"), _jsx(Confirm, { isOpen: open, loading: isPending, title: confirmTitle, content: confirmContent, translateOptions: {\n                    name: translate(\"resources.\".concat(resource, \".forcedCaseName\"), {\n                        smart_count: 1,\n                        _: inflection.humanize(translate(\"resources.\".concat(resource, \".name\"), {\n                            smart_count: 1,\n                            _: inflection.singularize(resource),\n                        }), true),\n                    }),\n                    id: record.id,\n                }, onConfirm: handleDelete, onClose: handleDialogClose })] }));\n};\nvar defaultIcon = _jsx(ActionDelete, {});\nvar PREFIX = 'RaDeleteBranchWithConfirmButton';\nexport var DeleteWithConfirmButtonClasses = {\n    deleteButton: \"\".concat(PREFIX, \"-deleteButton\"),\n};\nvar Root = styled('div', { name: PREFIX })(function (_a) {\n    var _b;\n    var theme = _a.theme;\n    return (_b = {},\n        _b[\"& .\".concat(DeleteWithConfirmButtonClasses.deleteButton)] = {\n            color: theme.palette.error.main,\n            '&:hover': {\n                backgroundColor: alpha(theme.palette.error.main, 0.12),\n                // Reset on mouse devices\n                '@media (hover: none)': {\n                    backgroundColor: 'transparent',\n                },\n            },\n        },\n        _b);\n});\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useRecordContext, useSaveContext, } from 'react-admin';\nimport { DeleteBranchWithUndoButton } from './DeleteBranchWithUndoButton';\nimport { DeleteBranchWithConfirmButton } from './DeleteBranchWithConfirmButton';\n/**\n * Button used to delete a single branch. Added by default by the <Toolbar> of edit and show views.\n *\n * @typedef {Object} Props The props you can use (other props are injected if you used it in the <Toolbar>)\n * @param {Prop} props\n * @prop {string} mutationMode Either 'undoable', 'optimistic' or 'pessimistic'. When using 'optimistic' or 'pessimistic', a confirmation dialog is displayed before the deletion. When using 'undoable', a notification is displayed and users have the possibility to undo the deletion.\n * @prop {string} className\n * @prop {string} label Button label. Defaults to 'ra.action.delete, translated.\n * @prop {boolean} disabled Disable the button.\n * @prop {string} variant MUI variant for the button. Defaults to 'contained'.\n * @prop {ReactElement} icon Override the icon. Defaults to the Delete icon from MUI.\n *\n * @example Usage in the <TopToolbar> of an <Edit> form\n *\n * import * as React from 'react';\n * import { Edit } from 'react-admin';\n * import { DeleteButton, TopToolbar } from '@react-admin/ra-tree';\n *\n * const EditActions = props => {\n *     const { basePath, data, resource } = props;\n *     return (\n *         <TopToolbar>\n *             <DeleteButton\n *                 basePath={basePath}\n *                 record={data}\n *                 resource={resource}\n *                 undoable={false} // Renders the <DeleteWithConfirmButton>\n *             />\n *         </TopToolbar>\n *     );\n * };\n *\n * const Edit = props => {\n *     return <Edit actions={<EditActions />} {...props} />;\n * };\n */\nexport var DeleteBranchButton = function (props) {\n    var _a = props.mutationMode, mutationMode = _a === void 0 ? 'undoable' : _a, recordProp = props.record, rest = __rest(props, [\"mutationMode\", \"record\"]);\n    var record = useRecordContext(props);\n    var saveContext = useSaveContext(props);\n    if (!record || record.id == null) {\n        return null;\n    }\n    var finalMutationMode = mutationMode\n        ? mutationMode\n        : (saveContext === null || saveContext === void 0 ? void 0 : saveContext.mutationMode)\n            ? saveContext.mutationMode\n            : 'undoable';\n    return finalMutationMode === 'undoable' ? (\n    // @ts-ignore\n    _jsx(DeleteBranchWithUndoButton, __assign({ record: record }, rest))) : (_jsx(DeleteBranchWithConfirmButton, __assign({ \n        // @ts-ignore\n        mutationMode: finalMutationMode, \n        // @ts-ignore\n        record: record }, rest)));\n};\n","import { useBasename } from 'react-admin';\nimport { useMatch, } from 'react-router-dom';\nexport function useMatchWithBasename(pattern) {\n    var basename = useBasename();\n    return useMatch((basename !== null && basename !== void 0 ? basename : '') + pattern);\n}\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar _a;\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport * as React from 'react';\nimport { useCallback } from 'react';\nimport { CreateButton, Title, useCreatePath, useEvent, useResourceContext, } from 'react-admin';\nimport { Route, Routes, useNavigate } from 'react-router-dom';\nimport { Card, CardContent, styled } from '@mui/material';\nimport { Tree } from './Tree';\nimport { UNSAVED_NEW_NODE } from './constants';\nimport { TreeContextProvider, useTreeController } from './controllers';\nimport DefaultNodeActions from './NodeActions';\nimport { useMatchWithBasename } from './useMatchWithBasename';\n/**\n * Main Tree component, to be used instead of List in a Resource.\n *\n * You MUST include the tree reducer in the Admin for this component to work. Also,\n * the dataProvider must support tree methods, e.g. getTree, moveAsNthSiblingOf, etc.\n *\n * @example\n *\n * import React, { ComponentProps, FC } from 'react';\n * import { Admin, Resource, List, ListGuesser } from 'react-admin';\n * import { reducer as tree, TreeWithDetails } from '@react-admin/ra-tree';\n *\n * // tree-augmented dataProvider\n * import dataProvider from './dataProvider';\n * import i18nProvider from './i18nProvider';\n *\n * const CategoriesEdit: FC = props => (\n *     <Edit {...props}>\n *         <SimpleForm>\n *             <TextInput source=\"name\" />\n *         </SimpleForm>\n *     </Edit>\n * );\n *\n * const CategoriesList: FC<Props> = props => (\n *     <TreeWithDetails\n *         titleField=\"name\"\n *         edit={CategoriesEdit}\n *         draggable\n *         showLine\n *         {...props}\n *     />\n * );\n *\n * type Props = ComponentProps<typeof List>;\n *\n * export const App: FC = () => (\n *     <Admin\n *         dataProvider={dataProvider}\n *         i18nProvider={i18nProvider}\n *         customReducers={{ tree }}\n *     >\n *         <Resource name=\"categories\" list={CategoriesList} />\n *         <Resource name=\"products\" list={ListGuesser} />\n *     </Admin>\n * );\n */\nexport var TreeWithDetails = function (props) {\n    var _a = props.allowMultipleRoots, allowMultipleRoots = _a === void 0 ? false : _a, className = props.className, Create = props.create, defaultExpandedKeys = props.defaultExpandedKeys, Edit = props.edit, filter = props.filter, hideRootNodes = props.hideRootNodes, _b = props.lazy, lazy = _b === void 0 ? false : _b, linkTo = props.linkTo, _c = props.nodeActions, nodeActions = _c === void 0 ? _jsx(DefaultNodeActions, {}) : _c, Show = props.show, showLine = props.showLine, sx = props.sx, title = props.title, titleField = props.titleField, _d = props.addRootButton, addRootButton = _d === void 0 ? (_jsx(CreateButton, { label: \"ra-tree.action.add_root\", sx: { marginTop: '.75rem' } })) : _d, meta = props.meta, mutationMode = props.mutationMode, expandedKeysProp = props.expandedKeys, onExpand = props.onExpand, onClick = props.onClick, onDrop = props.onDrop, rest = __rest(props, [\"allowMultipleRoots\", \"className\", \"create\", \"defaultExpandedKeys\", \"edit\", \"filter\", \"hideRootNodes\", \"lazy\", \"linkTo\", \"nodeActions\", \"show\", \"showLine\", \"sx\", \"title\", \"titleField\", \"addRootButton\", \"meta\", \"mutationMode\", \"expandedKeys\", \"onExpand\", \"onClick\", \"onDrop\"]);\n    var resource = useResourceContext(props);\n    if (resource == null) {\n        throw new Error('The TreeWithDetails hook must be used inside a ResourceContext or must be passed a resource prop.');\n    }\n    var navigate = useNavigate();\n    var createPath = useCreatePath();\n    // find id in location to set it as selected\n    // location can be /posts, /posts/123, or /posts/123/show, or /posts/create\n    var matchCreate = useMatchWithBasename(\"/\".concat(resource, \"/create/*\"));\n    var matchEdit = useMatchWithBasename(\"/\".concat(resource, \"/:id/*\"));\n    var matchShow = useMatchWithBasename(\"/\".concat(resource, \"/:id/show/*\"));\n    var finalLinkTo = getLinkTo(props);\n    var _e = React.useState(function () {\n        if (matchCreate) {\n            return [UNSAVED_NEW_NODE];\n        }\n        if (matchEdit) {\n            return [matchEdit.params.id];\n        }\n        if (matchShow) {\n            return [matchShow.params.id];\n        }\n    }), defaultSelectedKeys = _e[0], setSelectedKeys = _e[1];\n    React.useEffect(function () {\n        if (matchCreate) {\n            setSelectedKeys([UNSAVED_NEW_NODE]);\n            return;\n        }\n        if (matchEdit) {\n            setSelectedKeys([matchEdit.params.id]);\n            return;\n        }\n        if (matchShow) {\n            setSelectedKeys([matchShow.params.id]);\n            return;\n        }\n    }, [matchCreate, matchEdit, matchShow]);\n    var controllerProps = useTreeController({\n        lazy: lazy,\n        resource: resource,\n        filter: filter,\n        meta: meta,\n        mutationMode: mutationMode,\n        expandedKeys: expandedKeysProp !== null && expandedKeysProp !== void 0 ? expandedKeysProp : defaultExpandedKeys,\n    });\n    var data = controllerProps.data, defaultTitle = controllerProps.defaultTitle, handleExpand = controllerProps.handleExpand, isPending = controllerProps.isPending, loadChildNodes = controllerProps.loadChildNodes, handleDrop = controllerProps.handleDrop, expandedKeys = controllerProps.expandedKeys;\n    var handleClick = useEvent(function (event, treeNode) {\n        if (onClick) {\n            onClick(event, treeNode);\n        }\n        if (!event.defaultPrevented) {\n            if (finalLinkTo) {\n                return navigate(createPath({\n                    resource: resource,\n                    id: treeNode.id,\n                    type: finalLinkTo,\n                }));\n            }\n        }\n    });\n    var handleExpandEvent = useEvent(function (event, expandedKey, record, isExpanded) {\n        if (onExpand) {\n            onExpand(event, expandedKey, record, isExpanded);\n        }\n        if (!event.defaultPrevented) {\n            handleExpand(expandedKey.map(function (_a) {\n                var id = _a.id;\n                return id;\n            }));\n        }\n    });\n    var handleDropEvent = useEvent(function (event, data) {\n        if (onDrop) {\n            onDrop(event, data);\n        }\n        // Here we can't check whether the event has been defaultPrevented in\n        // users provided onDrop because the Tree implementation does prevent the default event\n        handleDrop(data);\n    });\n    var handleLoadData = useCallback(function (node) { return __awaiter(void 0, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            if (lazy) {\n                return [2 /*return*/, loadChildNodes(node.record.id)];\n            }\n            return [2 /*return*/, Promise.resolve()];\n        });\n    }); }, [lazy, loadChildNodes]);\n    var rootNodeIds = React.useMemo(function () {\n        var _a;\n        return ((_a = data === null || data === void 0 ? void 0 : data.reduce(function (acc, node) {\n            if (\n            // A node is a root node if it has no parent\n            // (that's the only information we can rely on)\n            !data.some(function (maybeParentNode) { var _a; return (_a = maybeParentNode.children) === null || _a === void 0 ? void 0 : _a.includes(node.id); })) {\n                acc.push(node.id);\n            }\n            return acc;\n        }, [])) !== null && _a !== void 0 ? _a : []);\n    }, [data]);\n    var allowDrop = useEvent(function (options) {\n        var destination = options.destination, position = options.position;\n        if (data == null)\n            return false;\n        // If multiple roots are allowed, we can always drop\n        if (allowMultipleRoots)\n            return true;\n        var isRootNode = rootNodeIds.includes(destination.id);\n        // If the destination is a root node and the position is -1, it means we're trying to move a node to the root level\n        if (isRootNode && position === -1) {\n            return false;\n        }\n        return true;\n    });\n    if (isPending || data == null) {\n        return null;\n    }\n    var canCreateNode = !data || data.length === 0 || allowMultipleRoots;\n    return (_jsx(TreeContextProvider, { value: controllerProps, children: _jsxs(Root, { className: className, sx: sx, children: [_jsx(\"div\", { className: TreeWithDetailsClasses.cardTree, children: _jsx(Card, { children: _jsxs(CardContent, { className: TreeWithDetailsClasses.cardContentTree, children: [_jsx(Tree, __assign({ allowDrop: allowDrop, data: data, hideRootNodes: hideRootNodes, titleField: titleField, onDrop: handleDropEvent, onExpand: handleExpandEvent, onClick: handleClick, selectedKeys: defaultSelectedKeys, showLine: showLine, nodeActions: nodeActions, loadData: lazy ? handleLoadData : undefined, loadedKeys: undefined, \n                                    // To avoid triggering close on node selection\n                                    expandAction: false, expandedKeys: expandedKeys }, sanitizeRestProps(rest))), canCreateNode ? addRootButton : null] }) }) }), _jsx(\"div\", { className: TreeWithDetailsClasses.actionCard, children: _jsxs(Routes, { children: [Create ? (_jsx(Route, { path: \"create/*\", element: typeof Create === 'function' ? (_jsx(Create, {})) : (Create) })) : null, Show ? (_jsx(Route, { path: \":id/show/*\", element: typeof Show === 'function' ? _jsx(Show, {}) : Show })) : null, Edit ? (_jsx(Route, { path: \":id/*\", element: typeof Edit === 'function' ? _jsx(Edit, {}) : Edit })) : null, title !== false ? (_jsx(Route, { path: \"*\", element: _jsx(Title, { title: title, defaultTitle: defaultTitle }) })) : null] }) })] }) }));\n};\nvar sanitizeRestProps = function (_a) {\n    var basePath = _a.basePath, history = _a.history, location = _a.location, match = _a.match, options = _a.options, hasList = _a.hasList, hasEdit = _a.hasEdit, hasShow = _a.hasShow, hasCreate = _a.hasCreate, syncWithLocation = _a.syncWithLocation, rest = __rest(_a, [\"basePath\", \"history\", \"location\", \"match\", \"options\", \"hasList\", \"hasEdit\", \"hasShow\", \"hasCreate\", \"syncWithLocation\"]);\n    return rest;\n};\nvar PREFIX = 'RaTreeWithDetails';\nexport var TreeWithDetailsClasses = {\n    container: \"\".concat(PREFIX, \"-container\"),\n    cardTree: \"\".concat(PREFIX, \"-cardTree\"),\n    cardContentTree: \"\".concat(PREFIX, \"-cardContentTree\"),\n    actionCard: \"\".concat(PREFIX, \"-actionCard\"),\n};\nvar Root = styled('div', {\n    name: PREFIX,\n    overridesResolver: function (props, styles) { return styles.root; },\n})((_a = {\n        display: 'flex'\n    },\n    _a[\"& .\".concat(TreeWithDetailsClasses.actionCard)] = {\n        width: '100%',\n    },\n    _a[\"& .\".concat(TreeWithDetailsClasses.cardTree)] = {\n        minWidth: '300px',\n        marginTop: '1em',\n        marginRight: '1em',\n    },\n    _a[\"& .\".concat(TreeWithDetailsClasses.cardContentTree)] = {},\n    _a[\"& .\".concat(TreeWithDetailsClasses.container)] = {\n        display: 'flex',\n    },\n    _a));\nvar getLinkTo = function (_a) {\n    var linkTo = _a.linkTo, show = _a.show, edit = _a.edit;\n    if (linkTo) {\n        return linkTo;\n    }\n    if (show) {\n        return 'show';\n    }\n    if (edit) {\n        return 'edit';\n    }\n    return false;\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Children } from 'react';\nimport { Toolbar as MuiToolbar, useMediaQuery } from '@mui/material';\nimport clsx from 'clsx';\nimport { styled } from '@mui/material/styles';\nimport { SaveButton } from 'react-admin';\nimport { DeleteBranchButton } from './DeleteBranchButton';\n/**\n * Override for react-admin's Toolbar that uses ra-tree's <DeleteBranchButton>\n */\nexport var EditNodeToolbar = function (props) {\n    var _a;\n    var children = props.children, className = props.className, resource = props.resource, rest = __rest(props, [\"children\", \"className\", \"resource\"]);\n    var isXs = useMediaQuery(function (theme) { return theme.breakpoints.down('sm'); });\n    return (_jsx(StyledToolbar, __assign({ className: clsx((_a = {},\n            _a[EditNodeToolbarClasses.mobileToolbar] = isXs,\n            _a[EditNodeToolbarClasses.desktopToolbar] = !isXs,\n            _a), className), role: \"toolbar\" }, rest, { children: Children.count(children) === 0 ? (_jsxs(\"div\", { className: EditNodeToolbarClasses.defaultToolbar, children: [_jsx(SaveButton, {}), _jsx(DeleteBranchButton, { resource: resource })] })) : (children) })));\n};\nvar PREFIX = 'RaEditNodeToolbar';\nexport var EditNodeToolbarClasses = {\n    desktopToolbar: \"\".concat(PREFIX, \"-desktopToolbar\"),\n    mobileToolbar: \"\".concat(PREFIX, \"-mobileToolbar\"),\n    defaultToolbar: \"\".concat(PREFIX, \"-defaultToolbar\"),\n};\nvar StyledToolbar = styled(MuiToolbar, {\n    name: PREFIX,\n    overridesResolver: function (props, styles) { return styles.root; },\n})(function (_a) {\n    var _b;\n    var theme = _a.theme;\n    return (_b = {\n            backgroundColor: theme.palette.mode === 'light'\n                ? theme.palette.grey[100]\n                : theme.palette.grey[900]\n        },\n        _b[\"&.\".concat(EditNodeToolbarClasses.desktopToolbar)] = {},\n        _b[\"&.\".concat(EditNodeToolbarClasses.mobileToolbar)] = {\n            position: 'fixed',\n            bottom: 0,\n            left: 0,\n            right: 0,\n            padding: '16px',\n            width: '100%',\n            boxSizing: 'border-box',\n            flexShrink: 0,\n            zIndex: 2,\n        },\n        _b[\"& .\".concat(EditNodeToolbarClasses.defaultToolbar)] = {\n            flex: 1,\n            display: 'flex',\n            justifyContent: 'space-between',\n        },\n        _b);\n});\n"],"names":["useShowController","__name","props","disableAuthentication","propsId","queryOptions","redirectOnError","DefaultRedirectOnError","resource","useResourceContext","isPendingAuthenticated","useAuthenticated","isPendingCanAccess","useRequireAccess","getRecordRepresentation","useGetRecordRepresentation","translate","useTranslate","notify","useNotify","redirect","useRedirect","routeId","useParams","id","meta","otherQueryOptions","record","error","isLoading","isFetching","isPaused","isPending","isPlaceholderData","refetch","useGetOne","getResourceLabel","useGetResourceLabel","recordRepresentation","ShowContext","createContext","ShowContextProvider","children","value","React.createElement","RecordContextProvider","useShowContext","context","useContext","ShowActions","hasEdit","useResourceDefinition","TopToolbar","sanitizeRestProps","EditButton","hasCreate","hasShow","hasList","rest","defaultActions","defaultOffline","Offline","ShowView","actions","aside","render","className","Content","Card","emptyWhileLoading","offline","title","showContext","defaultTitle","errorState","finalActions","showOffline","showError","Root","clsx","Title","ShowClasses","PREFIX","styled","styles","__assign","s","i","n","p","__awaiter","thisArg","_arguments","P","generator","adopt","resolve","reject","fulfilled","step","e","rejected","result","__generator","body","_","t","f","y","g","verb","v","op","addTreeMethodsBasedOnParentAndPosition","dataProvider","parentIdField","positionField","apiSupportBranchDeletion","deleteBranch","deleteBranchByDeletingNode","deleteBranchByDeletingAllChildren","treeDataProvider","params","data","treeRecords","_a","r","a","b","child","_b","resource_1","tree","parent","childId","_c","node","parentId","_d","destinationSiblings","sourceSiblings","newRecord","_e","source","destination","position","_f","item","destinationSiblingsToUpdateFilter","sourceSiblingsToUpdateFilters","finalPosition","_g","_h","_j","_k","_l","_m","roots","rootPosition","newRoot","acc","curr","siblings","maxPosition","childPosition","sibling","previousData","__rest","__spreadArray","to","from","pack","l","ar","useAddRootNode","options","useDataProvider","queryClient","useQueryClient","paramsRef","useRef","mutation","useMutation","callTimeResource","callTimeData","callTimeMeta","variables","addRootNode","args_1","_i","callTimeParams","callTimeOptions","returnPromise","otherOptions","useDeleteBranch","mutationMode","reactMutationOptions","mode","snapshot","updateCache","now","updatedAt","removeRecord","old","index","newRecords","children_1","updateCollection","res","newCollection","recordWasFound","callTimeId","callTimePreviousData","userContext","key","mutate","onSuccess","onSettled","onError","queryKeys","prev","undoableEventEmitter","isUndo","useGetChildNodesCallback","callback","useEvent","removeChildren","useGetTreeCallback","updateQueryCacheFromGetTree","useCallback","useMoveAsNthChildOf","cloneDeep","oldParent","newParent","callTimePosition","callTimeSource","callTimeDestination","useMoveAsNthSiblingOf","optimisticFinalPosition","fixFakeRestDataProvider","filteredNodes","filteredRoots","removeNode","newNodes","parentNode","childrenIdsToRemove","getNodeChildrenRecursive","useDeleteBranchWithConfirmController","mutationOptions","redirectTo","refresh","useRefresh","useRecordContext","useState","open","setOpen","setFinalData","useTreeContext","handleDelete","event","previous","handleDialogOpen","handleDialogClose","useDeleteBranchWithUndoController","useCreateNodeController","transform","location","useLocation","handleAddNode","insertAsFirstChild","isChild","recordToUse","otherMutationOptions","finalRedirectTo","getDefaultRedirectRoute","createRoot","createRootState","useAddChildNode","createChild","createChildState","handleAddNodeEvent","noop","useEffect","save","onSuccessFromSave","onErrorFromSave","transformFromSave","defaultOnSuccess","newNode","defaultOnError","error_1","HttpError","resourceName","getNodeIdsRecursively","nodeKey","allNodes","useTreeController","lazy","filter","treeState","useGetTree","rootNodesState","useGetRootNodes","innerLoadChildNodes","lazyDataWithoutChildren","useMemo","finalData","loadChildNodes","records","recordsWithoutChildren","childrenAreLoaded","updated","updatedAsMap","setNewNode","nodeToCreate","UNSAVED_NEW_NODE","newNodes_1","useExpandedKeys","expandedKeys","setExpandedKeys","handleExpand","previousValue","newValue","closedNodes","allClosedNodes","moveAsNthChildOf","moveAsNthSiblingOf","refreshTree","handleDrop","type","successSideEffect","errorSideEffect","TreeChoicesContext","TreeInput","label","multiple","sx","helperText","fullWidth","margin","variant","size","useTreeInputController","fetchError","isRequired","field","fieldState","formState","isTouched","invalid","isSubmitted","React.useMemo","selectedRecords","InputComponent","Input","OutlinedInput","FilledInput","_jsxs","_jsx","InputLabel","FieldTitle","TreeInputInput","FormHelperText","InputHelperText","CircularProgress","TreeInputTree","TreeInputClasses","FormControl","theme","checkStrictly","expandAction","titleField","React.useState","setKey","shouldUpdateKey","React.useRef","React.useEffect","prevKey","handleCheck","handleSelect","handleClose","handleKeyDown","anchorEl","handleClick","popoverRef","_Fragment","KeyboardArrowDownIcon","Stack","Chip","ChoiceLabel","Popover","_createElement","Tree","React.forwardRef","ref","inputProps","Box","visuallyHidden","get","useReferenceNodeInputController","ReferenceNodeInput","ResourceContextProvider","TreeChoicesContextProvider","useTreeChoicesContext","sourceProp","dataProp","sourceFromContext","dataFromContext","useInput","TreeContextProvider","TreeContext","CreateNode","controllerProps","CreateContextProvider","CreateView","ShowNode","idProp","DeleteMenuItemWithConfirmation","confirmTitle","confirmContent","onClick","MenuItem","Confirm","inflection.humanize","inflection.singularize","DeleteMenuItemWithUndo","DeleteMenuItem","NodeActionsContext","NodeActionsContextProvider","NodeActions","setAnchorEl","RaNodeActionsClasses","MoreVertIcon","Menu","DeleteBranchWithUndoButton","icon","defaultIcon","Button","alpha","ActionDelete","DeleteBranchWithConfirmButton","DeleteWithConfirmButtonClasses","DeleteBranchButton","saveContext","useSaveContext","finalMutationMode","useMatchWithBasename","pattern","basename","useBasename","useMatch","TreeWithDetails","allowMultipleRoots","Create","defaultExpandedKeys","Edit","hideRootNodes","nodeActions","DefaultNodeActions","Show","showLine","addRootButton","CreateButton","expandedKeysProp","onExpand","onDrop","navigate","useNavigate","createPath","useCreatePath","matchCreate","matchEdit","matchShow","finalLinkTo","getLinkTo","defaultSelectedKeys","setSelectedKeys","treeNode","handleExpandEvent","expandedKey","isExpanded","handleDropEvent","handleLoadData","rootNodeIds","maybeParentNode","allowDrop","isRootNode","canCreateNode","TreeWithDetailsClasses","CardContent","Routes","Route","linkTo","show","edit","EditNodeToolbar","isXs","useMediaQuery","StyledToolbar","EditNodeToolbarClasses","Children","SaveButton","MuiToolbar"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]}